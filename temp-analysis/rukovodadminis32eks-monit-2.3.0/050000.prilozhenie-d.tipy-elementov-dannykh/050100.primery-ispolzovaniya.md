# Примеры использования

Приложению Java не требуется какое-либо дополнительно установленное ПО, но для поддержки удаленного мониторинга JMX-приложение необходимо запустить с указанными ниже параметрами командной строки.

Если требуется просто начать мониторинг приложения Java на локальном хосте без какой-либо защиты, его запускают со следующими опциями:

```bash Terminal
java \
-Dcom.sun.management.jmxremote \
-Dcom.sun.management.jmxremote.port=12345 \
-Dcom.sun.management.jmxremote.authenticate=false \
-Dcom.sun.management.jmxremote.ssl=false \
-Dcom.sun.management.jmxremote.registry.ssl=false \
-jar /usr/share/doc/openjdk-6-jre-headless/demo/jfc/Notepad/Notepad.jar
```

С этими аргументами Java будет слушать входящие соединения JMX на порту 12345 только с локального хоста без необходимости в аутентификации или SSL.

Если нужно разрешить подключения с другого интерфейса, параметр "-Djava.rmi.server.Hostname" указывают равным IP-адресу этого интерфейса.

Если необходима более строгая проверка в плане безопасности, имеется много других доступных опций в Java. Следующий пример запускает приложение с более разносторонним набором опций и открывает это приложение для более широкой сети, а не только для локального компьютера:

```bash Terminal
java \
-Djava.rmi.server.Hostname=192.168.3.14 \
-Dcom.sun.management.jmxremote \
-Dcom.sun.management.jmxremote.port=12345 \
-Dcom.sun.management.jmxremote.authenticate=true \
-Dcom.sun.management.jmxremote.password.file=/etc/java-6-openjdk/management/jmxremote.password \
-Dcom.sun.management.jmxremote.access.file=/etc/java-6-openjdk/management/jmxremote.access \
-Dcom.sun.management.jmxremote.ssl=true \
-Dcom.sun.management.jmxremote.registry.ssl=true \
-Djavax.net.ssl.keyStore=$ВАШЕ_ХРАНИЛИЩЕ_КЛЮЧЕЙ \
-Djavax.net.ssl.keyStorePassword=$ВАШ_ПАРОЛЬ_К_ХРАНИЛИЩУ_КЛЮЧЕЙ \
-Djavax.net.ssl.trustStore=$ВАШЕ_ДОВЕРЕННОЕ_ХРАНИЛИЩЕ \
-Djavax.net.ssl.trustStorePassword=$ВАШ_ПАРОЛЬ_К_ДОВЕРЕННОМУ_ХРАНИЛИЩУ \
-Dcom.sun.management.jmxremote.ssl.need.client.auth=true \
-jar /usr/share/doc/openjdk-6-jre-headless/demo/jfc/Notepad/Notepad.jar
```

Значительное количество этих настроек можно указать в /etc/java-6-openjdk/management/management.properties (или в месте расположения файла на компьютере).

Следует обратить внимание, что, если требуется использовать SSL, нужно изменить скрипт Startup.sh Java gateway, добавив в него опции "-Djavax.net.ssl.*" для обнаружения хранилища ключей и доверенного хранилища.

# Д.7.2 Агрегированные вычисления

Когда Java Gateway запущен, Сервер его определяет, и Java-приложение запущено с поддержкой удаленного JMX-мониторинга, настраивают интерфейсы и элементы данных в веб-интерфейсе Подсистемы.

Начинают с создания интерфейса JMX-типа у требуемого узла сети (рисунок 8).

::sign-image
---
src: /image13.png
sign: Рисунок 42 – Настройка JMX-интерфейса
---
::

1. Настройка JMX-интерфейса

Для каждого требуемого счетчика JMX необходимо добавить элемент данных с типом "JMX Агент", присоединенный к этому интерфейсу.

Ключ на рисунке 9 имеет следующий вид: jmx["java.lang:type=Memory","HeapMemoryUsage.used"].

::sign-image
---
src: /image14.png
sign: Рисунок 44 – Добавление элемента данных
---
::

1. Добавление элемента данных

Поля, требующие специфичной информации для JMX-элементов данных, приведены в таблице 82.

1. Описание полей для JMX-элементов данных

| Параметр | Описание |
| --- | --- |
| Т`ип` | `У`казать `JMX-Агент.` |
| К`люч` | `К`люч элемента данных `jmx[] `содержит три параметра:`имя объекта –` имя объекта MBean;`имя параметра `– имя параметра MBean с опциональными составными именами полей данных, разделенных точками.`уникальное короткое описание `– уникальное описание, которое позволит создать на одном узле сети несколько JMX элементов данных с одинаковыми именем объекта и именем параметра (опционально) |
| J`MX endpoint` | `М`ожно указать пользовательский JMX endpoint. Убедитесь, что параметры подключения JMX endpoint совпадают с JMX-интерфейсом. Это можно сделать при помощи макросов `{HOST.*},` как уже сделано в JMX endpoint по умолчанию. |
| И`мя пользователя` | `У`казать имя пользователя, если настроена аутентификация Java-приложения.Поддерживаются пользовательские макросы. |
| П`ароль` | `У`казать пароль, если настроена аутентификация Java-приложения.Поддерживаются пользовательские макросы. |

Если нужно наблюдать за логическим счетчиком, который может быть true или false, следует указать тип информации "Числовой (целое положительное)" и добавить шаг предварительной обработки "Логический в десятичный" на вкладке Предобработка. Сервер будет сохранять логические значения как 1 или 0 соответственно.

# Д.8 Внутренние проверки

Имя объекта MBean – это строка, которую определили в Java-приложении. Имя параметра, с другой стороны, может быть более сложным. В случае если параметр возвращает простой тип данных (число, строку и т.п.), ключ будет выглядеть примерно так:

```yaml
jmx[com.example:Type=Hello,weight]
```

В этом примере именем объекта является "com.example:Type=Hello", именем параметра будет "weight" и, скорее всего, тип возвращаемого значения должен быть "Числовой (с плавающей точкой)".

Ключ становится все более сложным, если параметр возвращает составные данные. Например, если именем параметра является "apple", и он возвращает хеш представляющих его параметров, таких как "weight", "color" и прочее, то ключ может выглядеть примерно так:

```yaml
jmx[com.example:Type=Hello,apple.weight]
```

Этот пример показывает, как разделяются с помощью точки имя параметра и ключ хеша. Также, если параметр возвращает вложенные составные данных, их части снова нужно разделять точкой:

```yaml
jmx[com.example:Type=Hello,fruits.apple.weight]
```

Параметры с табличными данными состоят из одного или нескольких составных параметров. Если такой параметр указан в параметре имени параметра, то значение этого элемента данных вернет всю структуру параметра в JSON-формате. Значения отдельных элементов из табличных данных можно извлечь с использованием предварительной обработки.

Пример параметра с табличными данными:

```yaml
jmx[com.example:type=Hello,foodinfo]
```

Значение элемента данных:

```bash Terminal
[
{
"a": "apple",
"b": "banana",
"c": "cherry"
},
{
"a": "potato",
"b": "lettuce",
"c": "onion"
}
]
```

Если имя параметра или ключ хеша содержит символ точки, например:

```yaml
jmx[com.example:Type=Hello,all.fruits.apple.weight]
```

это является проблемой. В данном случае требуется экранировать точки, которые являются частью имени, обратной косой чертой:

```yaml
jmx[com.example:Type=Hello,all\.fruits.apple.weight]
```

Аналогично, если ключ хеша содержит точку, необходимо ее экранировать:

```yaml
jmx[com.example:Type=Hello,all\.fruits.apple.total\.weight]
```

Символ обратной косой черты также необходимо экранировать:

```yaml
jmx[com.example:type=Hello,c:\\documents]
```

Имеется возможность работы с пользовательскими MBean, которые возвращают не примитивные типы данных, которые переопределяют метод toString().

### Д.8.1 Поддерживаемые проверки

ODBC-мониторинг соответствует типу элемента данных "Монитор баз данных" в веб-интерфейсе Подсистемы.

ODBC – это API на языке программирования C к промежуточной прослойке для доступа к системам управления базами данных (DBMS).

Подсистема может выполнять запросы к любой БД, которая поддерживается ODBC. Чтобы это сделать, Подсистема не подключается напрямую к БД, а использует интерфейс ODBC и драйверы, установленные в ODBC. Эта функция позволяет с большей эффективностью мониторить различные БД с разнообразными целями, например: проверка специфичных запросов к базе данных, статистика использования и прочее. Подсистема поддерживает unixODBC, которая является одной из наиболее часто используемых реализаций API ODBC с открытым исходным кодом.

1. Установка unixODBC

Рекомендуемый способ установки unixODBC состоит в использовании репозиториев пакетов по умолчанию в операционной системе Linux. В наиболее популярные дистрибутивы Linux unixODBC добавлен в репозитории пакетов по умолчанию. Если он недоступен, можно обратиться к домашней странице UNIXODBC: http://www.unixodbc.org/download.html.

Установка unixODBC на ОС на базе RedHat/Fedora с использованием менеджера пакетов dnf:

```bash Terminal
dnf -y install unixODBC unixODBC-devel
```

Установка unixODBC на ОС на базе SUSE с использованием менеджера пакетов zypper:

```bash Terminal
zypper in unixODBC-devel
```

Пакет unixODBC-devel требуется для компиляции Подсистемы с поддержкой unixODBC.

1. Установка драйверов unixODBC

Драйвер unixODBC базы данных должен быть установлен для БД, которая будет наблюдаться. unixODBC имеет список поддерживаемых БД и драйверов: http://www.unixodbc.org/drivers.html. В некоторых дистрибутивах Linux драйвера БД включены в репозитории пакетов. Драйвера БД MySQL на ОС на базе RedHat/Fedora можно установить с помощью менеджера пакетов dnf:

```bash Terminal
shell> dnf install mysql-connector-odbc
```

Установка MySQL драйвера на ОС на базе SUSE с использованием менеджера пакетов zypper:

```bash Terminal
zypper in MyODBC-unixODBC
```

1. Настройка unixODBC

Настройка ODBC выполняется путем редактирования файлов odbcinst.ini и odbc.ini. Для проверки местоположения этих файлов нужно ввести:

```bash Terminal
odbcinst -j
```

odbcinst.ini используется для перечисления установленных драйверов БД ODBC:

```bash Terminal
[mysql]
Description = ODBC for MySQL
Driver = /usr/lib/libmyodbc5.so
```

где:

- `mysql – и`мя драйвера БД;
- `Description – о`писание драйвера БД;
- `Driver `– размещение библиотеки драйвера БД.

odbc.ini используется для определения источников данных:

```bash Terminal
[test]Description = MySQL test database
Driver = mysql
Server = 127.0.0.1
User = root
Password =
Port = 3306
Database = zabbix
```

где:

- t`est –` имя источника данных (DSN);
- `Description –` описание источника данных;
- `Driver –` имя драйвера БД, как указано в `odbcinst.ini;`
- `Server –` IP/DNS сервера БД;
- `User –` пользователь БД для подключения;
- `Password –` пароль пользователя БД;
- `Port –` порт подключения к БД;
- `Database –` имя БД.

Для проверки успешного соединения ODBC подключение к БД необходимо протестировать. Для этого можно воспользоваться утилитой isql (включена в пакет unixODBC):

```bash Terminal
shell> isql test
+---------------------------------------+
| Connected! |
| |
| sql-statement |
| help [tablename] |
| quit |
| |
+---------------------------------------+
SQL>
```

1. Компиляция с поддержкой ODBC

Для включения поддержки ODBC Подсистема должен быть скомпилирован со следующим флагом:

```bash Terminal
--with-unixodbc[=ARG] use odbc driver against unixODBC package
```

1. Настройка элемента данных в веб-интерфейсе

Настройка элемента данных для мониторинга БД показана на рисунке 10.

::sign-image
---
src: /image15.png
sign: Рисунок 45 – Настройка для мониторинга базы данных
---
::

1. Настройка для мониторинга базы данных

Специально для элементов данных мониторинга БД должны быть указаны параметры из таблицы 83.

Описание параметров мониторинга БД

| Параметр | Описание |
| --- | --- |
| Т`ип` | `В`ыбрать "`Монитор баз данных"` |
| К`люч` | `В`вести один из двух поддерживаемых ключей элементов данных:`db.odbc.select[<уникальное короткое описание>,<dsn>,<строка подключения>] –` этот элемент данных предназначен для получения одного значения, то есть первого столбца первой строки из результата SQL-запроса. Если запрос возвращает более одного столбца, будет прочитан только первый столбец. Если запрос возвращает более одной строки, будет прочитана только первая строка.`db.odbc.get[<уникальное короткое описание>,<dsn>,<строка подключения>] –` этот элемент данных способен возвращать несколько строк / столбцов в формате JSON. Таким образом, его можно использовать основным элементом данных, который собирает все данные за один системный вызов, а предварительную обработку JSONPath можно использовать в зависимых элементах данных для извлечения отдельных значений. Уникальное описание будет служить для идентификации элемента данных в триггерах и т.п.Хотя `dsn `и "`строка подключения" `– опциональные параметры, по крайней мере один из них должен присутствовать. Если заданы оба параметра: имя источника данных (DSN) и строка подключения, то DSN будет игнорироваться.Имя источника данных, если используется, необходимо указать в точности как указано в `odbc.ini.`Строка подключения может содержать специфичные для драйверов аргументы. |
| И`мя пользователя` | `В`вести имя пользователя для доступа к базе данныхЭтот параметр необязателен, если пользователь указан в `odbc.ini.`Если используется строка подключения и поле `Имя пользователя `непустое, то имя пользователя добавляется к строке подключения как `UID=<пользователь>` |
| П`ароль` | `В`вести пароль пользователя для доступа к базе данныхЭтот параметр необязателен, если пароль указан в `odbc.ini.`Если используется строка подключения и поле `Пароль `непустое, то пароль добавляется к строке подключения как `PWD=<пароль>.`Если пароль содержит точку с запятой, его необходимо заключить в фигурные скобки, например:Password: `{P?;)*word} `· (если фактически пароль `P?;)*word)`Пароль будет добавлен к строке подключения после имени пользователя как:`UID=<username>;PWD={P?;)*word}`Чтобы протестировать полученную строку, выполнить:`isql -v -k "Driver=libmaodbc.so;Database=zabbix;UID=zabbix;PWD={P?;)*word}"` |
| S`QL запрос` | `В`вести необходимый SQL-запрос.Следует обратить внимание, что для элемента данных `db.odbc.select[] `запрос должен возвращать только одно значение. |
| Т`ип информации` | `В`ыбрать корректный тип информации. С некорректным типом информации элемент данных станет неподдерживаемым. |

Примечания:

- Элементы данных монитора БД станут неподдерживаемыми, если процессы "`odbc poller" `не запускаются в конфигурации Сервера или Прокси. Чтобы включить ODBC-поллеры, нужно задать параметр` StartODBCPollers `в файле конфигурации Сервера или, если проверки выполняются на стороне Прокси, в файле конфигурации Прокси.
- Подсистема не ограничивает время выполнения запроса. Пользователь сам выбирает запросы, которые выполняются за разумное время.
- Значение параметра `Timeout с` Сервера используется как время ожидания выполнения входа в ODBC (следует обратить внимание, что в зависимости от драйвера ODBC время ожидания выполнения входа может быть проигнорировано).
- SQL-команда должна вернуть набор данных, как и любой запрос с "`SELECT…".` Синтаксис запроса зависит от РСУБД, которая будет его обрабатывать. Синтаксис запроса к хранимой процедуре должен начинаться с ключевого слова `CALL.`
1. Сообщения об ошибках

Сообщения об ошибках ODBC структурированы по полям для предоставления подробной информации. Например:

```bash Terminal
Cannot execute ODBC query – Zabbix сообщение
[SQL_ERROR] – ODBC возвращаемый код
[42601] – SQLState
[7] – Родной код ошибки
[ERROR: syntax error at or near ";"; Error while executing the query] – Родное сообщение об ошибке
```

Следует обратить внимание, что длина сообщения об ошибке ограничена 2048 байтами, поэтому сообщение может быть усечено. Если имеется более одной ODBC диагностической записи, Подсистема пытается их скомпоновать, насколько позволяет ограничение по длине.

1. Рекомендуемые настройки UNIXODBC для MySQL

Установка:

- в Red Hat Enterprise Linux:
- Debian/Ubuntu:

```bash Terminal
dnf install mysql-connector-odbc
```

См. материалы документации MySQL для загрузки необходимого драйвера базы данных под соответствующую платформу.

Настройка ODBC выполняется изменением файлов odbcinst.ini и odbc.ini. Эти файлы конфигурации можно найти в директории /etc. Файл odbcinst.ini может отсутствовать, и в этом случае его необходимо создать вручную:

```bash Terminal
[mysql]
Description = General ODBC for MySQL
Driver = /usr/lib64/libmyodbc5.so
Setup = /usr/lib64/libodbcmyS.so
FileUsage = 1
```

1. Рекомендуемые настройки UNIXODBC для PostgreSQL

Установка:

- в Red Hat Enterprise Linux:
- в Debian/Ubuntu:

```bash Terminal
dnf install postgresql-odbc
```

См. материалы документации PostgreSQL для загрузки необходимого драйвера базы данных под соответствующую платформу.

Настройка ODBC выполняется путем редактирования файлов odbcinst.ini и odbc.ini. Эти файлы конфигурации можно найти в директории /etc. Файл odbcinst.ini может отсутствовать, и в этом случае его необходимо создать вручную.

1. Рекомендуемые настройки UNIXODBC для MSSQL

Установка:

- в Red Hat Enterprise Linux:
- Debian/Ubuntu:

```bash Terminal
dnf -y install freetds unixODBC
```

См. материалы документации пользователя FreeTDS для загрузки необходимого драйвера базы данных под соответствующую платформу.

Настройка ODBC выполняется путем редактирования файлов odbcinst.ini и odbc.ini. Эти файлы конфигурации можно найти в директории /etc. Файл odbcinst.ini может отсутствовать, и в этом случае его необходимо создать вручную.

# Д.9 Проверки через SSH

Зависимые элементы данных используются в ситуациях, когда один элемент данных собирает несколько метрик одновременно или требуется одновременный сбор связанных метрик, например:

- утилизация CPU по отдельным ядрам;
- входящий/исходящий/общий сетевой трафик.

Для обеспечения массового сбора метрик и использования синхронности в нескольких связанных элементах данных Подсистема поддерживает зависимые элементы данных. Зависимые элементы данных используют основной элемент данных для сбора своих данных одновременно, одним запросом. Новое значение у основного элемента данных автоматически заполняет значения и зависимых элементов данных. Зависимые элементы данных не могут иметь интервал обновления, отличный от своего основного элемента данных.

Опции предварительной обработки в Подсистеме можно использовать для извлечения части, которая необходима зависимому элементу данных, из данных основного элемента данных.

Предварительная обработка управляется при помощи процесса "preprocessing manager (менеджер предобработки)" вместе с рабочими процессами, которые выполняют шаги предварительной обработки. Все значения (с предварительной обработкой и без предварительной обработки) от разных сборщиков данных проходят через менеджер предварительной обработки перед добавлением в кэш истории. Для связи между сборщиками данных (поллерами, трапперами и т.д.) и процессами предобработки используется взаимодействие между процессами (IPC) на основе сокета.

Сервер или Прокси (если узел сети наблюдается через Прокси) выполняют шаги предварительной обработки и обрабатывают зависимые элементы данных.

Элемент данных любого типа, даже зависимый элемент данных, может быть основным элементом данных. Дополнительные уровни зависимых элементов данных можно использовать для извлечения меньших частей значения уже существующего зависимого элемента данных.

Ограничения:

- Зависимости разрешены только в пределах одного узла сети (шаблона).
- Прототип элемента данных может зависеть от другого прототипа элемента данных или от обычного элемента данных с этого же узла сети.
- Максимальное количество зависимых элементов данных от одного основного элемента данных ограничено 29999 элементами данных (независимо от количества уровней зависимости).
- Разрешено максимум 3 уровня зависимости.
- Зависимый элемент данных с основным элементом данных из шаблона не экспортируется в XML.

Зависимый элемент данных зависит от своего основного элемента данных, поэтому сначала необходимо настроить (или использовать существующий) основной элемент данных:

1. перейти в меню "Настройка → Узлы сети";
2. нажать на Элементы данных в строке с узлом сети;
3. нажать на Создать элемент данных;
4. в окне указать параметры элемента данных (рисунок 11);

::sign-image
---
src: /image16.png
sign: Рисунок 46 – Создание элемента данных
---
::

1. Создание элемента данных
1. нажать на Добавить для сохранения основного элемента данных;
2. настроить зависимый элемент данных (рисунок 12).

::sign-image
---
src: /image17.png
sign: Рисунок 47 – Зависимый элемент данных
---
::

1. Зависимый элемент данных

Поля в таблице 84 требуют особые параметры по зависимым элементам данных.

1. Параметры зависимых элементов данных

| Параметр | Описание |
| --- | --- |
| Тип | Выбрать "`Зависимый элемент данных"` |
| Ключ | Указать ключ, который будет использоваться для распознавания этого элемента данных. |
| Основной элемент данных | Выбрать основной элемент данных. Значение основного элемента данных будет использовано для заполнения значения зависимого элемента данных. |
| Тип информации | Выбрать тип информации, который соответствует формату сохраняемых данных. |

Можно использовать предварительную обработку значений элементов данных для извлечения необходимой части значения с основного элемента данных (рисунок 13).

::sign-image
---
src: /image18.png
sign: Рисунок 48 – Предварительная обработка значений элементов данных
---
::

1. Предварительная обработка значений элементов данных

Без предварительной обработки значением зависимого элемента данных будет такое же значение, что и значение основного элемента данных.

1. нажать на Добавить, чтобы сохранить зависимый элемент данных.

Ссылка для более быстрого создания зависимого элемента данных может быть доступна после нажатия на пиктограмму  в списке элементов данных и выбора "Создать зависимый элемент данных" (рисунок 14).

::sign-image
---
src: /image19.png
sign: Image image19
---
::

::sign-image
---
src: /image20.png
sign: Рисунок 49 – Быстрое создание зависимого элемента данных
---
::

1. Быстрое создание зависимого элемента данных

В списке элементов данных зависимые элементы данных отображаются с именем основного элемента данных в качестве префикса.

Если основной элемент данных удаляется, то будут удалены и все его зависимые элементы данных.

# Д.9.1 Диалог настройки командной строки

Этот тип элемента данных позволяет получать данные с использованием HTTP/HTTPS-протокола. Трапы также возможны с использованием sender или протокола sender.

Проверка HTTP-элемента данных выполняется на стороне Сервера. Если узлы сети наблюдаются через Прокси, проверки HTTP-элементов данных выполняются этими Прокси.

Проверки HTTP-элементов данных не требуют наличия какого-либо Агента, запущенного на наблюдаемом узле сети.

HTTP-агент поддерживает как HTTP, так и HTTPS. Подсистема будет опционально следовать перенаправлениям. Максимальное количество перенаправлений вшито в код и равно 10 (используется cURL-опция CURLOPT_MAXREDIRS).

Сервер/Прокси должны быть изначально сконфигурированы с поддержкой cURL (libcurl).

Для настройки HTTP-элемента данных нужно:

1. перейти в меню "Настройка → Узлы сети";
2. нажать на Элементы данных в строке с узлом сети;
3. нажать на Создать элемент данных;
4. ввести параметры элемента данных в окне.

Поля, которые требуют специфичную информацию HTTP-элементов данных, приведены в таблице 85.

1. Параметры HTTP-элементов данных

| Параметр | Описание |
| --- | --- |
| Т`ип` | Выбрать `HTTP-Агент.` |
| К`люч` | Ввести уникальный ключ элемента данных. |
| U`RL` | URL для подключения и получения данных. Например:`https://www.google.com`Имена доменов можно указывать Юникод-символами. Они автоматически конвертируются методом `punycode `в ASCII при выполнении HTTP-проверки.Кнопку Анализ можно использовать, чтобы отделить из URL опциональные поля запроса (например, `?name=Admin&password=mypassword)`, переместив параметры и значения в "`Поля запроса"`, чтобы URL-кодировка выполнялась автоматически.Ограничено 2048 символами.Поддерживаемые макросы: `{HOST.IP},` `{HOST.CONN},` `{HOST.DNS},` `{HOST.HOST},` `{HOST.NAME},` `{ITEM.ID},` `{ITEM.KEY},` `{ITEM.KEY.ORIG},` пользовательские макросы, макросы низкоуровневого обнаружения.Это поле задает  [en] опцию cURL. |
| П`оля запроса` | Переменные для URL (см. выше).Задаются в виде пар параметров и значений.Значения автоматически URL-кодируются. Значения с макросов раскрываются и затем автоматически URL-кодируются.Поддерживаемые макросы: `{HOST.IP},` `{HOST.CONN},` `{HOST.DNS},` `{HOST.HOST},` `{HOST.NAME},` `{ITEM.ID},` `{ITEM.KEY},` `{ITEM.KEY.ORIG},` пользовательские макросы, макросы низкоуровневого обнаружения.Это поле задает  [en] опцию cURL. |
| Т`ип запроса` | Выбрать тип метода запроса: `GET,` `POST,` `PUT `или `HEAD` |
| В`ремя ожидания` | Подсистема не будет тратить более указанного времени при обработке URL (1-60 секунд). В действительности же этот параметр определяет максимальное время создания подключения к URL и максимальное время выполнения HTTP-запроса. Следовательно, Подсистема не будет тратить более 2-x "`Время ожидания" `секунд за одну проверку.Поддерживаются суффиксы времени, например, 30s, 1m.Поддерживаемые макросы: пользовательские макросы, макросы низкоуровневого обнаружения.Это поле задает  [en] опцию cURL. |
| Т`ип тела запроса` | Выбрать тип запроса тела:`Сырые данные `– пользовательское тело HTTP-запроса, макросы заменяются, но кодирование не выполняется`JSON данные `– тело HTTP-запроса в формате JSON. Макросы можно использовать в виде строк, чисел, true или false; макросы, которые используются в виде строки, должны быть заключены в двойные кавычки. Значения из макросов раскрываются и затем экранируются автоматически. Если в заголовках "Content-Type" не задан, то будет указано значение по умолчанию "Content-Type: application/json"`XML данные `– тело HTTP-запроса в формате XML. Макросы можно использовать в виде нод текста, параметров или CDATA секции. Значения из макросов раскрываются и затем экранируются автоматически в нодах текста и в параметрах. Если в заголовках "`Content-Type"` не задан, то будет указано значение по умолчанию "`Content-Type: application/xml"`Следует обратить внимание, что выбор "`XML данные"` требует наличия поддержки libxml2. |
| Т`ело запроса` | Ввести тело запроса.Поддерживаемые макросы: `{HOST.IP},` `{HOST.CONN},` `{HOST.DNS},` `{HOST.HOST},` `{HOST.NAME},` `{ITEM.ID},` `{ITEM.KEY},` `{ITEM.KEY.ORIG},` пользовательские макросы, макросы низкоуровневого обнаружения. |
| З`аголовки` | Пользовательские HTTP-заголовки, которые будут отправлены при выполнении запроса.Задаются в виде пар параметров и значений.Поддерживаемые макросы: `{HOST.IP},` `{HOST.CONN},` `{HOST.DNS},` `{HOST.HOST},` `{HOST.NAME},` `{ITEM.ID},` `{ITEM.KEY},` `{ITEM.KEY.ORIG},` пользовательские макросы, макросы низкоуровневого обнаружения.Это поле задает  [en] опцию cURL. |
| Т`ребуемые коды состояния` | Список ожидаемых кодов состояния HTTP. Если Подсистема получает код не из списка, то элемент данных станет неподдерживаемым. Если поле не заполнено, то проверка не производится.Например: 200,201,210-299Поддерживаемые макросы в этом списке: пользовательские макросы, макросы низкоуровневого обнаружения.Это поле задает  [en] опцию cURL. |
| С`ледовать перенаправлениям` | Отметить для следования HTTP перенаправлениям.Это поле задает  [en] опцию cURL. |
| Р`ежим получения` | Выбрать часть ответа, которую необходимо получать:`Тело `– только тело`Заголовки `– только заголовки`Тело и заголовки `– тело и заголовки |
| К`онвертация в JSON` | ::sign-image
---
src: /image21.png
sign: Image image21
---
:: Заголовки сохраняются в виде пар параметров и значений под ключом "`header"`.Если встречается "`Content-Type: application/json"`, то тело сохраняется в виде объекта, иначе оно сохраняется в виде строки, например: |
| H`TTP Прокси` | Можно указать необходимый HTTP-Прокси, следуя следующему формату: `[протокол://][имя пользователя[:пароль]@]Прокси.mycompany.com[:порт]`Можно использовать опциональный префикс `протокол://,` чтобы указать альтернативные протоколы Прокси (например: `https, socks4, socks5`; поддержка префиксов протоколов добавлена в cURL 7.21.7). Если протокол не указан, Прокси будет обрабатываться как HTTP-Прокси. Если указать ошибочный протокол, подключение завершится неудачей и элемент данных перейдет в неподдерживаемое состояние.По умолчанию будет использоваться порт 1080.Если этот параметр указан, Прокси заменит переменные окружения, связанные с Прокси, такие как `http_proxy, HTTPS_PROXY.` Если не указан, переменные окружения не будут заменены. Введенное значение передается "как есть", проверка корректности ввода не производится.Примечание – Для HTTP-Прокси поддерживается только простая аутентификация.Поддерживаемые макросы: `{HOST.IP},` `{HOST.CONN},` `{HOST.DNS},` `{HOST.HOST},` `{HOST.NAME},` `{ITEM.ID},` `{ITEM.KEY},` `{ITEM.KEY.ORIG},` пользовательские макросы, макросы низкоуровневого обнаружения.Это поле задает  [en] опцию cURL. |
| H`TTP Аутентификация` | Тип аутентификации:`Пусто `– без использования аутентификации.`Простая аутентификация `– с использованием простой аутентификации.`NTLM аутентификация `– с использованием NTLM (-аутентификации.`Kerberos `– с использованием Kerberos-аутентификации. `Digest `– с использованием Digest-аутентификации.После выбора какого-либо метода аутентификации будут доступны два дополнительных поля для ввода имени пользователя и пароля, в которых поддерживаются пользовательские макросы и макросы низкоуровневого обнаружения.Это поле задает  [en] опцию cURL. |
| П`роверка SSL узла` | Отметить для верификации SSL- сертификата веб-сервера. Сертификат Сервера будет автоматически взят из места центра сертификации (CA) всей системы. Можно переопределить расположение CA-файлов, воспользовавшись параметром конфигурации `SSLCALocation н`а стороне Сервера или Прокси.Это поле задает  [en] опцию cURL. |
| П`роверка SSL хоста` | Отметить для удостоверения, что поле "`Common Name" `или поле "`Subject Alternate Name" `сертификата веб-сервера совпадают.Это поле задает  [en] опцию cURL. |
| Ф`айл SSL сертификата` | Имя файла SSL-сертификата для аутентификации клиента. Файл сертификата должен быть в формате PEM1. Если файл сертификата также содержит и закрытый ключ (private key), оставить поле "`Файл SSL ключа" `пустым. Если ключ зашифрован, указать пароль в поле `Пароль `к SSL-ключу. Директория, содержащая этот файл, указывается в параметре конфигурации `SSLCertLocation `Сервера или Прокси.Поддерживаемые макросы: `{HOST.IP},` `{HOST.CONN},` `{HOST.DNS},` `{HOST.HOST},` `{HOST.NAME},` `{ITEM.ID},` `{ITEM.KEY},` `{ITEM.KEY.ORIG},` пользовательские макросы, макросы низкоуровневого обнаружения.Это поле задает  [en] опцию cURL. |
| Ф`айл SSL ключа` | Имя файла закрытого ключа SSL (private key), который используется для аутентификации клиента. Файл закрытого ключа должен быть в формате PEM1. Директория, содержащая этот файл, указывается в параметре конфигурации `SSLKeyLocation `Сервера или Прокси.Поддерживаемые макросы: `{HOST.IP},` `{HOST.CONN},` `{HOST.DNS},` `{HOST.HOST},` `{HOST.NAME},` `{ITEM.ID},` `{ITEM.KEY},` `{ITEM.KEY.ORIG},` пользовательские макросы, макросы низкоуровневого обнаружения.Это поле задает  [en] опцию cURL. |
| П`ароль к SSL ключу` | Пароль к файлу закрытого ключа.Поддерживаемые макросы: пользовательские макросы, макросы низкоуровневого обнаружения.Это поле задает  [en] опцию cURL. |
| А`ктивировать трапы` | При включении этой опции, элемент данных будет работать также и как траппер элемент данных и будет принимать данные, которые отправляются на этот элемент данных при помощи sender или с использованием протокола sender. |
| Р`азрешенные хосты` | Доступно, только если выбрана опция "`Активировать трапы".`Список разделенных запятыми IP-адресов, опционально в CIDR-представлении, или DNS-имен.Если задано, входящие подключения будут приниматься только с перечисленных здесь узлов сети.Если включена поддержка IPv6, то "`127.0.0.1", "::127.0.0.1", "::ffff:127.0.0.1"` обрабатываются одинаково и "`::/0"` будет разрешать любые IPv4 или IPv6-адреса."`0.0.0.0/0"` можно использовать, чтобы разрешить любые IPv4-адреса.Следует обратить внимание, что "IPv4-совместимые IPv6-адреса" (0000::/96 префикс) поддерживаются, но являются устаревшими согласно .Пример: `127.0.0.1, 192.168.1.0/24, 192.168.3.1-255, 192.168.1-10.1-255, ::1,2001:db8::/32, mysqlserver1, mon.rosa.dev,` `{HOST.HOST}`В этом поле разрешены пробелы и пользовательские макросы.Макросы узлов сети: `{HOST.HOST},` `{HOST.NAME},` `{HOST.IP},` `{HOST.DNS},` `{HOST.CONN} `– поддерживаются в этом поле. |

Если поле HTTP-Прокси оставить пустым, можно воспользоваться другим способом указать HTTP-Прокси, для чего необходимо задать переменные окружения.

Для HTTP-проверок нужно указать переменную окружения http_proxy для пользователя Сервера, например:

```bash Terminal
http_proxy=http://proxy_ip:proxy_port.
```

Для HTTPS-проверок нужно указать переменную окружения HTTPS_PROXY, например:

```bash Terminal
HTTPS_PROXY=http://proxy_ip:proxy_port.
```

Подсистема поддерживает файлы сертификатов и закрытых ключей (private keys) только в формате PEM. В случае если имеются данные сертификата и закрытого ключа в формате файла PKCS #12 (обычно поставляются с расширениями *.p12 или *.pfx), можно сгенерировать из них PEM-файл, используя следующие команды:

```bash Terminal
openssl pkcs12 -in ssl-cert.p12 -clcerts -nokeys -out ssl-cert.pem
openssl pkcs12 -in ssl-cert.p12 -nocerts -nodes -out ssl-cert.key
```

# Д.9.2 Настройка элемента данных

Подсистема может опрашивать метрики, представленные в формате строки Prometheus.

Чтобы начать сбор данных Prometheus, необходимо выполнить два шага:

1. настроить основной элемент данных HTTP, указывающий на соответствующую конечную точку данных, например `https://<хост prometheus>/metrics;`
2. настроить зависимые элементы данных, использующие опцию предварительной обработки Prometheus для запроса необходимых данных из метрик, собранных основным элементом данных.

Существует два варианта предварительной обработки данных Prometheus:

- `Шаблон Prometheus `– используется в обычных элементах данных для запроса метрик Prometheus;
- `Prometheus в JSON `– используется в обычных элементах данных и для низкоуровневого обнаружения; в этом случае запрашиваемые данные Prometheus возвращаются в формате JSON.

Для зависимых метрик поддерживается массовая обработка. Чтобы включить кэширование и индексацию, первым шагом предварительной обработки должен быть "Шаблон Prometheus". Если "Шаблон Prometheus" является первым шагом предварительной обработки, то проанализированные данные Prometheus кэшируются и индексируются по первому условию <метка>==<значение> в шаге предварительной обработки "Шаблон Prometheus". Этот кэш используется повторно при обработке остальных зависимых элементов данных в этом пакете. Для достижения оптимальной производительности первая метка должна быть одной из тех, у которых наиболее разные значения.

Если другие операции предварительные обработки необходимо выполнить до первого шага, то их необходимо переместить либо в основной элемент данных, либо в новый зависимый элемент данных, который затем можно использовать в качестве основного элемента данных для этих зависимых элементов данных.

Если настроен основной элемент данных HTTP, нужно создать зависимый элемент данных, который использует шаг предварительной обработки Prometheus:

1. ввести общие параметры зависимого элемента данных в окне настройки;
2. перейти на вкладку Предобработка**;**
3. выбрать шаг предобработки Prometheus ("Шаблон Prometheus" или "Prometheus в JSON");

Параметры, указанные в таблице 86, специфичны для опции предобработки "Шаблон Prometheus".

1. Параметры для опции предобработки "`Шаблон Prometheus"`

| Параметр | Описание | Примеры |
| --- | --- | --- |
| Ш`аблон` | Чтобы определить необходимый шаблон данных, можно использовать язык запросов, который похож на язык запросов Prometheus, например:`<имя метрики> `– выбор по названию метрики;`{__name__="<имя метрики>"} `– выбор по названию метрики;`{__name__=~"<регулярное выражение>"} `– выбор по названию метрики, совпадающему с регулярным выражением;`{<имя метки>="<значение метки>",...} `– выбор по имени метки;`{<имя метки>=~"<регулярное выражение>",...} `– выбор по имени метки, совпадающему с регулярным выражением;`{__name__=~".*"}=`=<значение> – выбор по значению метрики.Или сочетание вышеперечисленного:`<имя метрики>{<имя метки1>="<значение метки1>",<имя метки2>=~"<регулярное выражение>",...}==<значение>`Значением метки может быть любая последовательность символов UTF-8, но символы обратной косой черты, двойных кавычек и перевода строки необходимо экранированы как `\\,` `\"` и `\n `соответственно; другие символы не требуется экранировать. | `wmi_os_physical_memory_free_Bytescpu_usage_system{cpu="cpu-total"}cpu_usage_system{cpu=~".*"}cpu_usage_system{cpu="cpu-total",host=~".*"}wmi_service_state{name="dhcp"}==1wmi_os_timezone{timezone=~".*"}==1` |
| Р`езультат обработки` | Указать, следует ли вернуть значение, метку или применить соответствующую функцию (если шаблон соответствует нескольким строкам и результат необходимо агрегировать):`значение `– получение значения метрики (ошибка, если совпадут несколько строк);`метка `– получение значения метки, указанной в поле `Метка `(ошибка, если совпадут несколько метрик);`сумма `– получение суммы значений;`мин `– получение минимального значения;`макс `– получение максимального значения;`сред `– получение среднего значения;`кол-во `– получение количества значений.Это поле доступно только для опции `Шаблон Prometheus.` |  |
| В`ывод` | Задать название метки (опционально). В этом случае вернется значение, соответствующее названию метки.Это поле доступно только для шага `Шаблон Prometheus,` если в поле "`Результат обработки" `выбрано "`Метка"`. |  |

Данные из Prometheus можно использовать для низкоуровневого обнаружения. В этом случае данные необходимы в формате JSON, и опция предобработки "Prometheus в JSON" вернет их в нужном формате.

В таблице 87 перечислены различия и сходства между PromQL и языком запросов предобработки Prometheus в Подсистеме.

1. Сравнение PromQL и Prometheus

| Мгновенный векторный селектор PromQL | Предобработка Prometheus в Подсистеме |
| --- | --- |
| Различия |
| Цель запроса | Сервер Prometheus | Простой текст в формате представления Prometheus |
| Возвращает | Мгновенный вектор | Значение метрики или метки (Шаблон Prometheus)Массив метрик для одиночного значения в JSON (Prometheus в JSON) |
| Операторы сопоставления меток | =, !=, =~, !~ | =, !=, =~, !~ |
| Регулярное выражение, используемое при сопоставлении метки или имени метрики | RE2 | PCRE |
| Операторы сравнения | См. список | Только == (равно) поддерживается для фильтрации значений |
| Сходства |
| Выбор по названию метрики, равному строке | <имя метрики> или `{__name__="<имя метрики>"}` | <имя метрики> или `{__name__="<имя метрики>"}` |
| Выбор по имени метрики, которое соответствует регулярному выражению | `{__name__=~"<регулярное выражение>"}` | `{__name__=~"<регулярное выражение>"}` |
| Выбор по значению <имя метки>, равному строке | `{<имя метки>="<значение метки>",...}` | `{<имя метки>="<значение метки>",...}` |
| Выбор по значению <имя метки>, которое соответствует регулярному выражению | `{<имя метки>=~"<регулярное выражение>",...}` | `{<имя метки>=~"<регулярное выражение>",...}` |
| Выбор по значению, равному строке | `{__name__=~".*"} `== <значение> | `{__name__=~".*"} `== <значение> |

# Д.10 Проверки через Telnet

Скриптовые элементы данных можно использовать для сбора данных путем выполнения пользовательского JavaScript-кода с возможностью получения данных через HTTP/HTTPS. В дополнение к скрипту можно указать опциональный список параметров (пары из имени и значения) и время ожидания.

Этот тип элементов данных может быть полезен в сценариях сбора данных, требующих нескольких шагов или сложной логики. Например, скриптовый элемент данных можно настроить на выполнение HTTP-вызова, последующей обработки данных, полученных на первом шаге, и передачи преобразованного значения второму HTTP-вызову.

Скриптовые элементы данные обрабатываются Сервером или Прокси на уровне поллеров.

В поле Тип окна настройки элемента данных нужно выбрать Скрипт, затем заполнить необходимые поля (рисунок 15).

::sign-image
---
src: /image22.png
sign: Рисунок 50 – Скриптовый элемент данных
---
::

1. Скриптовый элемент данных

Поля, которые требуют информацию, специфичную для элементов данных Скрипт, перечислены в таблице 88.

1. Поля для элементов данных Скрипт

| Поле | Описание |
| --- | --- |
| Ключ | Ввести уникальный ключ, который будет использоваться для идентификации этого элемента данных. |
| Параметры | Указать переменные, которые будут переданы скрипту как пары параметров и значений.Поддерживаются встроенные макросы `{HOST.CONN},` `{HOST.DNS},` `{HOST.HOST},` `{HOST.IP},` `{HOST.NAME},` `{ITEM.ID},` `{ITEM.KEY},` `{ITEM.KEY.ORIG} `и пользовательские макросы. |
| Скрипт | Ввести JavaScript-код в блоке, который появится при нажатии на поле параметров (или на кнопку просмотра/изменения сразу за полем параметров). Этот код должен обеспечивать логику получаемого значения метрики.Код имеет доступ ко всем параметрам, может выполнять запросы HTTP GET, POST, PUT и DELETE, а также имеет управление над HTTP-заголовками и телом запроса |
| Время ожидания | Время ожидания выполнения JavaScript (1-60s, по умолчанию 3s); превышение этого значения вернет ошибку.Поддерживаются суффиксы времени, например: 30s, 1m.В зависимости от скрипта срабатывание времени ожидания может занять больше времени. |

# Д.11 Внешние проверки

Элементы данных "Браузер" позволяют осуществлять мониторинг сложных веб-сайтов и веб-приложений с использованием браузера.

Браузерные элементы данных собирают данные, выполняя определённый пользователем код JavaScript и извлекая данные по HTTP/HTTPS. Этот элемент данных может имитировать такие действия браузера, как нажатие кнопкой "мыши", ввод текста, навигация по веб-страницам и другие виды взаимодействия пользователя с веб-сайтами или веб-приложениями.

В дополнение к скрипту можно указать необязательный список параметров (пар из имени и значения) и время ожидания.

Проверки браузерных элементов данных выполняются и обрабатываются процессами-поллерами браузерных элементов данных (browser pollers) сервера Подсистемы или прокси. При необходимости можно настроить количество предварительно созданных экземпляров процессов browser pollers в параметре StartBrowserPollers файла конфигурации Подсистемы.

Для мониторинга сложных веб-сайтов и веб-приложений среди готовых шаблонов доступен шаблон "Website by Browser".

Для настройки элемента данных в диалоге в поле "Тип (Type)" нужно выбрать "Браузер" и заполнить обязательные поля.

Поля, требующие информации, специфичной для элемента данных "Браузер", приведены в таблице 89.

1. Поля элемента данных "Браузер"

| **Поле** | **Описание** |
| --- | --- |
| Ключ (Key) | Ввести уникальный ключ, который будет использоваться для идентификации элемента данных |
| Параметры(Parameters) | Указать переменные, которые будут переданы в скрипт как пары "атрибут- значение".Поддерживаются пользовательские макросы. Чтобы узнать, какие встроенные макросы поддерживаются, выполните поиск по запросу "Браузер" в таблице поддерживаемых макросов |
| Скрипт(Script) | Ввести код JavaScript в модальном редакторе, который открывается при нажатии на поле параметра или на значок карандаша рядом с ним. Этот код должен предоставлять логику для возврата значения метрики.Код имеет доступ ко всем параметрам, всем дополнительным объектам JavaScript и объектам JavaScript элемента данных "Браузер", добавленным Подсистемой |
| Время ожидания(Timeout) | Тайм-аут выполнения JavaScript (1-600s; при его превышении будет возвращена ошибка).Следует обратить внимание, что в зависимости от скрипта для срабатывания тайм-аута может потребоваться больше времени |

Приложение Е. Пользовательские команды

# Д.11.1 Результат внешней проверки

zabbix_agent2 – демон Агента-2 для мониторинга параметров различных служб.

Синтаксис:

```bash Terminal
zabbix_agent2 [-c config-file]
zabbix_agent2 [-c config-file] -p
zabbix_agent2 [-c config-file] -t item-key
zabbix_agent2 [-c config-file] -R runtime-option
zabbix_agent2 -h
zabbix_agent2 -V
```

Параметры:

-c, --config config-file – использование альтернативного файла конфигурации config-file вместо файла по умолчанию;

-R, --runtime-control runtime-option – выполнение административных функций в соответствии с runtime-option.

Выполнение административных функций:

- UserParameter reload** **– повторная загрузка пользовательских параметров из файла конфигурации;
- loglevel increase – увеличение уровня журналирования;
- loglevel decrease – уменьшение уровня журналирования;
- help – Список доступных административных функций;
- metrics – список доступных метрик;
- version – вывод номера версии;

-p, --print – вывод известных элементов данных и выход. Для каждого элемента данных используются либо общие значения по умолчанию, либо предоставляются определенные значения по умолчанию для тестирования. Эти значения по умолчанию перечислены в квадратных скобках в качестве параметров ключей элементов данных. Возвращаемые значения заключены в квадратные скобки с префиксом типа данных возвращаемого значения, разделенные вертикальной чертой. Для пользовательских параметров всегда используется "t", так как Агент не может определить все возможные варианты возвращаемых значений. Элементы данных, которые отображаются как работающие, не обязательно будут работать при опросе запущенного демона Агента со стороны Сервера или утилиты zabbix_get, так как доступы или среда могут различаться.

Типы возвращаемых значений:

- `d `– число с плавающей точкой;
- `m `– не поддерживается. Такое может произойти из-за запроса элемента данных, который работает только в активном режиме, таких как элемент данных наблюдения за журналом, элемент данных, требующий нескольких собранных значений. Проблемы прав доступа или некорректные пользовательские параметры могут также привести к неподдерживаемому состоянию;
- `s `– текст. Максимальная длина не ограничена;
- `t –` текст. По аналогии с s;
- `u `– беззнаковое целое число.
  - -t, --test item-key – тестирование одного элемента данных и выход. См. --print для вывода описания.
  - -h, --help – вывод справочной информации и выход;
  - -V, --version – вывод информации о версии и выход.

Расположение файла конфигурации Агента-2 по умолчанию – /usr/local/etc/zabbix_agent2.conf.

# Д.12 Траппер-элементы данных

zabbix_agentd – демон Агента (служба) для мониторинга различных параметров Сервера.

Синтаксис:

```bash Terminal
zabbix_agentd [-c config-file]
zabbix_agentd [-c config-file] -p
zabbix_agentd [-c config-file] -t item-key
zabbix_agentd [-c config-file] -R runtime-option
zabbix_agentd -h
zabbix_agentd -V
```

Параметры:

- -c, --config config-file – использование альтернативного файла конфигурации config-file вместо файла по умолчанию;
- -f, --foreground – запуск Агента на переднем плане (отключение перехода в фоновый режим);
- -R, --runtime-control runtime-option – выполнение административных функций в соответствии с runtime-option.

Возможные значения административных функций (runtime-option):

- UserParameter_reload –загрузка заново пользовательских параметров из файла конфигурации;
- log_level_increase[=цель]– повышение уровня журналирования, влияющее на все процессы, если цель не указана;
- log_level_decrease[=цель] – понижение уровня журналирования, влияющее на все процессы, если цель не указана;

Цели для управления уровнем журналирования:

- тип-процесса – все процессы указанного типа (`active checks,` `collector,` `LISTENer)`;
- тип-процесса,N – тип и номер процесса (например, "LISTENer,3");
- pid – идентификатор процесса, до 65535. Для больших значений указывают цель как "тип-процесса,N";
- version – вывод номера версии;
- -p, --print – вывод известных элементов данных и выход. Для каждого элемента данных используются либо общие значения по умолчанию, либо предоставляются определенные значения по умолчанию для тестирования. Эти значения по умолчанию перечислены в квадратных скобках в качестве параметров ключей элементов данных. Возвращаемые значения заключены в квадратные скобки с префиксом типа данных возвращаемого значения, разделенные вертикальной чертой. Для пользовательских параметров всегда используется `"t`", так как Агент не может определить все возможные варианты возвращаемых значений. Элементы данных, которые отображаются как работающие, не обязательно будут работать при опросе запущенного демона Агента со стороны Сервера или утилиты zabbix_get, так как доступы или среда могут различаться.

Типы возвращаемых значений:

- `d `– число с плавающей точкой;
- `m `– не поддерживается. Такое может произойти из-за запроса элемента данных, который работает только в активном режиме, таких как элемент данных наблюдения за журналом, элемент данных, требующий нескольких собранных значений. Проблемы прав доступа или некорректные пользовательские параметры могут также привести к неподдерживаемому состоянию;
- `s `– текст. Максимальная длина не ограничена;
- `t `– текст. По аналогии с s;
- `u `– беззнаковое целое число.
  - -t, --test item-key – тестирование одного элемента данных и выход. См. --print для вывода описания.
  - -h, --help – вывод справочной информации и выход;
  - -V, --version – вывод информации о версии и выход.

Расположение по умолчанию файла конфигурации Агента – /usr/local/etc/zabbix_agentd.conf.

# Д.13 JMX-мониторинг

zabbix_get – утилита командной строки для получения метрик, которая используется для получения данных от Агента Подсистемы.

Синтаксис:

```bash Terminal
zabbix_get -s имя-узла-сети-или-IP [-p номер-порта] [-I IP-адрес] [-t тайм-аут] -k ключ-элемента-данных
zabbix_get -s имя-узла-сети-или-IP [-p номер-порта] [-I IP-адрес] [-t тайм-аут] --tls-connect cert --tls-ca-file CA-файл [--tls-crl-file CRL-file] [--tls-agent-cert-issuer эмитент] [--tls-agent-cert-subject субъект] --tls-cert-file файл-сертификата --tls-key-file файл-ключа [--tls-cipher13 строка-шифра] [--tls-cipher строка-шифра] -k ключ-элемента-данных
zabbix_get -s имя-узла-сети-или-IP [-p номер-порта] [-I IP-адрес] [-t тайм-аут] --tls-connect psk --tls-psk-identity идентификатор-PSK --tls-psk-file файл-PSK [--tls-cipher13 строка-шифра] [--tls-cipher строка-шифра] -k ключ-элемента-данных
zabbix_get -h
zabbix_get -V
```

Параметры:

- -s, --host имя-узла-сети-или-IP – имя узла сети или IP-адрес узла сети;
- -p, --port номер-порта – номер порта Агента, работающего на хосте. По умолчанию 10050;
- -I, --source-address IP-адре`с `– исходящий IP-адрес;
- -t, --Timeout секунды – время ожидания в допустимом диапазоне 1-30 секунд (по умолчанию: 30);
- -k, --key ключ-элемента-данных – ключ элемента данных, для которого необходимо получить значение;
- --tls-connect значение – способ подключения к Агенту. Значения:
- unencrypted – подключение без шифрования (по умолчанию);
- psk – подключение с использованием TLS и общего ключа (pre-shared key, PSK);
- cert – подключение с использованием TLS и сертификата;
  - --tls-ca-file CA-file – полный путь к файлу, содержащему сертификаты CA верхнего уровня для проверки сертификата партнера;
  - --tls-crl-file CRL-file – полный путь к файлу, содержащему отозванные сертификаты;
  - --tls-agent-cert-issuer эмитент – разрешенный эмитент сертификата Агента;
  - --tls-agent-cert-subject субъект – разрешенный субъект сертификата Агента;
  - --tls-cert-file файл-сертификата – полный путь к файлу, содержащему сертификат или цепочку сертификатов;
  - --tls-key-file файл-ключа – полный путь к файлу, содержащему закрытый ключ (private key);
  - --tls-psk-identity идентификатор-PSK – строка идентификатора PSK;
  - --tls-psk-file файл-PSK – полный путь к файлу, содержащему общий ключ (pre-shared key);
  - --tls-cipher13 строка-шифра – строка шифра для OpenSSL 1.1.1 или новее для TLS 1.3. Переопределить критерии выбора набора шифров по умолчанию. Эта опция недоступна, если версия OpenSSL ниже 1.1.1;
  - --tls-cipher строка-шифра – строка приоритета GnuTLS (для TLS 1.2 и выше) или строка шифра OpenSSL (только для TLS 1.2). Переопределить критерии выбора набора шифров по умолчанию;
  - -h, --help – вывод справочной информации и выход;
  - -V, --version – вывод информации о версии и выход.

# Д.13.1 Включение удаленного JMX-мониторинга для Java-приложений

zabbix_js – утилита командной строки для выполнения скриптов JavaScript.

Синтаксис:

```bash Terminal
zabbix_js -s файл-скрипта -p входной-параметр [-l log-level] [-t Timeout]
zabbix_js -s файл-скрипта -i входной-файл [-l log-level] [-t тайм-аут]
zabbix_js -h
zabbix_js -V
```

Параметры:

- -s, --script файл-скрипта – имя файла скрипта для выполнения. Если в качестве имени файла указано `"-",` скрипт будет прочитан из стандартного ввода;
- -p, --param `входной-параметр `–входной параметр;
- -i, --input `входной-файл `– имя файла входного параметра. Если в качестве имени файла указано `"-",` `входной-параметр `будет считан из стандартного ввода;
- -l, --loglevel уровень-журналирования – уровень журналирования;
- -t, --Timeout тайм-аут – время ожидания в секундах. Допустимый диапазон: 1-60 секунд (по умолчанию: 10);
- -h, --help** **– вывод справочной информации и выход;
- -V, --version – вывод информации о версии и выход.

# Д.13.2 Настройка JMX-интерфейсов и элементов данных в веб-интерфейсе

zabbix_proxy – демон сервиса Прокси, который собирает данные мониторинга с устройств и отправляет их на Сервер.

Синтаксис:

```bash Terminal
zabbix_proxy [-c config-file]
zabbix_proxy [-c config-file] -R runtime-option
zabbix_proxy -h
zabbix_proxy -V
```

Параметры:

- -c, --config config-file – использование альтернативного файла конфигурации config-file вместо файла по умолчанию;
- -f, --foreground – запуск Прокси на переднем плане;
- -R, --runtime-control runtime-option – выполнение административных функций в соответствии с runtime-option. Параметры runtime-option:
- config_cache_reload – перезагрузка кэша конфигурации. Игнорируется, если кэш в данный момент загружается. Активный Прокси подключится к Серверу и запросит данные конфигурации. Сигнал будет отправлен процессу, указанному в файле PID, для поиска которого будет использован файл конфигурации по умолчанию (если не указана опция `-c)`;
- snmp_cache_reload – перезагрузка кэш SNMP;
- housekeeper_execute – запуск процесса housekeeper. Игнорируется, если housekeeper в данный момент выполняется;
- diaginfo[=раздел] – запись внутренней диагностической информации указанного раздела. Раздел может быть `historycache,` `preprocessing.` По умолчанию диагностическая информация всех разделов логируется;
- log_level_increase[=цель] – повышение уровня логирования; влияет на все процессы, если цель не указана;
- log_level_decrease[=цель] – понижение уровня логирования: влияет на все процессы, если цель не указана;

Цели для управления уровнем журналирования:

- тип-процесса – все процессы указанного типа (configuration syncer, data sender, discoverer, heartbeat sender, history syncer, housekeeper, http poller, icmp pinger, ipmi manager, ipmi poller, java poller, poller, self-monitoring, snmp trapper, task manager, trapper, unreachable poller, vmware collector);
- тип-процесса,N – тип и номер процесса (например, "poller,3");
- pid – идентификатор процесса, до 65535. Для больших значений указать цель как "тип-процесса,N";
  - -h, --help – вывод справочной информации и выход;
  - -V, --version – вывод информацию о версии и выход.

Расположение по умолчанию файла конфигурации Прокси – /usr/local/etc/zabbix_proxy.conf.

# Д.13.3 Детальная информация о ключах JMX-элементов данных

zabbix_sender – это утилита командной строки для отправки значений мониторинга на Сервер или Прокси. На Сервере должен быть создан элемент данных типа траппер с соответствующим ключом. Следует обратить внимание, что входящие данные будут приняты только от узлов сети, указанных в поле "Разрешенные хосты" для этого элемента данных.

Синтаксис:

```bash Terminal
zabbix_sender [-v] -z сервер [-p порт] [-I IP-адрес] [-t тайм-аут] -s узел-сети -k ключ -o значение
zabbix_sender [-v] -z сервер [-p порт] [-I IP-адрес] [-t тайм-аут] [-s узел-сети] [-T] [-N] [-r] -i входной-файл
zabbix_sender [-v] -c config-file [-z сервер] [-p порт] [-I IP-адрес] [-t тайм-аут] [-s узел-сети] -k ключ -o значение
zabbix_sender [-v] -c config-file [-z сервер] [-p порт] [-I IP-адрес] [-t тайм-аут] [-s узел-сети] [-T] [-N] [-r] -i входной-файл
zabbix_sender [-v] -z сервер [-p порт] [-I IP-адрес] [-t тайм-аут] -s узел-сети --tls-connect cert --tls-ca-file CA-file [--tls-crl-file CRL-file] [--tls-server-cert-issuer эмитент] [--tls-server-cert-subject субъект] --tls-cert-file cert-file --tls-key-file key-file [--tls-cipher13 cipher-string] [--tls-cipher cipher-string] -k ключ -o значение
zabbix_sender [-v] -z сервер [-p порт] [-I IP-адрес] [-t тайм-аут] [-s узел-сети] --tls-connect cert --tls-ca-file CA-file [--tls-crl-file CRL-file] [--tls-server-cert-issuer эмитент] [--tls-server-cert-subject субъект] --tls-cert-file cert-file --tls-key-file key-file [--tls-cipher13 cipher-string] [--tls-cipher cipher-string] [-T] [-N] [-r] -i входной-файл
zabbix_sender [-v] -c config-file [-z сервер] [-p порт] [-I IP-адрес] [-t тайм-аут] [-s узел-сети] --tls-connect cert --tls-ca-file CA-file [--tls-crl-file CRL-file] [--tls-server-cert-issuer эмитент] [--tls-server-cert-subject субъект] --tls-cert-file cert-file --tls-key-file key-file [--tls-cipher13 cipher-string] [--tls-cipher cipher-string] -k ключ -o значение
zabbix_sender [-v] -c config-file [-z сервер] [-p порт] [-I IP-адрес] [-t тайм-аут] [-s узел-сети] --tls-connect cert --tls-ca-file CA-file [--tls-crl-file CRL-file] [--tls-server-cert-issuer эмитент] [--tls-server-cert-subject субъект] --tls-cert-file cert-file --tls-key-file key-file [--tls-cipher13 cipher-string] [--tls-cipher cipher-string] [-T] [-N] [-r] -i входной-файл
zabbix_sender [-v] -z сервер [-p порт] [-I IP-адрес] [-t тайм-аут] -s узел-сети --tls-connect psk --tls-psk-identity PSK-identity --tls-psk-file PSK-file [--tls-cipher13 cipher-string] [--tls-cipher cipher-string] -k ключ -o значение
zabbix_sender [-v] -z сервер [-p порт] [-I IP-адрес] [-t тайм-аут] [-s узел-сети] --tls-connect psk --tls-psk-identity PSK-identity --tls-psk-file PSK-file [--tls-cipher13 cipher-string] [--tls-cipher cipher-string] [-T] [-N] [-r] -i входной-файл
zabbix_sender [-v] -c config-file [-z сервер] [-p порт] [-I IP-адрес] [-t тайм-аут] [-s узел-сети] --tls-connect psk --tls-psk-identity PSK-identity --tls-psk-file PSK-file [--tls-cipher13 cipher-string] [--tls-cipher cipher-string] -k ключ -o значение
zabbix_sender [-v] -c config-file [-z сервер] [-p порт] [-I IP-адрес] [-t тайм-аут] [-s узел-сети] --tls-connect psk --tls-psk-identity PSK-identity --tls-psk-file PSK-file [--tls-cipher13 cipher-string] [--tls-cipher cipher-string] [-T] [-N] [-r] -i входной-файл
zabbix_sender -h
zabbix_sender -V
```

Параметры:

- -c, --config config-file – использование файла конфигурации `config-file.` Sender считывает сведения о Сервере из файла конфигурации agentd. По умолчанию sender не читает ни один конфигурационный файл. Поддерживаются только параметры `Hostname,` `ServerActive,` `SourceIP,` `TLSConnect,` `TLSCAFile,` `TLSCRLFile,` `TLSServerCertIssuer,` `TLSServerCertSubject,` `TLSCertFile,` `TLSKeyFile,` `TLSPSKIdentity `и `TLSPSKFile.` Все адреса, определенные в параметре конфигурации Агента `ServerActive,` используются для отправки данных. Если отправка пакетных данных на один адрес не удается, следующие пакеты на этот адрес не отправляются;
- -z, --zabbix-server сервер – имя хоста или IP-адрес Сервера. Если узел сети контролируется Прокси-сервером, вместо него следует использовать имя хоста или IP-адрес Прокси-сервера. При использовании вместе с `--config `переопределяет запись параметра `ServerActive,` указанного в файле конфигурации agentd;
- `-p,` `--port порт –` номер порта траппера Сервера, запущенного на Сервере. Значение по умолчанию – 10051. При использовании вместе с `--config `переопределяет значение порта параметра `ServerActive,` указанного в файле конфигурации agentd;
- `-I,` `--source-address IP-адрес `– исходящий IP-адрес. При использовании вместе с `--config,` переопределяет параметр `SourceIP,` указанный в файле конфигурации agentd;
- `-t,` `--Timeout тайм-аут `– время ожидания (тайм-аут). Допустимый диапазон: 1-300 секунд (по умолчанию: 60);
- `-s,` `--host узел-сети `– имя узла сети, которому принадлежит элемент данных (как зарегистрировано в веб-интерфейсе). IP-адрес хоста и DNS-имя работать не будут. При использовании вместе с `--config,` переопределяет параметр `Hostname,` указанный в файле конфигурации agentd;
- `-k,` `--key ключ `– ключ элемента данных для отправки значения;
- `-o,` `--value значение `– значение элемента данных;
- `-i,` `--input-file входной-файл `– загрузка значений из входного файла. Указать "`-"` (знак минуса) как `<input-file>,` чтобы считывать значения из стандартного ввода. Каждая строка файла содержит разделенные пробелом "`<узел-сети> <ключ> <значение>".` Каждое значение должно быть указано в отдельной строке. Каждая строка должна содержать 3 разделенных пробелом поля "`<узел-сети> <ключ> <значение>",` где "`узел-сети"` – это имя отслеживаемого узла сети, как зарегистрировано в веб-интерфейсе, "`ключ"` – это ключ целевого элемента, а "`значение"` – значение для отправки. Указать "`-"` (знак минуса) в качестве значения поля `<узел-сети>,` чтобы использовать имя узла сети из файла конфигурации Агента или из аргумента `--host.`

Пример строки входного файла:

```bash Terminal
"Linux DB3" db.connections 43
```

Тип значения должен быть правильно задан в настройках элемента данных в веб-интерфейсе. Sender отправит до 250 значений за одно соединение. Ограничение размера для отсылаемых данных из входного файла зависит от размера, описанного в протоколе коммуникации Подсистемы. Содержимое входного файла должно быть в кодировке UTF-8. Все значения из входного файла отправляются последовательно сверху вниз. Записи должен быть отформатированы, используя следующие правила:

- поддерживаются записи в кавычках и без кавычек;
- двойная кавычка – это символ, заключающий в кавычки;
- поля с пробелами должны быть заключены в кавычки;
- символы двойных кавычек и обратной косой черты внутри заключенной в кавычки записи должны быть экранированы обратной косой чертой (обратный слеш);
- экранирование не поддерживается в записях без кавычек;
- Escape-последовательности перевода строки (\n) поддерживаются в строках, заключенных в кавычки;
- экранирующие последовательности перевода строки обрезаются с конца записи.
- `-T,` `--with-timestamps –` этот параметр можно использовать только с параметром `--input-file.`

Каждая строка входного файла должна содержать 4 разделенных пробелами поля "<узел-сети> <ключ> <метка-времени> <значение>". <Метка-времени> должна быть указана в формате UNIX timestamp. Если целевой элемент данных имеет триггеры, ссылающиеся на него, то все метки времени должны быть в порядке возрастания, иначе вычисление событий будет неправильным.

Пример строки входного файла:

```bash Terminal
"Linux DB3" db.connections 1429533600 43
```

Если значение с меткой времени отправляется для хоста, который находится в обслуживании с типом "без данных", то это значение будет отброшено, но возможно отправить значение с меткой времени для истекшего периода обслуживания, и оно будет принято.

- `-N,` `--with-ns `– этот параметр можно использовать только с параметром `--with-timestamps.`

Каждая строка входного файла должна содержать 5 разделенных пробелами полей "<узел-сети> <ключ> <метка-времени> <наносекунды> <значение>".

Пример строки входного файла:

```bash Terminal
"Linux DB3" db.connections 1429533600 7402561 43
```

Для получения более подробной информации следует посмотреть опцию --input-file.

- `-r,` `--real-time `– отправка значений одно за другим, как только они будут получены. Это можно использовать при чтении из стандартного ввода;
- `--tls-connect значение `– способ подключения к Серверу или Прокси. Значения:
- `unencrypted `– подключение без шифрования (по умолчанию);
- `psk –` подключение с использованием TLS и общего ключа (pre-shared key);
- `cert `– подключение с использованием TLS и сертификата;
- `--tls-ca-file CA-file `– полный путь к файлу, содержащему сертификаты CA верхнего уровня для проверки сертификата партнера;
- `--tls-crl-file CRL-file `– полный путь к файлу, содержащему отозванные сертификаты;
- `--tls-server-cert-issuer эмитент `– разрешенный эмитент сертификата Сервера;
- `--tls-server-cert-subject субъект `– разрешенный субъект сертификата Сервера;
- `--tls-cert-file cert-file `– полный путь к файлу, содержащему сертификат или цепочку сертификатов;
- `--tls-key-file key-file `– полный путь к файлу, содержащему закрытый ключ (private key).
- `--tls-psk-identity PSK-identity `– строка идентификации PSK;
- `--tls-psk-file PSK-file `– полный путь к файлу, содержащему общий ключ (pre-shared key);
- `--tls-cipher13 cipher-string `– строка шифра для OpenSSL 1.1.1 или новее для TLS 1.3. Переопределить критерии выбора набора шифров по умолчанию. Эта опция недоступна, если версия OpenSSL ниже 1.1.1;
- `--tls-cipher cipher-string `– строка приоритета GnuTLS (для TLS 1.2 и выше) или строка шифра OpenSSL (только для TLS 1.2). Переопределить критерии выбора набора шифров по умолчанию;
- `-v,` `--verbose `– подробный режим, `-vv `для еще более подробного;
- `-h,` `--help `– вывод справочной информации и выход;
- `-V,` `--version `– вывод информации о версии и выход.

Статус завершения равен 0, если значения были отправлены и все они были успешно обработаны Сервером. Если данные были отправлены, но обработка хотя бы одного из значений не удалась, статус завершения равен 2. Если отправка данных не удалось, статус завершения будет 1.

# Д.14 ODBC-мониторинг

zabbix_server – основной демон службы Сервера Подсистемы.

Синтаксис:

```bash Terminal
zabbix_server [-c config-file]
zabbix_server [-c config-file] -R runtime-option
zabbix_server -h
zabbix_server -V
```

Параметры:

- `-c,` `--config config-file `– использование альтернативного файла конфигурации `config-file `вместо файла по умолчанию;
- `-f,` `--foreground `– запуск Сервера на переднем плане;
- `-R,` `--runtime-control runtime-option –` выполнение административных функций в соответствии с `runtime-option;`
- `-h,` `--help `– вывод справочной информации и выход;
- `-V,` `--version `– вывод информации о версии и выход.

Опции выполнения административных функций:

- `config_cache_reload `– обновление кэша конфигурации. Игнорируется, если кэш уже в процессе загрузки. Для поиска PID-файла используется файл конфигурации по умолчанию (если опция `"-c" `не была указана), сигнал будет отправлен тому процессу, который указан в PID-файле;
- `SNMP_cache_reload `– перезагрузка кэша SNMP;
- `housekeeper_execute `– выполнение процесса очистки истории. Игнорируется, если процесс очистки истории уже выполняется;
- `trigger_housekeeper_execute `– запуск процедуры очистки триггеров. Игнорируется, если процедура очистки триггеров уже работает;
- `diaginfo[`=`раздел]` – запись в журнал внутренней диагностической информации указанного раздела. Раздел может быть `historycache,` `preprocessing,` `alerting,` `lld,` `valuecache.` По умолчанию логируется диагностическая информация всех разделов;
- `ha_status `– запись в журнал состояния кластера высокой доступности (HA);
- `ha_remove_node[`=`цель]` – удаление из кластера высокой доступности (HA) ноды, указанной по своему имени или ID. Следует обратить внимание, что активные/резервные ноды удалить нельзя;
- `ha_set_failover_delay[`=`delay]` – изменение задержки автоматического переключения кластера высокой доступности (HA). Поддерживаются суффиксы времени, например: 10s, 1m;
- `secrets_reload `– загрузка заново секретов из Хранилища;
- `service_cache_reload `– обновление кэша менеджера услуг;
- `snmp_cache_reload `– сброс кэша SNMP с очисткой свойства SNMP для всех узлов сети (`engine time,` `engine boots,` `engine id,` `credentials)`;
- `prof_enable[`=`цель]` – включение профилирования. Если цель не указана, то влияет на все процессы. Включенное профилирование предоставляет подробности всех блокировок на "чтение/запись" и мьютексов по имени функции;
- `prof_disable[`=`цель]` – выключение профилирования. Если цель не указана, то влияет на все процессы;
- `log_level_increase[`=`цель]` – повышение уровня журналирования; если цель не указана, то влияет на все процессы;
- `log_level_decrease[`=`цель]` – понижение уровня журналирования; если цель не указана, то влияет на все процессы.

Цели управления уровнем журналирования:

- тип-процесса – все процессы указанного типа (alerter, alert manager, configuration syncer, discoverer, escalator, history syncer, housekeeper, http poller, icmp pinger, ipmi manager, ipmi poller, java poller, lld manager, lld worker, poller, preprocessing manager, preprocessing worker, proxy poller, self-monitoring, snmp trapper, task manager, timer, trapper, unreachable poller, vmware collector);
- тип-процесса,N – тип и номер процесса (например, "poller,3");
- pid – идентификатор процесса, до 65535. Для больших значений указать цель как "тип-процесса,N".

Расположение по умолчанию файла конфигурации Сервера – /usr/local/etc/zabbix_server.conf.

## Д.14.1 Установка unixODBC

zabbix_web_service – веб-сервис для предоставления доступа к компонентам Подсистемы.

Синтаксис:

```bash Terminal
zabbix_web_service [-c config-file]
zabbix_web_service -h
zabbix_web_service -V
```

Параметры:

- -c, --config config-file – использование альтернативного файла конфигурации config-file вместо файла по умолчанию;
- -h, --help – вывод справочной информации и выход;
- -V, --version – вывод информации о версии и выход.

Расположение по умолчанию файла конфигурации веб-сервиса – /usr/local/etc/zabbix_web_service.conf.

Приложение Ж. Поддерживаемые функции

В таблице 90 перечислены поддерживаемые функции и группы функций.

Эти функции поддерживаются в триггерных выражениях и вычисляемых элементах данных.

Функции цикла поддерживаются только для агрегированных вычислений.

1. Группы и функции

| Группа функций | Функции |
| --- | --- |
| Функции агрегации | `avg, bucket_percentile, count, histogram_quantile, item_count, kurtosis, mad, max, min, skewness, stddevpop, stddevsamp, sum, sumofsquares, varpop, varsamp` |
| Функции цикла (`foreach)` | `avg_foreach, bucket_rate_foreach, count_foreach, exists_foreach, last_foreach, max_foreach, min_foreach, sum_foreach` |
| Побитовые функции | `bitand, bitlshift, bitnot, bitor, bitrshift, bitxor` |
| Функции даты и времени | `date, dayofmonth, dayofweek, now, time` |
| Функции истории | `change, changecount, count, countunique, find, first, fuzzytime, last, logeventid, logseverity, logsource, monodec, monoinc, nodata, percentile, rate` |
| Функции динамики изменений | `baselinedev, baselinewma, trendavg, trendcount, trendmax, trendmin, trendstl, trendsum` |
| Математические функции | `abs, acos, asin, atan, atan2, avg, cbrt, ceil, cos, cosh, cot, degrees, e, exp, expm1, floor, log, log10, max, min, mod, pi, power, radians, rand, round, signum, sin, sinh, sqrt, sum, tan, truncate` |
| Операторные функции | `between, in` |
| Функции прогнозирования | `forecast, timeleft` |
| Строковые функции | `ascii, bitlength, Bytelength, char, concat, insert, left, length, ltrim, mid, repeat, replace, right, rtrim, trim` |

## Д.14.2 Установка драйверов unixODBC

Если не оговорено иначе, то все перечисленные в таблице 91 функции поддерживаются в:

- выражениях триггера;
- вычисляемых элементах данных.

Функции агрегации могут работать с:

- историей элементов данных, например: `min(/узел_сети/ключ,1h);`
- функциями `foreach в` качестве единственного параметра, например: `min(last_foreach(/*/ключ)) `(только в вычисляемых элементах данных; нельзя использовать в триггерах).

Некоторые общие замечания о параметрах функций:

- параметры функций разделяются запятыми;
- необязательные параметры функций (или части параметров) обозначаются угловыми скобками `"< >";`
- параметры, специфичные для функций, описываются с каждой функцией;
- параметры `/узел_сети/ключ и` `сек|#число)<:сдвиг_времени> н`икогда не должны заключаться в кавычки.

Общие параметры:

- `/узел_сети/ключ `– обязательный первый параметр для функций, ссылающихся на историю элемента данных узла сети;
- `(сек|#число)<:сдвиг_времени> `– второй параметр для функций, ссылающихся на историю элемента данных узла сети,
- где:
  - сек – максимальный период вычисления в секундах (могут использоваться суффиксы времени), либо
  - #число – максимальная область вычисления среди последних собранных значений (если начинается со знака решетки)
  - сдвиг_времени (опционально) – сдвиг точки вычислений по времени назад в прошлое.
    1. Функции агрегации

| Описание | Параметры, специфичные для функции | Комментарии |
| --- | --- | --- |
| a`vg (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>)` |
| Среднее значение элементов данных за указанный период вычислений. | См. общие параметры. | Поддерживаются типы значений: `float, int`Поддерживаемы функции `foreach: avg_foreach, count_foreach, exists_foreach, last_foreach, max_foreach, min_foreach, sum_foreachП`римеры:`=> avg(/узел_сети/ключ,1h) –` среднее значение за последний час до текущего момента`=> avg(/узел_сети/ключ,1h:now-1d) `– среднее значение за час с 25 часов назад до 24 часов назад от текущего момента`=> avg(/узел_сети/ключ,#5)–` среднее значение из пяти последних значений`=> avg(/узел_сети/ключ,#5:now-1d)–` среднее значение из пяти последних значений, исключая значения, полученные за последние 24 часаСдвиг времени полезен, когда нужно сравнить текущее среднее значение со средним значением некоторое время назад. |
| b`ucket_percentile (фильтр,период_времени,процент)` |
| Вычисление процентиля из разрядов гистограммы. | `фильтр `– см. фильтр элементов данных`"период_времени" `– см. период времени`процент `– процент (0-100) | Поддерживается только в вычисляемых элементах данных.Эта функция является алиасом для `histogram_quantile(процент/100, bucket_rate_foreach(фильтр, период_времени, 1))` |
| c`ount (функция_foreach(фильтр,<период_времени>))` |
| Количество значений в массиве, возвращаемом функцией `foreach.` | функция_`foreach `– функция `foreach,` для которой нужно подсчитать количество возвращаемых значений (с поддерживаемыми аргументами). | Поддерживаются типы значений`: int`Поддерживаются функции `foreach: avg_foreach, count_foreach, exists_foreach, last_foreach, max_foreach, min_foreach, sum_foreach`Пример:`=> count(max_foreach(/*/net.if.in[*],1h)) `– количество элементов данных в `net.if.in,` которые получали данные в течение последнего часа до текущего моментаСледует обратить внимание, что использование `count() `с функциями `foreach,` относящимися к истории (`max_foreach, avg_foreach `и т.п.), может сказаться на производительности, в то время как использование функции `exists_foreach(),` которая работает только с данными конфигурации, не окажет такого влияния. |
| h`istogram_quantile (квантиль,разряд1,значение1,разряд2,значение2,...)` |
| Вычисление φ-го квантиля из разрядов гистограммы. | `квантиль `– 0 ≤ φ ≤ 1`разрядN, значениеN `– вручную введенные пары (>=2) параметров либо результат вызова `bucket_rate_foreach` | Поддерживается только в вычисляемых элементах данных.Поддерживаются функции `foreach:` `bucket_rate_foreach`По функционалу соответствует "`histogram_quantile [en]"` из PromQL.Возвращает -1, если значения последнего разряда "`Infinity"` ("`+inf"`) равны 0.Примеры:`=> histogram_quantile(0.75,1.0,last(/узел_сети/rate_bucket[1.0]),"+Inf",last(/узел_сети/rate_bucket[Inf])=> histogram_quantile(0.5,bucket_rate_foreach(//item_key,30s))` |
| i`tem_count (фильтр)` |
| Подсчет существующих в конфигурации элементов данных, соответствующих критериям фильтра. | `фильтр `– критерий для выбора элементов данных, позволяет ссылаться на группы узлов сети, узлы сети, ключи элементов данных и теги. Поддерживаются подстановочные символы. | Поддерживается только в вычисляемых элементах данных.Поддерживаются типы значений`: int`Работает как алиас для функции `count(exists_foreach(фильтр)).`Пример:`=> item_count(/*/agent.ping?[group="Host group 1"]) `– количество узлов сети с элементом данных `agent.ping `в группе узлов сети "`Host group 1"` |
| k`urtosis (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>)` |
| Эксцесс ("островершинность") распределения вероятностей собранных значений в течение определенного периода оценки. | См. общие параметры. | Поддерживаются типы значений: `float, int`Поддерживаются функции `foreach:` `last_foreach`Пример:`=> kurtosis(/узел_сети/ключ,1h) `– эксцесс за последний час до текущего момента |
| m`ad (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>)` |
| Среднее абсолютное отклонение собранных значений в течение определенного периода оценки. | См. общие параметры. | Поддерживаются типы значений: `float, int`Поддерживаются функции `foreach:` `last_foreach`Пример:`=> mad(/узел_сети/ключ,1h)–` среднее абсолютное отклонение за последний час до текущего момента |
| m`ax (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>)` |
| Наибольшее значение элемента данных в течение определенного периода оценки. | См. общие параметры. | Поддерживаются типы значений: `float, int`Поддерживаются функции `foreach:` `avg_foreach, count_foreach, exists_foreach, last_foreach, max_foreach, min_foreach, sum_foreachП`ример:`=> max(/узел_сети/ключ,1h) – min(/узел_сети/ключ,1h) `– вычисление разницы между наибольшим и наименьшим значениями за последний час до текущего момента (дельта значений) |
| m`in (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>)` |
| Наименьшее значение элемента данных в течение определенного периода оценки. | См. общие параметры. | Поддерживаются типы значений:` float, int`Поддерживаются функции `foreach:` a`vg_foreach, count_foreach, exists_foreach, last_foreach, max_foreach, min_foreach, sum_foreachП`ример:`=> max(/узел_сети/ключ,1h) – min(/узел_сети/ключ,1h)–` вычисление разницы между наибольшим и наименьшим значениями за последний час до текущего момента (дельта значений) |
| s`kewness (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>)` |
| Асимметрия распределения вероятностей собранных значений в течение определенного периода оценки. | См. общие параметры. | Поддерживаются типы значений: `float, int`Поддерживаются функции `foreach: last_foreach`Пример:`=> skewness(/узел_сети/ключ,1h) `– коэффициент асимметрии за последний час до текущего момента |
| s`tddevpop (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>)` |
| Среднеквадратическое отклонение для генеральной совокупности собранных значений в течение определенного периода оценки. | См. общие параметры. | Поддерживаются типы значений:` float, int`Поддерживаются функции `foreach:` `last_foreach`Пример:`=> stddevpop(/узел_сети/ключ,1h) `– стандартное отклонение для генеральной совокупности за последний час до текущего момента |
| s`tddevsamp (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>)` |
| Среднеквадратическое отклонение для выборки собранных значений в течение определенного периода оценки. | См. общие параметры. | Поддерживаются типы значений: `float, int`Поддерживаются функции `foreach: last_foreach`Пример:`=> stddevsamp(/узел_сети/ключ,1h) `– стандартное отклонение для выборки за последний час до текущего момента |
| s`um (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>)` |
| Сумма собранных значений в течение определенного периода оценки. | См. общие параметры. | Поддерживаются типы значений:` float, int`Поддерживаются функции `foreach: avg_foreach, count_foreach, exists_foreach, last_foreach, max_foreach, min_foreach, sum_foreachП`ример:`=> sum(/узел_сети/ключ,1h) `– сумма значений за последний час до текущего момента |
| s`umofsquares (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>)` |
| Сумма квадратов собранных значений в течение определенного периода оценки. | См. общие параметры. | Поддерживаются типы значений:` float, int`Поддерживаются функции `foreach: last_foreach`Пример:`=> sumofsquares(/узел_сети/ключ,1h) `– сумма квадратов за последний час до текущего момента |
| v`arpop (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>)` |
| Генеральная (совокупная) дисперсия собранных значений в течение определенного периода оценки. | См. общие параметры. | Поддерживаются типы значений: `float, int`Поддерживаются функции `foreach:` `last_foreachП`ример:`=> varpop(/узел_сети/ключ,1h) `– дисперсия случайной величины за последний час до текущего момента |
| v`arsamp (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>)` |
| Выборочная дисперсия собранных значений в течение определенного периода оценки. | См. общие параметры. | Поддерживаются типы значений: `float, int`Поддерживаются функции `foreach:` `last_foreachД`ля работы этой функции требуется как минимум два значения данных.Пример:`=> varsamp(/узел_сети/ключ,1h) `– выборочная дисперсия за последний час до текущего момента |

## Д.14.3 Настройка unixODBC

Функции foreach (таблица 92) используются в агрегированных вычислениях, чтобы вернуть одно агрегированное значение для каждого из элементов данных, выбранных используемым фильтром элементов данных; возвращают массив значений.

Например, функция avg_foreach вернет массив значений, в котором каждое значение является средним значением истории выбранного элемента данных за указанный интервал времени.

Фильтр элементов данных является частью синтаксиса, используемого функциями foreach. В фильтре элементов данных поддерживаются подстановочные символы, поэтому нужные элементы данных могут быть выбраны достаточно гибко.

1. Поддерживаемые функции

| Функция | Описание |
| --- | --- |
| a`vg_foreach` | Возвращает среднее значение для каждого элемента данных. |
| b`ucket_rate_foreach` | Возвращает пары (верхняя граница разряда, значение доли), подходящие для использования в функции `histogram_quantile(),` где значение "`верхняя граница разряда"` – это значение параметра ключа элемента данных, определенного параметром `<номер параметра>.` |
| c`ount_foreach` | Возвращает количество значений для каждого элемента данных. |
| e`xists_foreach` | Возвращает "1" для каждого активированного элемента данных. |
| l`ast_foreach` | Возвращает последнее значение для каждого элемента данных. |
| m`ax_foreach` | Возвращает наибольшее значение для каждого элемента данных. |
| m`in_foreach` | Возвращает наименьшее значение для каждого элемента данных. |
| s`um_foreach` | Возвращает сумму значений для каждого элемента данных. |

Функции foreach поддерживают два общих параметра: фильтр_элементов_данных и период_времени:

```bash Terminal
функция_foreach(фильтр_элементов_данных,период_времени)
```

Например:

```bash Terminal
avg_foreach(/*/mysql.qps?[group="MySQL Servers"],5m)
```

вернет среднее за пять минут значение для каждого из элементов данных mysql.qps в группе "MySQL server".

Следует обратить внимание, что некоторые функции поддерживают дополнительные параметры.

Фильтр элементов данных состоит из четырех частей:

```bash Terminal
/узел_сети/ключ[параметры]?[условия]
```

где:

- `узел_сети `– имя узла сети;
- `ключ `– ключ элемента данных (без параметров);
- `параметры `– параметры ключа элемента данных;
- `условия `– условия на основе группы узлов сети и/или тега элемента данных (как выражение).

Пробелы допустимы только внутри выражения условий.

Использование подстановочных символов:

- Подстановочный символ может быть использован для замены имени узла сети, ключа элемента данных или отдельного параметра ключа элемента данных.
- Либо узел сети, либо ключ элемента данных должны быть указаны без подстановочного символа. Так, `/узел_сети/* `и `/*/ключ `являются корректными фильтрами, но `/*/* `некорректен.
- Подстановочный символ не может быть использован как `часть `имени узла сети, ключа элемента данных, параметра ключа элемента данных.
- Подстановочный символ соответствует не более чем одному параметру ключа элемента данных. Поэтому подстановочный символ должен быть указан для каждого параметра отдельно (т.е. `ключ[abc,*,*])`.

Выражение условий поддерживает:

- операнды:
- `group `– группа узлов сети;
- `tag –` тег элемента данных;
- `"<текст>"` – строковая константа, с использованием символа обратной косой черты `"\" `для экранирования символов `(") и` `(\);`
  - операторы сравнения, чувствительного к регистру: `"=",` `"<", ">";`
  - логические операторы: `and,` `or,` `not;`
  - группировка при помощи круглых скобок: `"( )".`

Строковые константы обязательно должны заключаться в кавычки. Поддерживается только чувствительное к регистру сравнение полных строк.

При указании в фильтре тегов (т.е. tag="имя_тега:значение"), двоеточие (":") используется как разделитель. Все после него рассматривается как значение тега. Поэтому в данный момент не поддерживается указание тегов, содержащих двоеточие (":") внутри имени.

Все упомянутые элементы данных должны существовать и собирать данные. В вычисления включаются только активированные элементы данных на активированных узлах сети.

Если ключ упомянутого элемента данных меняется, фильтр должен быть обновлен вручную.

Упоминание родительской группы узлов сети включает родительскую и все вложенные группы узлов сети с их элементами данных.

Второй параметр позволяет указать период времени для агрегирования. Период времени может быть указан только как время; количество значений (с префиксом #) не поддерживается.

Для удобства в этом параметре могут использоваться поддерживаемые символы единиц времени, например: "5m" (пять минут) вместо "300s" (300 секунд) или "1d" (одни сутки) вместо "86400" (86400 секунд).

Период времени игнорируется Сервером, если передан для функции last_foreach, и может быть опущен:

```bash Terminal
last_foreach(/*/ключ?[group="группа узлов сети"])
```

Период времени не поддерживается для функции exists_foreach.

Третий необязательный параметр поддерживается функцией bucket_rate_foreach:

```bash Terminal
bucket_rate_foreach(фильтр_элементов_данных,период_времени,<номер_параметра>)
```

где <номер_параметра> – это положение значения разряд в ключе элемента данных. Например, если в myItem[aaa,0.2] значением разряд является "0.2", то его положение – это 2.

Значением по умолчанию для "<номера параметра>" является "1".

Таблица 93 иллюстрирует, как каждая функция ведет себя в случае ограниченной доступности узла сети/элемента данных и данных истории.

1. Поведение, зависящее от доступности

| Функция | Узел сети деактивирован | Узел сети с данными недоступен | Узел сети без данных недоступен | Элемент данных деактивирован | Элемент данных не поддерживается | Ошибка извлечения данных (SQL) |
| --- | --- | --- | --- | --- | --- | --- |
| a`vg_foreach` | игнорировать | вернуть среднее | игнорировать | игнорировать | игнорировать | игнорировать |
| b`ucket_rate_foreach` | игнорировать | вернуть bucket rate | игнорировать | игнорировать | игнорировать | игнорировать |
| c`ount_foreach` | игнорировать | вернуть количество | 0 | игнорировать | игнорировать | игнорировать |
| e`xists_foreach` | игнорировать | 1 | 1 | игнорировать | 1 | n/a |
| l`ast_foreach` | игнорировать | вернуть последнее | игнорировать | игнорировать | игнорировать | игнорировать |
| m`ax_foreach` | игнорировать | вернуть максимум | игнорировать | игнорировать | игнорировать | игнорировать |
| m`in_foreach` | игнорировать | вернуть минимум | игнорировать | игнорировать | игнорировать | игнорировать |
| s`um_foreach` | игнорировать | вернуть сумму | игнорировать | игнорировать | игнорировать | игнорировать |

Если для элемента данных указано "игнорировать", к агрегированию ничего не добавляется.

## Д.14.4 Компиляция с поддержкой ODBC

Все перечисленные в таблице 94 функции поддерживаются в:

- триггерных выражениях;
- вычисляемых элементах данных.

Некоторые общие замечания о параметрах функций:

- параметры функций разделяются запятыми;
- в качестве параметров допустимы выражения;
- необязательные параметры функций (или части параметров) обозначаются угловыми скобками `"< >".`
1. Побитовые функции

| Описание | Параметры, специфичные для функции | Комментарии |
| --- | --- | --- |
| b`itand (значение,маска)` |
| Результат операции "побитовое И" значения элемента данных и маски. | `значение `– проверяемое значение`маска `(обязательно) – 64-битное целое без знака (0 – 18446744073709551615) | Поддерживаются типы значений`: int`Несмотря на то, что сравнение выполняется побитово, все значения должны быть представлены и затем возвращаются в десятичном формате. Например, проверка третьего бита выполняется путем сравнения с числом 4, а не 100.Примеры:`=> bitand(last(/узел_сети/ключ),12)=8 or bitand(last(/узел_сети/ключ),12)=4 `– выставлены третий или четвертый биты, но не оба сразу`=> bitand(last(/узел_сети/ключ),20)=16 `– третий бит не выставлен, а пятый – выставлен. |
| b`itlshift (значение,сдвиг_битов)` |
| Побитовый сдвиг значения элемента данных влево. | `значение `– проверяемое значение `сдвиг_битов (`обязательно) – количество битов для сдвига | Поддерживаются типы значений`: int`Несмотря на то, что сравнение выполняется побитово, все значения должны быть представлены и затем возвращаются в десятичном формате. Например, проверка третьего бита выполняется путем сравнения с числом 4, а не 100. |
| b`itnot (значение)` |
| Результат операции "побитовое НЕ" значения элемента данных. | `значение `– проверяемое значение | Поддерживаются типы значений`: int`Несмотря на то, что сравнение выполняется побитово, все значения должны быть представлены и затем возвращаются в десятичном формате. Например, проверка третьего бита выполняется путем сравнения с числом 4, а не 100. |
| b`itor (значение,маска)` |
| Результат операции "побитовое ИЛИ" значения элемента данных и маски. | `значение `– проверяемое значение `маска (`обязательно) – 64-битное целое без знака (0 – 18446744073709551615) | Поддерживаются типы значений`: int`Несмотря на то, что сравнение выполняется побитово, все значения должны быть представлены и затем возвращаются в десятичном формате. Например, проверка третьего бита выполняется путем сравнения с числом 4, а не 100. |
| b`itrshift (значение,сдвиг_битов)` |
| Побитовый сдвиг значения элемента данных вправо. | `значение `– проверяемое значение`сдвиг_битов (`обязательно) – количество битов для сдвига | Поддерживаются типы значений`: int`Несмотря на то, что сравнение выполняется побитово, все значения должны быть представлены и затем возвращаются в десятичном формате. Например, проверка третьего бита выполняется путем сравнения с числом 4, а не 100. |
| b`itxor (значение,маска)` |
| Результат операции "побитовое исключительное ИЛИ" значения элемента данных и маски. | `значение `– проверяемое значение`маска `(обязательно) – 64-битное целое без знака (0 – 18446744073709551615) | Поддерживаются типы значений`: int`Несмотря на то, что сравнение выполняется побитово, все значения должны быть представлены и затем возвращаются в десятичном формате. Например, проверка третьего бита выполняется путем сравнения с числом 4, а не 100. |

## Д.14.5 Настройка элемента данных в веб-интерфейсе

Все перечисленные в таблице 95 функции поддерживаются в:

- триггерных выражениях;
- вычисляемых элементах данных.

Функции даты и времени не могут быть использованы в выражении сами по себе; в выражении должна присутствовать еще хотя бы одна не относящаяся к дате/времени функция, ссылающаяся на элемент данных узла сети.

1. Функции даты и времени

| Описание | Параметры, специфичные для функции | Комментарии |
| --- | --- | --- |
| d`ate` |
| Текущая дата в формате `ГГГГММДД (YYYYMMDD).` |  | Пример:`=> date()<20240101` |
| d`ayofmonth` |
| Число месяца в диапазоне от 1 до 31. |  | Пример:`=> dayofmonth()=1` |
| d`ayofweek` |
| День недели в диапазоне от 1 до 7 (Пн – 1, Вс – 7). |  | Пример (только рабочие дни):`=> dayofweek()<6`Пример (только выходные):`=> dayofweek()>5` |
| n`ow` |
| Количество секунд с начала эпохи UNIX (00:00:00 1 января 1970 года по Гринвичу). |  | Пример:`=> now()<1640998800` |
| t`ime` |
| Текущее время в формате `ЧЧММСС (HHMMSS).` |  | Пример (только ночное время, 00:00-06:00):`=> time()<060000` |

## Д.14.6 Сообщения об ошибках

Все перечисленные в таблице 96 функции поддерживаются в:

- триггерных выражениях;
- вычисляемых элементах данных.

Некоторые общие замечания о параметрах функций:

- параметры функций разделяются запятыми;
- необязательные параметры функций (или части параметров) обозначаются угловыми скобками `"< >";`
- параметры, специфичные для функций, описываются с каждой функцией;
- параметры `/узел_сети/ключ `и `(сек|#число)<:сдвиг_времени> `не должны заключаться в кавычки.

Общие параметры:

- `/узел_сети/ключ `– обязательный первый параметр для функций, ссылающихся на историю элемента данных узла сети;
- `(сек|#число)<:сдвиг_времени> `– второй параметр для функций, ссылающихся на историю элемента данных узла сети, где:
- сек – максимальный период вычисления в секундах (могут использоваться суффиксы времени), либо;
- #число – максимальная область вычисления среди последних собранных значений (если начинается со знака решетки);
- сдвиг_времени (опционально) – сдвиг точки вычислений по времени назад в прошлое.
  1. Функции истории

| Описание | Параметры, специфичные для функции | Комментарии |
| --- | --- | --- |
| c`hange (/узел_сети/ключ)` |
| Величина разницы между последним и предыдущим значениями. |  | Поддерживаемые типы значений: `float, int, str, text, log`Для строк возвращается:0 – значения равны1 – значения отличаютсяПример:`=> change(/узел_сети/ключ)>10Р`азница между числовыми значениями будет вычисляться, как показано на примере следующих значений ("предыдущее" и "последнее" значение = разница):"`1" and "5" = +4"3" and "1" = -2"0" and "-2.5" = -2.5` |
| c`hangecount (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>,<режим>)` |
| Количество изменений между соседними значениями за определенный период вычисления. | См. общие параметры.`режим `(опционально; должен быть в двойных кавычках)Поддерживаются `режимы:all `– считать все изменения (по умолчанию)`dec `– считать убывания значений`inc `– считать возрастания значений | Поддерживаемые типы значений: `float, int, str, text, log`Для нечисловых типов значений параметр `режим `игнорируется.Примеры:`=> changecount(/узел_сети/ключ, 1w) – `количество изменений значения за последнюю неделю до текущего момента`=> changecount(/узел_сети/ключ,#10,"inc")–` количество возрастаний значений (относительно соседнего значения) среди последних 10 значений`=> changecount(/узел_сети/ключ,24h,"dec") `– количество убываний значений (относительно соседнего значения) за последние 24 часа до текущего момента |
| c`ount (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>,<оператор>,<шаблон>)` |
| Количество значений за период вычисления. | `оператор `(опционально) должен быть в двойных кавычках)Поддерживаются `операторы:eq `– равно (по умолчанию для` integer `и `float)ne `– не равно`gt `– больше, чем`ge `– больше или равно`lt `– меньше, чем`le `– меньше или равно`like `(по умолчанию для `string,` text и log) – содержит подстроку шаблона (чувствительно к регистру)`bitand `– побитовое И`regexp `– чувствительное к регистру соответствие регулярному выражению, данному в `шаблонеiregexp `– нечувствительное к регистру соответствие регулярному выражению, данному в `шаблоне`Примечание:`eq (`по умолчанию), `ne,` `gt,` `ge,` `lt,` `le,` `band,` `regexp,` `iregexp п`оддерживаются для целочисленных элементов данных`eq (`по умолчанию), `ne,` `gt,` `ge,` `lt,` `le,` `regexp,` `iregexp п`оддерживаются для элементов данных с плавающей точкой`like `(по умолчанию), `eq,` `ne,` `regexp,` `iregexp `поддерживаются для элементов данных символ, текст и журнал (лог)`шаблон `(опционально) – искомый шаблон (строковые аргументы должны быть в двойных кавычках) | Поддерживаемые типы значений: `float, integer, string, text, log`Элементы данных с плавающей точкой совпадают с точностью 2.22e-16; если база данных не обновлена, то точность составляет 0.000001.Если третий параметр `bitand,` то четвертый параметр `шаблон `может быть указан как два числа, разделенных косой чертой ("/"): `число_для_сравнения/маска. count() `вычисляет "побитовое И" из значения и `маски `и сравнивает результат с `числом_для_сравнения.` Если результат "побитового И" равен `числу_для_сравнения,` то значение считается.Если `число_для_сравнения `и `маска `равны, требуется указывать только `маску `(без "/").Если третий параметр `regexp `или `iregexp,` то четвертый параметр `шаблон `может быть обычным или глобальным (начинающимся с "@") регулярным выражением. В случае глобальных регулярных выражений чувствительность к регистру наследуется из настроек глобального регулярного выражения. При проверке соответствия регулярному выражению, значения с плавающей точкой всегда будут представлены с 4 цифрами после десятичной точки ("."). Также обратить внимание, что для больших чисел различие между десятичным (хранящимся в базе данных) и двоичным (используемом сервером) представлениями может повлиять на 4-ю десятичную цифру. |
| c`ountunique (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>,<оператор>,<шаблон>)` |
| Количество уникальных значений за определенный период вычисления. | См. общие параметры.`оператор (`опционально) должен быть в двойных кавычках)Поддерживаются `операторы:eq `– равно (по умолчанию для integer и float)`ne `– не равно`gt `– больше, чем`ge `– больше или равно`lt `– меньше, чем`le `– меньше или равно`like `(по умолчанию для `string,` t`ext и log)` – значение содержит подстроку, заданную в `шаблоне `(с учетом регистра)`bitand `– побитовое И`regexp `– чувствительное к регистру соответствие регулярному выражению, данному в `шаблонеiregexp `– нечувствительное к регистру соответствие регулярному выражению, данному в `шаблоне`Примечание:`eq `(по умолчанию), `ne,` `gt,` `ge,` `lt,` `le,` `band,` `regexp,` `iregexp `поддерживаются для целочисленных элементов данных`eq `(по умолчанию)), `ne,` `gt,` `ge,` `lt,` `le,` `regexp,` `iregexp `поддерживаются для элементов данных с плавающей точкой`like `(по умолчанию)), `eq,` `ne,` `regexp,` `iregexp `поддерживаются для элементов данных символ, текст и журнал (лог)`шаблон `(опционально) – искомый шаблон (строковые аргументы должны быть в двойных кавычках) | Поддерживаемые типы значений: `float, integer, string, text, log`Элементы данных с плавающей точкой совпадают с точностью 2.22e-16; если база данных не обновлена, то точность составляет 0.000001.Если третий параметр `bitand,` то четвертый параметр `шаблон `может быть указан как два числа, разделенных косой чертой ("/"): `число_для_сравнения/маска. countunique() `вычисляет "побитовое И" из значения и `маски `и сравнивает результат с `числом_для_сравнения.` Если результат "побитового И" равен `числу_для_сравнения,` то значение считается.Если `число_для_сравнения `и `маска `равны, требуется указывать только `маску `(без "/").Если третий параметр `regexp `или `iregexp,` то четвертый параметр `шаблон `может быть обычным или глобальным (начинающимся с "@") регулярным выражением. В случае глобальных регулярных выражений чувствительность к регистру наследуется из настроек глобального регулярного выражения. При проверке соответствия регулярному выражению, значения с плавающей точкой всегда будут представлены с 4 цифрами после десятичной точки ("."). Также обратить внимание, что для больших чисел различие между десятичным (хранящимся в базе данных) и двоичным (используемом сервером) представлениями может повлиять на 4-ю десятичную цифру. |
| f`ind (/узел_сети/ключ,<(сек\|#число)<:сдвиг_времени>>,<оператор>,<шаблон>)` |
| Поиск соответствующего значения. | См. общие параметры.`сек или #число `(опционально) – если не указано, то по умолчанию проверяется последнее значение`оператор `(опционально) должен быть заключен в двойные кавычки)Поддерживаются `операторы:eq `– равно (по умолчанию для integer и float)`ne `– не равно`gt `– больше, чем`ge `– больше или равно`lt `– меньше, чем`le `– меньше или равно`like `(по умолчанию для `string,` text и log) – значение содержит подстроку, заданную в `шаблоне `(с учетом регистра)`bitand `– побитовое И`regexp `– чувствительное к регистру соответствие регулярному выражению, данному в `шаблонеiregexp `– нечувствительное к регистру соответствие регулярному выражению, данному в `шаблоне`Примечание:`eq `(по умолчанию), `ne,` `gt,` `ge,` `lt,` `le,` `band,` `regexp,` `iregexp `поддерживаются для целочисленных элементов данных`eq `(по умолчанию), `ne,` `gt,` `ge,` `lt,` `le,` `regexp,` `iregexp `поддерживаются для элементов данных с плавающей точкой`like `(по умолчанию), `eq,` `ne,` `regexp,` `iregexp `поддерживаются для элементов данных символ, текст и журнал (лог)`шаблон –` искомый шаблон (строковые аргументы должны быть в двойных кавычках); регулярное выражение Perl Compatible Regular Expression (PCRE), если `оператор `– `regexp `или `iregexp.` | Поддерживаемые типы значений: `float, int, str, text, log`Возвращает:1 – найдено0 – иначеЕсли обрабатывается более одного значения, "1" возвращается, если имеется по крайней мере одно совпадающее значение.С третьим параметром `regexp `или `iregexp,` четвертый параметр `шаблон `может быть обычным или глобальным (начинающимся с "@") регулярным выражением. В случае глобальных регулярных выражений чувствительность к регистру наследуется из настроек глобального регулярного выражения.Пример:`=> find(/узел_сети/ключ,10m,"like","error") `– найти значение, содержащее "`error"` за последние 10 минут до текущего момента |
| f`irst (/узел_сети/ключ,сек<:сдвиг_времени>)` |
| Первое (самое старое) значение за указанный период вычисления. | См. общие параметры. | Поддерживаемые типы значений: `float, int, str, text, log`Пример:`=> first(/узел_сети/ключ,1h) `– извлечь самое старое значение за последний час вплоть до текущего момента |
| f`uzzytime (/узел_сети/ключ,сек)` |
| Проверка того, насколько время пассивного Агента отличается от времени Сервера/Прокси. | См. общие параметры. | Поддерживаемые типы значений: `float, int`Возвращает:1 – если разница между значением пассивного элемента данных (как штампа времени) и штампом времени Сервера/Прокси (временем получения значения) меньше или равна `сек `секунд0 – иначеОбычно используется с "`system.localtime"` для проверки, что локальное время синхронизировано с локальным временем Сервера. Следует обратить внимание, что "`system.localtime"` должно быть настроено как пассивная проверка.Также можно использовать с ключом `vfs.file.time[/путь/файл,modify] `для проверки, что файл не обновлялся длительное время.Пример:`=> fuzzytime(/узел_сети/ключ,60s)=0 `– обнаружение проблемы, если разница во времени превышает 60 секундЭту функцию не рекомендуется использовать в сложных триггерных выражениях (с участием нескольких элементов данных), поскольку это может привести к непредвиденным результатам (разница по времени будет считаться по наиболее свежей метрике), например, в таком: `fuzzytime(/узел_сети/system.localtime,60s)=0 or last(/узел_сети/trap)<>0` |
| l`ast (/узел_сети/ключ,<#число<:сдвиг_времени>>)` |
| Самое новое значение. | См. общие параметры.`#число `(опционально) – N-ое значение из самых новых | Поддерживаемые типы значений: `float, int, str, text, log`Следует обратить внимание, что `#число `(с решеткой, #N) здесь работает иначе, чем во многих других функциях.Например:`last() `всегда идентичен `last(#1)last(#3) `– третье из самых новых значение (не три последних значения)Подсистема не гарантирует точный порядок значений, если в истории существует более двух значений за одну секунду. |
| l`ogeventid (/узел_сети/ключ,<#число<:сдвиг_времени>>,<шаблон>)` |
| Проверка, соответствует ли указанному регулярному выражению идентификатор события последней записи из журнала. | См. общие параметры.`#число `(опционально) – N-ое из наиболее недавних значений`шаблон `(опционально) – регулярное выражение, описывающее нужный шаблон, в формате Perl Compatible Regular Expression (PCRE) (строковые аргументы должны быть заключены в двойные кавычки). | Поддерживаемые типы значений:` log`Возвращает:0 – нет соответствия1 – соответствует |
| l`ogseverity (/узел_сети/ключ,<#число<:сдвиг_времени>>)` |
| Важность события последней записи в журнале. | См. общие параметры.`#число `(опционально) – N-ое из наиболее недавних значений | Поддерживаемые типы значений: `log`Возвращает:0 – важность по умолчаниюN – важность (целое число, полезно для журналов событий Windows: 1 – Уведомление, 2– предупреждение,** **4 – Ошибка, 7 – Аудит отказов, 8 – Аудит успехов, 9 – Критическая ошибка, 10 – Детали).Подсистема берет важность журнала из поля `Информация журнала событий Windows.` |
| l`ogsource (/узел_сети/ключ,<#число<:сдвиг_времени>>,<шаблон>)` |
| Проверка, соответствует ли регулярному выражению источник последней записи в журнале. | См. общие параметры.`#число `(опционально) – N-ое из наиболее недавних значений`шаблон `(опционально) – регулярное выражение, описывающее нужный шаблон, в формате Perl Compatible Regular Expression (PCRE) (строковые аргументы должны быть заключены в двойные кавычки). | Поддерживаемые типы значений: `log`Возвращает:0 – нет соответствия1 – соответствуетОбычно используется для журналов событий Windows. Например, `logsource("VMware Server").` |
| m`onodec (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>,<режим>)` |
| Проверка наличия монотонного убывания значений. | См. общие параметры.`режим `(должен быть в двойных кавычках) – `weak `(каждое значение меньше или равно предыдущему; по умолчанию) или `strict `(каждое значение строго уменьшается) | Поддерживаемые типы значений`: int`Возвращает 1, если все элементы в течение указанного периода времени непрерывно уменьшаются, иначе – 0.Пример:`=> monodec(/Host1/system.swap.size[all,free],60s) + monodec(/Host2/system.swap.size[all,free],60s) + monodec(/Host3/system.swap.size[all,free],60s) `– посчитать, на каком количестве узлов сети было уменьшение свободного места в области подкачки |
| m`onoinc (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>,<режим>)` |
| Проверка наличия монотонного возрастания значений. | См. общие параметры.`режим `(должен быть в двойных кавычках) – `weak `(каждое значение больше или равно предыдущему; по умолчанию) или `strict `(каждое значение строго возрастает) | Поддерживаемые типы значений`: int`Возвращает 1, если все элементы в течение указанного периода времени непрерывно возрастают, иначе 0.Пример:`=> monoinc(/Host1/system.localtime,#3,"strict")=0 `– проверка того, постоянно ли увеличивается локальное время системы |
| n`odata (/узел_сети/ключ,сек,<режим>)` |
| Проверка отсутствия полученных данных. | См. общие параметры.`сек –` период должен быть не менее 30 секунд, так как процесс синхронизации истории (history syncer) вычисляет эту функцию раз в 30 секунд.`nodata(/узел_сети/ключ,0) `запрещено.`режим `– при значении `strict `(в двойных кавычках), эта функция будет нечувствительна к доступности Прокси (см. комментарии для более подробной информации). | Поддерживаются все типы значений.Возвращает:1 – если нет полученных данных за указанный период времени0 – иначеТриггеры "`nodata"`, контролируемые Прокси-серверами, по умолчанию чувствительны к доступности Прокси – если Прокси становится недоступным, триггеры "`nodata"` не будут срабатывать немедленно после восстановления соединения, а пропустят данные за задержанный период. Следует обратить внимание, что для пассивных Прокси подавление активируется если соединение восстанавливается более чем на 15 секунд, но не менее чем` 2 & ProxyUpdateFrequency `секунд позже. Для активных Прокси подавление активируется, если соединение восстанавливается более чем 15 секунд позже.Чтобы выключить чувствительность к доступности Прокси, использовать третий параметр, например: n`odata(/узел_сети/ключ,5m,"strict").`Следует обратить внимание, эта функция отобразит ошибку в случае, если за указанный в первом параметре период:- нет данных и Сервер был перезапущен- нет данных и было завершено обслуживание- нет данных и элемент данных был добавлен или заново активированОшибки отображаются в колонке `Инфо `в настройке триггеров.Эта функция может работать неправильно, если есть расхождения по времени между Сервером, Прокси и Агентом. См. также: требования по синхронизации времени. |
| p`ercentile (/узел_сети/ключ,(сек\|#число)<:сдвиг_времени>,процент)` |
| P-й процентиль периода, где P (процент) указывается третьим параметром. | См. общие параметры.`процент `– число с плавающей точкой от 0 до 100 (включительно), до 4 цифр после десятичной точки | Поддерживаемые типы значений: `float, int` |
| r`ate (/узел_сети/ключ,сек<:сдвиг_времени>)` |
| Усредненная за секунду скорость увеличения монотонно возрастающего счетчика в течение указанного периода времени. | См. общие параметры. | Поддерживаемые типы значений: `float, int`Функционально соответствует функции "`rate [en]"` из PromQL.Пример:`=> rate(/узел_сети/ключ,30s) – `если за 30 секунд значение монотонно возросло на 20, эта функция вернет 0.67. |

## Д.14.7 Рекомендуемые настройки UNIXODBC для MySQL

Функции динамики изменений, в отличие от функций истории, используют для вычислений данные динамики изменений.

Динамика изменений сохраняется в виде агрегированных за час значений. Функции динамики изменений используют эти усредненные за час значения, и, таким образом, полезны для долгосрочного анализа.

Результаты функций динамики изменений кэшируются, поэтому несколько вызовов той же функции с теми же параметрами извлекут информацию из базы данных только однократно. Кэш функций динамики изменений управляется параметром Сервера TrendFunctionCacheSize.

Триггеры, которые ссылаются только на функции динамики изменений, пересчитываются один раз за наименьший период времени в выражении. Например, такой триггер:

```bash Terminal
trendavg(/узел_сети/ключ,1d:now/d) > 1 or trendavg(/узел_сети/ключ2,1w:now/w) > 2
```

будет пересчитываться раз в сутки. Если триггер содержит как функции динамики изменений, так и функции истории (либо относящиеся к времени), то он пересчитывается в соответствии с обычными принципами.

Все перечисленные в таблице 97 функции поддерживаются в:

- выражениях триггера;
- вычисляемых элементах данных.

Некоторые общие замечания о параметрах функций:

- параметры функций разделяются запятыми;
- необязательные параметры функций (или части параметров) обозначаются угловыми скобками `"< >";`
- параметры, специфичные для функций, описываются с каждой функцией;
- параметры `/узел_сети/ключ и` `период_времени:сдвиг_времени `никогда не должны заключаться в кавычки.

Общие параметры:

- `/узел_сети/ключ `– обязательный первый параметр;
- `период_времени:сдвиг_времени `– второй параметр,
- где:
  - `период_времени `– период времени (минимум "1h"), определенный как <N><единица_времени> где `N `– количество единиц времени, `единица_времени `– h (час), d (сутки), w (неделя), M (месяц) или y (год);
  - `сдвиг_времени `– сдвиг периода времени (см. примеры функций).
    1. Функции динамики изменений

| Описание | Параметры, специфичные для функции | Комментарии |
| --- | --- | --- |
| b`aselinedev (/узел_сети/ключ,период_данных:сдвиг_времени,сезон_ед,сезон_кол-во)` |
| Возвращает количество стандартных отклонений (по алгоритму `stddevpop,` среднеквадратичное отклонение) между последним периодом данных и теми же периодами данных в предыдущие сезоны. | `период_данных `– период сбора данных в течение сезона, определенный как `<N><единица_времени>,` где`N `– количество единиц времени`единица_времени `– h (час), d (сутки), w (неделя), M (месяц) или y (год), должно быть меньше или равно сезону– смещение периода времени (см. примеры)`сезон_ед `– продолжительность одного сезона (h, d, w, M, y), не может быть меньше периода данных`сезон_кол-во `– количество оцениваемых сезонов | Примеры:`=> baselinedev(/узел_сети/ключ,1d:now/d,"M",6) `– расчет количества стандартных отклонений (генеральная совокупность) между предыдущими сутками и теми же сутками в предыдущие 6 месяцев. Если дата в предыдущем месяце не существует, будет использован последний день месяца (31 июля будет проанализировано в сравнении с 31 января, 28 февраля, ..., 30 июня).`=> baselinedev(/узел_сети/ключ,1h:now/h,"d",10) `– расчет количества стандартных отклонений (генеральная совокупность) между предыдущим часом и тем же часом на протяжении декады до вчерашнего дня. |
| b`aselinewma (/узел_сети/ключ,период_данных:Сдвиг_времени,сезон_ед,сезон_кол-во)` |
| Вычисляет базовый уровень путем усреднения данных за один и тот же интервал времени в течение нескольких равных периодов времени ("сезонов") с использованием алгоритма взвешенного скользящего среднего. | `период_данных `– период сбора данных в течение сезона, определенный как `<N><единица_времени>,` где`N `– количество единиц времени`единица_времени `– h (час), d (сутки), w (неделя), M (месяц) или y (год), должно быть меньше или равно сезону`Сдвиг_времени `– смещение периода времени, определяет конец интервала сбора данных в сезонах (см. примеры)`сезон_ед `– продолжительность одного сезона (h, d, w, M, y), не может быть меньше периода данных`сезон_кол-во `– количество оцениваемых сезонов | Примеры:`=> baselinewma(/узел_сети/ключ,1h:now/h,"d",3) –` расчет базового уровня за последний полный час в течение 3-дневного периода, который закончился вчера. Если "`now"` (сейчас) – это 13:30 понедельника, то будут проанализированы данные по часу 12:00-12:59 за пятницу, субботу и воскресенье.`=> baselinewma(/узел_сети/ключ,2h:now/h,"d",3) –` расчет базового уровня на основе последних двух часов в течение 3-дневного периода, который закончился вчера. Если "`now"` (сейчас) – это 13:30 понедельника, то будут проанализированы данные для интервала 11:00-12:59 за пятницу, субботу и воскресенье.`=> baselinewma(/узел_сети/ключ,1d:now/d,"M",4) –` расчет базового уровня на основе того же числа месяца, что и "вчера", за период 4 месяца, предшествующих предыдущему полному месяцу. Если нужной даты не существует, берется последний день месяца. Если сегодня 1 сентября, то будут проанализированы данные за 31 июля, 30 июня, 31 мая и 30 апреля. |
| t`rendavg (/узел_сети/ключ,период_времени:Сдвиг_времени)` |
| Среднее из значений динамики изменений за определенный период времени. | См. общие параметры. | Примеры:`=> trendavg(/узел_сети/ключ,1h:now/h) – `среднее за предыдущий час (например, 12:00-13:00)`=> trendavg(/узел_сети/ключ,1h:now/h-1h) – с`реднее за час два часа назад (11:00-12:00)`=> trendavg(/узел_сети/ключ,1h:now/h-2h) – с`реднее за час три часа назад (10:00-11:00)`=> trendavg(/узел_сети/ключ,1M:now/M-1y) – с`реднее за предыдущий месяц год назад |
| t`rendcount (/узел_сети/ключ,период_времени:Сдвиг_времени)` |
| Количество успешно извлеченных значений динамики изменений за определенный период времени. | См. общие параметры. | Примеры:`=> trendcount(/узел_сети/ключ,1h:now/h) – к`оличество за предыдущий час (например, 12:00-13:00)`=> trendcount(/узел_сети/ключ,1h:now/h-1h) – `количество за час два часа назад (11:00-12:00)`=> trendcount(/узел_сети/ключ,1h:now/h-2h) – `количество за час три часа назад (10:00-11:00)`=> trendcount(/узел_сети/ключ,1M:now/M-1y) – `количество за предыдущий месяц год назад |
| t`rendmax (/узел_сети/ключ,период_времени:Сдвиг_времени)` |
| Максимальное значение из динамики изменений за определенный период времени. | См. общие параметры. | Примеры:`=> trendmax(/узел_сети/ключ,1h:now/h) – м`аксимум за предыдущий час (например, 12:00-13:00)`=> trendmax(/узел_сети/ключ,1h:now/h) – trendmin(/узел_сети/ключ,1h:now/h) – `расчет разницы между максимальным и минимальным значениями (дельта тренда) за предыдущий час (12:00-13:00)`=> trendmax(/узел_сети/ключ,1h:now/h-1h) – м`аксимум за час два часа назад (11:00-12:00)`=> trendmax(/узел_сети/ключ,1h:now/h-2h) – м`аксимум за час три часа назад (10:00-11:00)`=> trendmax(/узел_сети/ключ,1M:now/M-1y) – `максимум за предыдущий месяц год назад |
| t`rendmin (/узел_сети/ключ,период_времени:Сдвиг_времени)` |
| Минимальное значение из динамики изменений за определенный период времени. | См. общие параметры. | Примеры:`=> trendmin(/узел_сети/ключ,1h:now/h) – м`инимум за предыдущий час (например, 12:00-13:00)`=> trendmin(/узел_сети/ключ,1h:now/h) – trendmin(/узел_сети/ключ,1h:now/h) – `расчет разницы между максимальным и минимальным значениями (дельта тренда) за предыдущий час (12:00-13:00)`=> trendmin(/узел_сети/ключ,1h:now/h-1h) – м`инимум за час два часа назад (11:00-12:00)`=> trendmin(/узел_сети/ключ,1h:now/h-2h) – м`инимум за час три часа назад (10:00-11:00)`=> trendmin(/узел_сети/ключ,1M:now/M-1y) – м`инимум за предыдущий месяц год назад |
| t`rendstl (/узел_сети/ключ,период_оценки:Сдвиг_времени,период_обнаружения,сезон,<отклонения>,<devalg>,<s_window>)` |
| Возвращает частоту аномалий за период обнаружения — десятичное значение от 0 до 1, которое определяется как `((количество аномальных значений)/(общее количество значений)).` | `период_оценки `– период времени, который необходимо разложить (минимум "1h"), определенный как `<N><единица_времени>,` где`N `– количество единиц времени`единица_времени `– h (час), d (сутки), w (неделя), M (месяц) или y (год).`Сдвиг_времени `– смещение периода времени (см. примеры)`период_обнаружения `– период времени до конца периода оценки, для которого вычисляются аномалии (минимум "1h", не может быть дольше периода оценки), определенный как `<N><единица_времени>,` где`N `– количество единиц времени`единица_времени `– h (час), d (сутки), w (неделя).`сезон `– самый короткий период времени, где ожидается повторяющийся шаблон ("сезон"), (минимум "2h", не может быть дольше периода оценки, количество записей в периоде оценки должно быть больше двукратной результирующей частоты (сезон/h)), определенной как `<N><единица_времени>,` где`N `– количество единиц времени`единица_времени `– h (час), d (сутки), w (неделя).`отклонения `– количество отклонений (вычисленных по алгоритму devalg), которые следует считать аномалией (может быть десятичным числом), (должно быть больше либо равно 1, по умолчанию: 3)`devalg `(должно быть в двойных кавычках) – алгоритм отклонений, может быть `stddevpop,` `stddevsamp `или `mad `(по умолчанию)`s_window `– протяженность (в лагах) окна LOESS для извлечения сезонов (по умолчанию: 10 * количество записей в периоде оценки + 1) | Примеры:`=> trendstl(/узел_сети/ключ,100h:now/h,10h,2h) – `анализировать последние 100 часов данных динамики изменений,найти частоту аномалий за последние 10 часов этого периода,ожидая, что будет периодичность 2 часа,значения компонентов остатка за период оценки рассматриваются как аномалии, если они достигают значения 3 отклонений по алгоритму MAD (среднее абсолютное отклонение) для этого компонента остатков`=> trendstl(/узел_сети/ключ,100h:now/h-10h,100h,2h,2.1,"mad") – `анализировать период 100 часов данных динамики изменений, до момента 10 часов назад,найти частоту аномалий за весь периодпри ожидании периодичности в 2 часа,значения компонентов остатка за период оценки рассматриваются как аномалии, если они достигают значения 2,1 отклонения по алгоритму MAD для этого компонента остатков`=> trendstl(/узел_сети/ключ,100d:now/d-1d,10d,1d,4,,10) – `анализировать период 100 дней данных динамики изменений до момента сутки назад, найти частоту аномалий за последние 10 дней этого периода,при ожидании, что периодичность составит 1 сутки, значения компонентов остатка за период оценки рассматриваются как аномалии, если они достигают значения 4 отклонений по алгоритму MAD для этого компонента остатков, переопределяя протяженность окна LOESS по умолчанию для извлечения сезонов "10 * количество записей в периоде оценки + 1" на протяженность 10 лагов`=> trendstl(/узел_сети/ключ,1M:now/M-1y,1d,2h,,"stddevsamp") – `анализировать предыдущий месяц год назад,найти частоту аномалий за последний день этого периода,при ожидаемой периодичности в 2 часа,значения компонентов остатка за период оценки рассматриваются как аномалии, если они достигают значения 3 отклонений по алгоритму sample standard deviation (среднеквадратическое отклонение по выборке) для этого компонента остатков |
| t`rendsum (/узел_сети/ключ,период_времени:Сдвиг_времени)` |
| Сумма значений динамики изменений за определенный период времени. | См. общие параметры. | Примеры:`=> trendsum(/узел_сети/ключ,1h:now/h) – `сумма за предыдущий час (например, 12:00-13:00)`=> trendsum(/узел_сети/ключ,1h:now/h-1h) – `сумма за час два часа назад (11:00-12:00)`=> trendsum(/узел_сети/ключ,1h:now/h-2h) – `сумма за час три часа назад (10:00-11:00)`=> trendsum(/узел_сети/ключ,1M:now/M-1`y) `– `сумма за предыдущий месяц год назад |

## Д.14.8 Рекомендуемые настройки UNIXODBC для PostgreSQL

Все перечисленные в таблице 98 функции поддерживаются в:

- выражениях триггера;
- вычисляемых элементах данных.

Математические функции поддерживаются с дробными и целочисленными типами значений, если не оговорено иначе.

Некоторые общие замечания о параметрах функций:

- параметры функций разделяются запятыми;
- в качестве параметров допустимы выражения;
- необязательные параметры функций (или части параметров) обозначаются угловыми скобками `"< >".`
1. Математические функции

| Описание | Параметры, специфичные для функции | Комментарии |
| --- | --- | --- |
| a`bs (значение)` |
| Абсолютное значение (по модулю) значения. | `значение – п`роверяемое значение | Поддерживаются типы значений: `float, int, str, text, log`Для строк возвращается:0 – значения равны1 – значения отличаютсяПример:`=> abs(last(/узел_сети/ключ))>10` |
| a`cos (значение)` |
| Арккосинус значения как угол, выраженный в радианах. | `значение – п`роверяемое значение | Значение должно быть в диапазоне от -1 до 1.Например, арккосинус значения "0.5" будет "2.0943951".Пример:`=> acos(last(/узел_сети/ключ))` |
| a`sin (значение)` |
| Арксинус значения как угол, выраженный в радианах. | `значение – п`роверяемое значение | Значение должно быть в диапазоне от -1 до 1.Например, арксинус значения "0.5" будет "-0.523598776".Пример:`=> asin(last(/узел_сети/ключ))` |
| atan (значение) |
| Арктангенс значения как угол, выраженный в радианах. | `значение – п`роверяемое значение | Например, арктангенс значения "1" будет "0.785398163".Пример:`=> atan(last(/узел_сети/ключ))` |
| a`tan2 (значение,абсцисса)` |
| Арктангенс указанных координат ординаты (значение) и абсцисса как угол, выраженный в радианах. | `значение – п`роверяемое значение`абсцисса `– значение абсциссы | Например, арктангенс координат ордината и абсцисса "1" будет "2.21429744".Пример:`=> atan2(last(/узел_сети/ключ),2)` |
| a`vg (<значение1>,<значение2>,...)` |
| Среднее значение перечисленных элементов данных. | `значениеX `– значение, возвращаемое одной из функций истории | Пример:`=> avg(avg(/узел_сети/ключ),avg(/узел_сети2/ключ2))` |
| c`brt (значение)` |
| Кубический корень из значения. | `значение – п`роверяемое значение | Например, кубический корень из "64" будет "4", а из "63" будет "3.97905721".Пример:`=> cbrt(last(/узел_сети/ключ))` |
| c`eil (значение)` |
| Округлить значение вверх до ближайшего целого. | `значение – п`роверяемое значение | Например, "2.4" будет округлено до "3".Пример:`=> ceil(last(/узел_сети/ключ))` |
| c`os (значение)` |
| Косинус значения, где значение воспринимается как угол, выраженный в радианах. | `значение – п`роверяемое значение | Например, косинус значения "1" будет "0.54030230586".Пример:`=> cos(last(/узел_сети/ключ))` |
| c`osh (значение)` |
| Гиперболический косинус значения. | `значение – п`роверяемое значение | Например, гиперболический косинус значения "1" будет "1.54308063482".Возвращает значение в виде действительного числа, а не в научном представлении.Пример:`=> cosh(last(/узел_сети/ключ))` |
| c`ot (значение)` |
| Котангенс значения, где значение воспринимается как угол, выраженный в радианах. | `значение – п`роверяемое значение | Например, котангенс значения "1" будет "0.54030230586".Пример:`=> cot(last(/узел_сети/ключ))` |
| d`egrees (значение)` |
| Конвертация значения из радиан в градусы. | `значение – п`роверяемое значение | Например, значение "1", сконвертированное в градусы, будет "57.2957795".Пример:=> degrees(last(/узел_сети/ключ)) |
| e |
| Число Эйлера (2.718281828459045). | Пример:`=> e()` |
| e`xp (значение)` |
| Число Эйлера (e) в степени значения. | `значение – п`роверяемое значение | Например, число Эйлера, возведенное в степень "2", будет "7.38905609893065".Пример:`=> exp(last(/узел_сети/ключ))` |
| e`xpm1 (значение)` |
| Число Эйлера (e) в степени значения, минус один. | `значение – п`роверяемое значение | Например, число Эйлера, возведенное в степень "2", после вычитания единицы будет "6.38905609893065".Пример:`=> expm1(last(/узел_сети/ключ))` |
| f`loor (значение)` |
| Округление вниз до ближайшего целого. | `значение – п`роверяемое значение | Например, "2.6" будет округлено вниз до "2".Пример:`=> floor(last(/узел_сети/ключ))` |
| l`og (значение)` |
| Натуральный логарифм. | `значение – п`роверяемое значение | Например, натуральный логарифм значения "2" будет "0.69314718055994529".Пример:`=> log(last(/узел_сети/ключ))` |
| l`og10 (значение)` |
| Десятичный логарифм. | `значение – п`роверяемое значение | Например, десятичный логарифм значения "5" будет равен "0.69897000433".Пример:`=> log10(last(/узел_сети/ключ))` |
| m`ax (<значение1>,<значение2>,...)` |
| Наибольшее из значений, на которые ссылаются перечисленные элементы данных. | `значениеX `– значение, возвращаемое одной из функций истории | Пример:`=> max(avg(/узел_сети/ключ),avg(//узел_сети2/ключ2))` |
| m`in (<значение1>,<значение2>,...)` |
| Наименьшее из значений, на которые ссылаются перечисленные элементы данных. | `значениеX –` значение, возвращаемое одной из функций истории | Пример:`=> min(avg(/узел_сети/ключ),avg(/узел_сети2/ключ2))` |
| m`od (значение,делитель)` |
| Остаток от деления. | `значение – п`роверяемое значение`делитель –` знаменатель деления | Например, остаток от деления значения "5" с делителем "2" будет "1".Пример:`=> mod(last(/узел_сети/ключ),2)` |
| p`i` |
| Константа пи (3.14159265358979). | Пример:`=> pi()` |
| p`ower (значение,степень)` |
| Возведение в степень. | `значение – п`роверяемое значение`степень `– используемый показатель степени | Например, третья степень значения "2" будет "8".Пример:`=> power(last(/узел_сети/ключ),3)` |
| r`adians (значение)` |
| Конвертация значения из градусов в радианы. | `значение – п`роверяемое значение | Например, значение "1", сконвертированное в радианы, будет "0.0174532925".Пример:`=> radians(last(/узел_сети/ключ))` |
| r`and` |
| Вернуть случайное целое число. |  | Псевдослучайное число, сгенерированное с использованием времени в качестве `seed `(достаточно для математических целей, но не для криптографии).Пример:`=> rand()` |
| r`ound (значение,дес_знаков)` |
| Округлить значение до десятичных знаков. | `значение – п`роверяемое значение`дес_знаков `– количество десятичных знаков для округления (0 также допустим) | Например, значение "2.5482", округленное до 2 десятичных знаков, будет "2.55".Пример:`=> round(last(/узел_сети/ключ),2)` |
| s`ignum (значение)` |
| Возвращает "-1" для отрицательного значения, "0" для нуля, "1" для положительного значения. | `значение – п`роверяемое значение | Пример:`=> signum(last(/узел_сети/ключ))` |
| s`in (значение)` |
| Синус значения, воспринимаемого как угол, выраженный в радианах. | `значение – п`роверяемое значение | Например, синус значения "1" будет "0.8414709848".Пример:`=> sin(last(/узел_сети/ключ))` |
| s`inh (значение)` |
| Гиперболический синус значения. | `значение – п`роверяемое значение | Например, гиперболический синус значения "1" будет "1.17520119364".Пример:`=> sinh(last(/узел_сети/ключ))` |
| s`qrt (значение)` |
| Квадратный корень значения. | `значение – п`роверяемое значение | Эта функция выдаст ошибку для отрицательного значения.Например, квадратный корень из значения "3.5" будет "1.87082869339".Пример:`=> sqrt(last(/узел_сети/ключ))` |
| s`um (<значение1>,<значение2>,...)` |
| Сумма значений, на которые ссылаются перечисленные элементы данных. | `значениеX –` значение, возвращаемое одной из функций истории | Пример:`=> sum(avg(/узел_сети/ключ),avg(/узел_сети2/ключ2))` |
| t`an (значение)` |
| Тангенс значения. | `значение – п`роверяемое значение | Например, тангенс значения "1" будет "1.55740772465".Пример:`=> tan(last(/узел_сети/ключ))` |
| t`runcate (значение,дес_знаков)` |
| Усечение значения до указанного числа десятичных знаков. | `значение – п`роверяемое значение`дес_знаков `– количество десятичных знаков, оставляемых после усечения (0 также допустим) | Пример:`=> truncate(last(/узел_сети/ключ),2)` |

## Д.14.9 Рекомендуемые настройки UNIXODBC для MSSQL

Все перечисленные в таблице 99 функции поддерживаются в:

- триггерных выражениях;
- вычисляемых элементах данных.

Некоторые общие замечания о параметрах функций:

- параметры функций разделяются запятыми;
- выражения принимаются в качестве параметров.
1. Операторные функции

| Описание | Параметры, специфичные для функции | Комментарии |
| --- | --- | --- |
| b`etween (значение,мин,макс)` |
| Проверка того, попадает ли значение в заданный диапазон. | `значение `– проверяемое значение`мин `– минимальное значение`макс `– максимальное значение | Поддерживаемые типы значений`: integer, floatВ`озвращает:1 – в диапазоне0 – иначеПример:`=> between(last(/узел_сети/ключ),1,10)=1 –` триггер сработает, если значение в пределах от 1 до 10. |
| i`n (значение,значение1,значение2,...значениеN)` |
| Проверка того, что значение равно хотя бы какому-нибудь из перечисленных значений. | `значение `– проверяемое значение`значение1,значение2,...значениеN `– перечисленные значения (строковые значения должны быть в двойных кавычках) | Поддерживаемые типы значений: `всеВ`озвращает:1 – если равно0 – иначеЗначение сравнивается с перечисленными значениями как число, если все эти значения могут быть преобразованы в число; иначе сравнивается как строка.Пример:`=> in(last(/узел_сети/ключ),5,10)=1 `– триггер сработает, если последнее значение равно либо 5, либо 10`=> in("text", last(/узел_сети/ключ),last(/узел_сети/ключ,#2))=1 `– триггер сработает, если любое из двух последних значений равно "`text"`. |

# Д.15 Зависимые элементы данных

Все перечисленные в таблице 100 функции поддерживаются в:

- выражениях триггера;
- вычисляемых элементах данных.

Некоторые общие замечания о параметрах функций:

- параметры функций разделяются запятыми;
- необязательные параметры функций (или части параметров) обозначаются угловыми скобками `"< >";`
- параметры, специфичные для функций, описываются с каждой функцией;
- параметры `/узел_сети/ключ и` `(сек|#число)<:Сдвиг_времени> н`икогда не должны заключаться в кавычки.

Общие параметры:

- `/узел_сети/ключ `– обязательный первый параметр для функций, ссылающихся на историю элемента данных узла сети
- `(сек|#число)<:Сдвиг_времени> `– второй параметр для функций, ссылающихся на историю элемента данных узла сети,
- где:
  - `сек `– максимальный период вычисления в секундах (могут использоваться суффиксы времени), либо;
  - `#число `– максимальная область вычисления среди последних собранных значений (если начинается со знака решетки);
  - `Сдвиг_времени `(опционально) – сдвиг точки вычислений по времени назад в прошлое.
    1. Функции прогнозирования

| Описание | Параметры, специфичные для функции | Комментарии |
| --- | --- | --- |
| f`orecast (/узел_сети/ключ,(сек\|#число)<:Сдвиг_времени>,время,<аппроксимация>,<режим>)` |
| Будущее значение, наибольшее, наименьшее, дельта или среднее элемента данных. | См. общие параметры.`время `– горизонт предсказания в секундах (могут использоваться суффиксы времени); поддерживаются отрицательные значения`аппроксимация `(опционально; должна быть в двойных кавычках) – функция, используемая для аппроксимации данных историиПоддерживаются `аппроксимации:linear `– линейная функция`polynomialN `– полиномиальная степени N (1 <= N <= 6)`exponential `– экспоненциальная функция`logarithmic `– логарифмическая функция`power `– степенная функцияСледует обратить внимание, что:по умолчанию – `linear,` а `polynomial1 `эквивалентно `linearрежим `(опционально; должен быть в двойных кавычках) – требуемый выводПоддерживаются `режимы:value `– значение (по умолчанию)`max `– максимум`min `– минимум`delta `– `max-minavg `– среднееСледует обратить внимание, что:`value `оценивает значение элемента данных на момент `текущий_момент `+ `времяmax,` `min,` `delta `и `avg `исследуют оценку значения элемента данных в интервале между `текущий_момент `и `текущий_момент `+ `время` | Поддерживаются типы значений:` float, intЕ`сли возвращаемое значение больше, чем 1.7976931348623157E+308, или меньше, чем -1.7976931348623157E+308, то возвращаемое значение усекается до 1.7976931348623157E+308 или -1.7976931348623157E+308 соответственно.Переходит в неподдерживаемое состояние только при некорректном использовании в выражении (ошибочный тип элемента данных, недопустимые параметры), иначе при ошибках возвращает -1.Примеры:`=> forecast(/узел_сети/ключ,#10,1h) – `предсказать значение элемента данных через час, основываясь на последних 10 значениях`=> forecast(/узел_сети/ключ,1h,30m) – `предсказать значение элемента данных через 30 минут на основании данных последнего часа`=> forecast(/узел_сети/ключ,1h:now-1d,12h) – `предсказать значение элемента данных через 12 часов на основании одного часа сутки назад`=> forecast(/узел_сети/ключ,1h,10m,"exponential") – `предсказать значение элемента данных через 10 минут, основываясь на данных последнего часа и экспоненциальной функции`=> forecast(/узел_сети/ключ,1h,2h,"polynomial3","max") – `предсказать максимальное значение, которое элемент данных может достичь через следующие два часа на основании данных последнего часа и кубическом (третьей степени) многочлене`=> forecast(/узел_сети/ключ,#2,-20m) – `ожидаемое значение элемента данных 20 минут назад на основании последних двух значений (это может оказаться более точным, чем использование `last(),` особенно если элемент данных обновляется редко – скажем, раз в час) |
| t`imeleft (/узел_сети/ключ,(сек\|#число)<:Сдвиг_времени>,порог,<аппроксимация>)` |
| Время в секундах, которое требуется для достижения элементом данных указанного порогового значения. | См. общие параметры.`порог `– достигаемое значение (могут использоваться суффиксы единиц измерения)`аппроксимация `(опционально; должна быть в двойных кавычках) – см. `forecast()` | Поддерживаются типы значений: `float, int`Если возвращаемое значение больше, чем 1.7976931348623157E+308, то возвращаемое значение усекается до 1.7976931348623157E+308.Возвращает 1.7976931348623157E+308, если пороговое значение недостижимо.Переходит в неподдерживаемое состояние только при некорректном использовании в выражении (ошибочный тип элемента данных, недопустимые параметры), иначе при ошибках возвращает -1.Примеры:`=> timeleft(/узел_сети/ключ,#10,0) – `время до тех пор, пока значение элемента данных не достигнет нуля, на основании последних 10 значений`=> timeleft(/узел_сети/ключ,1h,100) – `время до тех пор, пока значение элемента данных не достигнет 100, на основании данных последнего часа`=> timeleft(/узел_сети/ключ,1h:now-1d,100) – `время до тех пор, пока значение элемента данных не достигнет 100, на основании данных одного часа сутки назад`=> timeleft(/узел_сети/ключ,1h,200,"polynomial2") – `время до тех пор, пока значение элемента данных не достигнет 200, на основании данных последнего часа и предположении, что элемент данных ведет себя как квадратный (второй степени) двучлен |

# Д.16 HTTP-Агент

Все перечисленные в таблице 101 функции поддерживаются в:

- триггерных выражениях;
- вычисляемых элементах данных.

Некоторые общие замечания о параметрах функций:

- параметры функций разделяются запятыми;
- выражения принимаются в качестве параметров;
- строковые параметры должны заключаться в двойные кавычки; иначе они могут быть интерпретированы неверно;
- необязательные параметры функций (или части параметров) обозначаются угловыми скобками "`< >"`.
1. Строковые функции

| Описание | Параметры, специфичные для функции | Комментарии |
| --- | --- | --- |
| a`scii (значение)` |
| Код ASCII самого левого символа значения. | `значение – п`роверяемое значение | Поддерживаемые типы значений: `string, text, logН`апример, значение "Abc" вернет "65" (код ASCII для буквы "A").Пример:`=> ascii(last(/узел_сети/ключ))` |
| b`itlength (значение)` |
| Длина значения в битах. | `значение – п`роверяемое значение | Поддерживаемые типы значений: `string, text, log, integerП`ример:`=> bitlength(last(/узел_сети/ключ))` |
| B`ytelength (значение)` |
| Длина значения в байтах. | `значение – п`роверяемое значение | Поддерживаемые типы значений: `string, text, log, integerП`ример:`=> Bytelength(last(/узел_сети/ключ))` |
| c`har (значение)` |
| Вернуть символ, интерпретируя значение как код ASCII. | `значение – п`роверяемое значение | Поддерживаемые типы значений`: integer`Значение должно быть в диапазоне 0-255. Например, значение "65" (интерпретируемое как код ASCII) вернет "A".Пример:`=> char(last(/узел_сети/ключ))` |
| c`oncat (<значение1>,<значение2>,...)` |
| Строка, получаемая в результате конкатенации упоминаемых значений элементов данных либо констант. | `значение – з`начение, возвращаемое одной из функций истории, либо константа (`string, integer или float number)` | Поддерживаемые типы значений: `string, text, log, float, integerН`апример, значение вроде "Zab", объединенное с "bix" (строки-константы), вернет `zabbix.`Должно содержать минимум два параметра.Пример:`=> concat(last(/узел_сети/ключ),"bix")=> concat("1 min: ",last(/узел_сети/system.cpu.load[all,avg1]),", 15 min: ",last(/узел_сети/system.cpu.load[all,avg15]))` |
| i`nsert (значение,старт,длина,замена)` |
| Вставить указанные символы или пробелы в символьную строку, начиная с указанной позиции в строке. | `значение – п`роверяемое значение`старт `– начальная позиция`длина `– заменяемых позиций`замена `– подставляемая строка | Поддерживаемые типы значений: `string, text, log`Например, значение вроде "`Rosssa"` будет заменено на "`Rosa"`, если "sss" (начиная с позиции 3, заменяемых позиций 3) заменяется строкой "s".Пример:`=> insert(last(/узел_сети/ключ),3,2,"b")` |
| l`eft (значение,кол-во)` |
| Самые левые символы значения. | `значение – п`роверяемое значение`кол-во `– количество возвращаемых символов | Поддерживаемые типы значений: `string, text, log`Например, можно вернуть "`Zab"` из `zabbix,` указывая для возврата 3 крайних слева символа.Пример:`=> left(last(/узел_сети/ключ),3) `– возвращает три самых левых символаСм. также `right().` |
| l`ength (значение)` |
| Длина значения в символах. | `значение – п`роверяемое значение | Поддерживаемые типы значений:` string, text, log`Пример:`=> length(last(/узел_сети/ключ)) –` длина последнего значения`=> length(last(/узел_сети/ключ,#3)) `– длина третьего из последних значения`=> length(last(/узел_сети/ключ,#1:now-1d)) `– длина самого свежего сутки назад значения |
| ltrim (значение,<символы>) |
| Удалить указанные символы с начала строки. | `значение – п`роверяемое значение`символы `– (опционально) указать удаляемые символы.По умолчанию удаляются пробелы (если не указано опциональных символов). | Поддерживаемые типы значений: `string,` `text, log`Пример:`=> ltrim(last(/узел_сети/ключ)) `– удалить пробелы с начала строки`=> ltrim(last(/узел_сети/ключ),"Z") `– удалить любые символы "Z" с начала строки`=> ltrim(last(/узел_сети/ключ)," Z") `– удалить пробелы и символы "Z" с начала строкиСм. также: `rtrim(), trim()` |
| m`id (значение,старт,длина)` |
| Вернуть подстроку из N символов, начиная с символьной позиции, указанной параметром "`старт"`. | `значение – п`роверяемое значение`старт –` начальная позиция подстроки`длина `– количество позиций подстроки, которые нужно вернуть | Поддерживаемые типы значений: `string, text, log`Например, можно вернуть подстроку "abbi" из значения `zabbix,` если указать начальную позицию 2, а длину 4).Пример:`=> mid(last(/узел_сети/ключ),2,4)="abbi"` |
| r`epeat (значение,кол-во)` |
| Повторить строку. | `значение – п`роверяемое значениекол-во – количество повторений | Поддерживаемые типы значений: `string, text, log`Пример:`=> repeat(last(/узел_сети/ключ),2) `– повторить значение дважды |
| r`eplace (значение,образец,замена)` |
| Найти в значении образец и заменить его заменой. Все вхождения образца будут заменены. | `значение – п`роверяемое значение`образец –` искомый образец`замена `– строка, которой заменяется образец | Поддерживаемые типы значений: `string, text, log`Пример:`=> replace(last(/узел_сети/ключ),"ibb","abb") –` заменить все "ibb" на "abb" |
| r`ight (значение,кол-во)` |
| Самые правые символы значения. | `значение – п`роверяемое значение`кол-во `– количество возвращаемых символов | Поддерживаемые типы значений: `string, text, log`Например, можно вернуть "bix" из `zabbix,` если указать возвращать 3 символа справа.Пример:`=> right(last(/узел_сети/ключ),3) –` вернуть три символа справаСм. также `left().` |
| r`trim (значение,<символы>)` |
| Удалить указанные символы с конца строки. | `значение – п`роверяемое значение`символы `– (опционально) указать удаляемые символы.По умолчанию удаляются пробелы (если не указано опциональных символов). | Поддерживаемые типы значений: `string, text, logП`ример:`=> rtrim(last(/узел_сети/ключ)) `– удалить пробелы с конца строки`=> rtrim(last(/узел_сети/ключ),"x") `– удалить любые символы "x" с конца строки`=> rtrim(last(/узел_сети/ключ),"x ") `– удалить любые символы "x" или пробелы с конца строкиСм. также: `ltrim(), trim()` |
| t`rim (значение,<символы>)` |
| Удалить указанные символы с начала и конца строки. | `значение – п`роверяемое значение`символы `– (опционально) указать удаляемые символы.По умолчанию удаляются пробелы (если не указано опциональных символов). | Поддерживаемые типы значений: `string, text, log`Пример:`=> trim(last(/узел_сети/ключ)) `– удалить пробелы с начала и конца строки`=> trim(last(/узел_сети/ключ),"_") `– удалить "_" с начала и конца строкиСм. также: `ltrim(), rtrim()` |

Приложение И. Макросы

# Д.17 Проверки Prometheus

Таблица 102 содержит полный список макросов, поддерживаемых в Подсистеме по умолчанию.

Чтобы увидеть все макросы, поддерживаемые в каком-либо месте (например, в "URL карт сети"), можно вставить название места в поле поиска внизу окна браузера (доступное по нажатию CTRL+F) и искать следующее совпадение.

1. Поддерживаемые макросы

| Макрос | Поддерживается в | Описание |
| --- | --- | --- |
| {`ACTION.ID}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события обнаружения→ Оповещения и команды на события авторегистрации→ Внутренние оповещения | Числовой идентификатор сработавшего действия. |
| {`ACTION.NAME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события обнаружения→ Оповещения и команды на события авторегистрации→ Внутренние оповещения | Имя сработавшего действия. |
| {`ALERT.MESSAGE}` | `→` Параметры скриптов оповещений | Значение "`Сообщения по умолчанию"` из настройки действия. |
| {`ALERT.SENDTO}` | `→` Параметры скриптов оповещений | Значение "`Отправлять на" и`з настройки методов оповещений пользователя. |
| {`ALERT.SUBJECT}` | `→` Параметры скриптов оповещений | Значение "`Темы по умолчанию"` из настройки д`ей`ствия. |
| {`DATE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события обнаружения→ Оповещения и команды на события авторегистрации→ Внутренние оповещения→ Скрипты действий вручную над событиями | Текущая дата в формате `гггг.мм.дд.` |
| {`DISCOVERY.DEVICE.IPADDRESS}` | `→` Оповещения и команды на события обнаружения | IP-адрес обнаруженного устройства.Доступно всегда, вне зависимости от того добавлен узел сети или нет. |
| {`DISCOVERY.DEVICE.DNS}` | `→` Оповещения и команды на события обнаружения | DNS-имя обнаруженного устройства.Доступно всегда, вне зависимости от того добавлен узел сети или нет. |
| {`DISCOVERY.DEVICE.STATUS}` | `→` Оповещения и команды на события обнаружения | Состояние обнаруженного устройства: может быть либо `Доступен (UP),` либо `Недоступен (DOWN).` |
| {`DISCOVERY.DEVICE.UPTIME}` | `→` Оповещения и команды на события обнаружения | Время с момента последнего изменения состояния обнаружения конкретного устройства, с точностью до секунды.Например: 1h 29m 01s.Для устройств с состоянием `Недоступен,` значением будет период недоступности. |
| {`DISCOVERY.RULE.NAME}` | `→` Оповещения и команды на события обнаружения | Имя правила обнаружения, обнаружившего наличие или отсутствие устройства или сервиса. |
| {`DISCOVERY.SERVICE.NAME}` | `→` Оповещения и команды на события обнаружения | Имя обнаруженного сервиса.Например: HTTP. |
| {`DISCOVERY.SERVICE.PORT}` | `→` Оповещения и команды на события обнаружения | Порт обнаруженного сервиса.Например: 80. |
| {`DISCOVERY.SERVICE.STATUS}` | `→` Оповещения и команды на события обнаружения | Состояние обнаруженного сервиса: может быть либо `Доступен (UP),` либо `Недоступен (DOWN).` |
| {`DISCOVERY.SERVICE.UPTIME}` | `→` Оповещения и команды на события обнаружения | Время с момента последнего изменения состояния обнаружения конкретного сервиса, с точностью до секунды.Например: 1h 29m 01s.Для сервисов с состоянием `Недоступен,` значением будет период недоступности. |
| {`ESC.HISTORY}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Внутренние оповещения | История эскалаций. Журнал ранее отправленных сообщений.Показывает ранее отправленные оповещения, на каком шаге эскалаций они были отправлены и их состояние (отправлено, в процессе или ошибочно). |
| {`EVENT.ACK.STATUS}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Скрипты действий вручную над событиями | Состояние подтверждения события `(Yes/No).` |
| {`EVENT.AGE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Оповещения и команды на события обнаружения→ Оповещения и команды на события авторегистрации→ Внутренние оповещения→ Скрипты действий вручную над событиями | Возраст события, вызвавшего действие, с точностью до секунды.Полезно в эскалированных сообщениях. |
| {`EVENT.DATE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Оповещения и команды на события обнаружения→ Оповещения и команды на события авторегистрации→ Внутренние оповещения→ Скрипты действий вручную над событиями | Дата события, вызвавшего действие. |
| {`EVENT.DURATION}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Внутренние оповещения→ Скрипты действий вручную над событиями | Продолжительность события (разница по времени между событиями проблемы и восстановления), с точностью до секунды.Полезно в сообщениях о восстановлении проблем. |
| {`EVENT.ID}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Оповещения и команды на события обнаружения→ Оповещения и команды на события авторегистрации→ Внутренние оповещения→ Триггерные URL→ Скрипты действий вручную над событиями | Числовой идентификатор события, вызвавшего действие. |
| {`EVENT.NAME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Внутренние оповещения→ Скрипты действий вручную над событиями | Имя события проблемы, вызвавшего действие. |
| {`EVENT.NSEVERITY}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Скрипты действий вручную над событиями | Числовое значение важности события. Возможные значения: 0 – Не классифицировано, 1 – Информационный, 2 – Предупреждение, 3 – Средний, 4 – Высокий, 5 – Чрезвычайный. |
| {`EVENT.OBJECT}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Оповещения и команды на события обнаружения→ Оповещения и команды на события авторегистрации→ Внутренние оповещения→ Скрипты действий вручную над событиями | Числовое значение объекта события. Возможные значения: 0 – Триггер, 1 – Обнаруженный узел сети, 2 – Обнаруженный сервис, 3 – Авторегистрация, 4 – Элемент данных, 5 – Правило низкоуровневого обнаружения. |
| {`EVENT.OPDATA}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Скрипты действий вручную над событиями | Оперативные данные нижележащего триггера проблемы. |
| {`EVENT.RECOVERY.DATE}` | `→` Оповещения и команды на события восстановления проблем→ Оповещения и команды на обновление проблем (если восстановление произошло)→ Оповещения и команды на события восстановления услуг→ Скрипты действий вручную над событиями (если восстановление произошло) | Дата события восстановления. |
| {`EVENT.RECOVERY.ID}` | `→` Оповещения и команды на события восстановления проблем→ Оповещения и команды на обновление проблем (если восстановление произошло)→ Оповещения и команды на события восстановления услуг→ Скрипты действий вручную над событиями (если восстановление произошло) | Числовой идентификатор события восстановления. |
| {`EVENT.RECOVERY.NAME}` | `→` Оповещения и команды на события восстановления проблем→ Оповещения и команды на обновление проблем (если восстановление произошло)→ Оповещения и команды на события восстановления услуг→ Скрипты действий вручную над событиями (если восстановление произошло) | Имя события восстановления. |
| {`EVENT.RECOVERY.STATUS}` | `→` Оповещения и команды на события восстановления проблем→ Оповещения и команды на обновление проблем (если восстановление произошло)→ Оповещения и команды на события восстановления услуг→ Скрипты действий вручную над событиями (если восстановление произошло) | Словесное значение события восстановления. |
| {`EVENT.RECOVERY.TAGS}` | `→` Оповещения и команды на события восстановления проблем→ Оповещения и команды на обновление проблем (если восстановление произошло)→ Оповещения и команды на события восстановления услуг→ Скрипты действий вручную над событиями (если восстановление произошло) | Список тегов события восстановления (через запятую). Раскрывается в пустую строку, если теги отсутствуют. |
| {`EVENT.RECOVERY.TAGSJSON}` | `→` Оповещения и команды на события восстановления проблем→ Оповещения и команды на обновление проблем (если восстановление произошло)→ Оповещения и команды на события восстановления услуг→ Скрипты действий вручную над событиями (если восстановление произошло) | Массив JSON, содержащий объекты тегов события восстановления. Раскрывается в пустой массив, если теги отсутствуют. |
| {`EVENT.RECOVERY.TIME}` | `→` Оповещения и команды на события восстановления проблем→ Оповещения и команды на обновление проблем (если восстановление произошло)→ Оповещения и команды на события восстановления услуг→ Скрипты действий вручную над событиями (если восстановление произошло) | Время события восстановления. |
| {`EVENT.RECOVERY.VALUE}` | `→` Оповещения и команды на события восстановления проблем→ Оповещения и команды на обновление проблем (если восстановление произошло)→ Оповещения и команды на события восстановления услуг→ Скрипты действий вручную над событиями (если восстановление произошло) | Числовое значение события восстановления. |
| {`EVENT.SEVERITY}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Скрипты действий вручную над событиями | Название важности события. |
| {`EVENT.SOURCE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Оповещения и команды на события обнаружения→ Оповещения и команды на события авторегистрации→ Внутренние оповещения→ Скрипты действий вручную над событиями | Числовое значение источника события. Возможные значения: 0 – Триггер, 1 – Обнаружение, 2 – Авторегистрация, 3 – Внутреннее событие, 4 – Услуга. |
| {`EVENT.STATUS}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Внутренние оповещения→ Скрипты действий вручную над событиями | Словесное значение события, вызвавшего действие. |
| {`EVENT.TAGS}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Скрипты действий вручную над событиями | Список тегов события (через запятую). Раскрывается в пустую строку, если теги отсутствуют. |
| {`EVENT.TAGSJSON}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Скрипты действий вручную над событиями | Массив JSON, содержащий объекты тегов события). Раскрывается в пустой массив, если теги отсутствуют. |
| {`EVENT.TAGS.<имя_тега>}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Оповещения вебхуков типа URL и имен URL→ Скрипты действий вручную над событиями | Значение тега события, относящееся к данному имени тега.Имя тега, содержащее не алфавитно-цифровые символы (в том числе неанглийские многобайтовые символы UTF) должно заключаться в кавычки. Кавычки и обратные слеши внутри заключенного в кавычки имени тега должны экранироваться обратным слешем. |
| {`EVENT.TIME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Оповещения и команды на события обнаружения→ Оповещения и команды на события авторегистрации→ Внутренние оповещения→ Скрипты действий вручную над событиями | Время события, вызвавшего действие. |
| {`EVENT.UPDATE.ACTION}` | `→` Оповещения и команды на обновление проблем | Удобочитаемое имя действия (действий), выполняемых при обновлении проблемы. Раскрывается в следующие значения: acknowledged (подтверждено), commented (прокомментировано), changed severity from (original severity) to (updated severity) (важность изменена с (оригинальная важность) на (обновленная важность)) и closed (закрыто) (в зависимости от того, сколько действий выполняется за одно обновление). |
| {`EVENT.UPDATE.DATE}` | `→` Оповещения и команды на обновление проблем→ Оповещения и команды на обновление услуг | Дата события обновления (подтверждение и т.п.). |
| {`EVENT.UPDATE.HISTORY}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Скрипты действий вручную над событиями | Журнал обновлений проблемы (подтверждения и т.п.). |
| {`EVENT.UPDATE.MESSAGE}` | `→` Оповещения и команды на обновление проблем | Сообщение обновления проблемы. |
| {`EVENT.UPDATE.NSEVERITY}` | `→` Оповещения и команды на обновление услуг | Числовое значение новой важности события, заданное во время операции обновления проблемы. |
| {`EVENT.UPDATE.SEVERITY}` | `→` Оповещения и команды на обновление услуг | Название новой важности события, заданное во время операции обновления проблемы. |
| {`EVENT.UPDATE.STATUS}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Скрипты действий вручную над событиями | Числовое значение статуса обновления проблемы. Возможные значения: 0 – Вебхук был вызван из-за события проблемы/восстановления, 1 – Операция обновления. |
| {`EVENT.UPDATE.TIME}` | `→` Оповещения и команды на обновление проблем→ Оповещения и команды на обновление услуг | Время события обновления (подтверждения и т.п.). |
| {`EVENT.VALUE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события восстановления услуг→ Внутренние оповещения→ Скрипты действий вручную над событиями | Числовое значение события, вызвавшего действие (1 для проблемы, 0 для восстановления). |
| {`FUNCTION.VALUE<1-9>}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Скрипты действий вручную над событиями→ Имена событий | Результаты N-ой функции, относящейся к элементам данных, в триггерном выражении на момент события.Учитываются только функции с `/узел_сети/ключ `в качестве первого параметра. См. нумерованные макросы. |
| {`FUNCTION.RECOVERY.VALUE<1-9>}` | `→` Оповещения и команды на события восстановления проблем→ Оповещения и команды на обновление проблем→ Скрипты действий вручную над событиями | Результаты N-ой функции, относящейся к элементам данных, в выражении восстановления на момент события.Учитываются только функции с `/узел_сети/ключ `в качестве первого параметра. См. нумерованные макросы. |
| {`HOST.CONN}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Подписи к элементам карты, имена и значения URL на картах сети→ Параметры ключа элемента данных1→ IP/DNS интерфейса узла сети→ Поле "Разрешенные хосты" элементов данных "траппер"→ Дополнительные параметры мониторов баз данных→ Скрипты SSH и Telnet→ Поле JMX endpoint элементов данных→ Веб-мониторинг4→ Регулярное выражение фильтра правила низкоуровневого обнаружения→ Поле URL виджета панели "динамический URL"→ Триггеры: имена, имена событий, оперативные данные и описания→ Триггерные URL→ Имена и значения тегов→ Скриптовые элемент данных, прототип элемента данных и правило низкоуровневого обнаружения: имена и значения параметров→ Поля элементов данных, прототипов элементов данных и правил низкоуровневого обнаружения типа HTTP Агент:URL, Поля запроса, Тело запроса, Заголовки, Файл SSL сертификата, Файл SSL ключа, Разрешенные хосты.→ Скрипты действий вручную над узлом сети (в том числе текст подтверждения)→ Скрипты действий вручную над событиями (в том числе текст подтверждения)→ Описание виджета значения элемента данных | IP-адрес или DNS-имя узла сети, в зависимости от его настроек2.Может использоваться с числовым индексом как `{HOST.CONN<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`HOST.DESCRIPTION}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Подписи к элементам карты→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Описание узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{HOST.DESCRIPTION<1-9>} `для ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`HOST.DNS}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Подписи к элементам карты, имена и значения URL на картах сети→ Параметры ключа элемента данных1→ IP/DNS интерфейса узла сети→ Поле "Разрешенные хосты" элементов данных "траппер"→ Дополнительные параметры мониторов баз данных→ Скрипты SSH и Telnet→ Поле JMX endpoint элементов данных→ Веб-мониторинг4→ Регулярное выражение фильтра правила низкоуровневого обнаружения→ Поле URL виджета панели "динамический URL"→ Триггеры: имена, имена событий, оперативные данные и описания→ Триггерные URL→ Имена и значения тегов→ Скриптовые элемент данных, прототип элемента данных и правило низкоуровневого обнаружения: имена и значения параметров→ Поля элементов данных, прототипов элементов данных и правил низкоуровневого обнаружения типа HTTP Агент:URL, Поля запроса, Тело запроса, Заголовки, Файл SSL сертификата, Файл SSL ключа, Разрешенные хосты.→ Скрипты действий вручную над узлом сети (в том числе текст подтверждения)→ Скрипты действий вручную над событиями (в том числе текст подтверждения)→ Описание виджета значения элемента данных | DNS-имя узла сети2.Этот макрос может использоваться с числовым индексом, т.е. `{HOST.DNS<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`HOST.HOST}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события авторегистрации→ Внутренние оповещения→ Параметры ключа элемента данных→ Подписи к элементам карты, имена и значения URL на картах сети→ IP/DNS интерфейса узла сети→ Поле "Разрешенные хосты" элементов данных "траппер"→ Дополнительные параметры мониторов баз данных→ Скрипты SSH и Telnet→ Поле JMX endpoint элементов данных→ Веб-мониторинг4→ Регулярное выражение фильтра правила низкоуровневого обнаружения→ Поле URL виджета панели "динамический URL"→ Триггеры: имена, имена событий, оперативные данные и описания→ Триггерные URL→ Имена и значения тегов→ Скриптовые элемент данных, прототип элемента данных и правило низкоуровневого обнаружения: имена и значения параметров→ Поля элементов данных, прототипов элементов данных и правил низкоуровневого обнаружения типа HTTP Агент:URL, Поля запроса, Тело запроса, Заголовки, Файл SSL сертификата, Файл SSL ключа, Разрешенные хосты.→ Скрипты действий вручную над узлом сети (в том числе текст подтверждения)→ Скрипты действий вручную над событиями (в том числе текст подтверждения)→ Описание виджета значения элемента данных | Имя узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{HOST.HOST<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`HOST.ID}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Подписи к элементам карты, имена и значения URL на картах сети→ Поле URL виджета панели "динамический URL"→ Триггерные URL→ Имена и значения тегов→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Идентификатор узла сети.Может использоваться с числовым индексом, т.е. `{HOST.ID<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`HOST.IP}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события авторегистрации→ Внутренние оповещения→ Подписи к элементам карты, имена и значения URL на картах сети→ Параметры ключа элемента данных1→ IP/DNS интерфейса узла сети→ Поле "Разрешенные хосты" элементов данных "траппер"→ Дополнительные параметры мониторов баз данных→ Скрипты SSH и Telnet→ Поле JMX endpoint элементов данных→ Веб-мониторинг4→ Регулярное выражение фильтра правила низкоуровневого обнаружения→ Поле URL виджета панели "динамический URL"→ Триггеры: имена, имена событий, оперативные данные и описания→ Триггерные URL→ Имена и значения тегов→ Скриптовые элемент данных, прототип элемента данных и правило низкоуровневого обнаружения: имена и значения параметров→ Поля элементов данных, прототипов элементов данных и правил низкоуровневого обнаружения типа HTTP Агент:URL, Поля запроса, Тело запроса, Заголовки, Файл SSL сертификата, Файл SSL ключа, Разрешенные хосты.→ Скрипты действий вручную над узлом сети (в том числе текст подтверждения)→ Скрипты действий вручную над событиями (в том числе текст подтверждения)→ Описание виджета значения элемента данных | IP-адрес узла сети2.Этот макрос может использоваться с числовым индексом, т.е. `{HOST.IP<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`HOST.METADATA}` | `→` Оповещения и команды на события авторегистрации | Метаданные узла сети.Используется только для авторегистрации активного Агента. |
| {`HOST.NAME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Подписи к элементам карты, имена и значения URL на картах сети→ Параметры ключа элемента данных→ IP/DNS интерфейса узла сети→ Поле "Разрешенные хосты" элементов данных "траппер"→ Дополнительные параметры мониторов баз данных→ Скрипты SSH и Telnet→ Веб-мониторинг4→ Регулярное выражение фильтра правила низкоуровневого обнаружения→ Поле URL виджета панели "динамический URL"→ Триггеры: имена, имена событий, оперативные данные и описания→ Триггерные URL→ Имена и значения тегов→ Скриптовые элемент данных, прототип элемента данных и правило низкоуровневого обнаружения: имена и значения параметров→ Поля элементов данных, прототипов элементов данных и правил низкоуровневого обнаружения типа HTTP Агент:URL, Поля запроса, Тело запроса, Заголовки, Файл SSL сертификата, Файл SSL ключа, Разрешенные хосты.→ Скрипты действий вручную над узлом сети (в том числе текст подтверждения)→ Скрипты действий вручную над событиями (в том числе текст подтверждения)→ Описание виджета значения элемента данных | Видимое имя узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{HOST.NAME<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`HOST.PORT}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события авторегистрации→ Внутренние оповещения→ Триггеры: имена, имена событий, оперативные данные и описания→ Триггерные URL→ Поле JMX endpoint элементов данных→ Имена и значения тегов→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Порт узла сети (Агента)2.Этот макрос может использоваться с числовым индексом, т.е. `{HOST.PORT<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`HOST.TARGET.CONN}` | `→` Команды на события триггеров→ Команды на обновление проблем→ Команды на события обнаружения→ Команды на события авторегистрации | IP-адрес или DNS-имя целевого узла сети в зависимости от его настроек. |
| {`HOST.TARGET.DNS}` | `→` Команды на события триггеров→ Команды на обновление проблем→ Команды на события обнаружения→ Команды на события авторегистрации | DNS-имя целевого узла сети. |
| {`HOST.TARGET.HOST}` | `→` Команды на события триггеров→ Команды на обновление проблем→ Команды на события обнаружения→ Команды на события авторегистрации | Техническое имя целевого узла сети. |
| {`HOST.TARGET.IP}` | `→` Команды на события триггеров→ Команды на обновление проблем→ Команды на события обнаружения→ Команды на события авторегистрации | IP-адрес целевого узла сети |
| {`HOST.TARGET.NAME}` | `→` Команды на события триггеров→ Команды на обновление проблем→ Команды на события обнаружения→ Команды на события авторегистрации | Видимое имя целевого узла сети |
| {`HOSTGROUP.ID}` | `→` Подписи к элементам карты, имена и значения URL на картах сети | Идентификатор группы узлов сети. |
| {`INVENTORY.ALIAS}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Псевдоним" (Alias) в` инв`ент`арных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.ALIAS<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.ASSET.TAG}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Этикетка владельца" (Asset tag) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.ASSET.TAG<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.CHASSIS}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Шасси" (Chassis) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.CHASSIS<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.CONTACT}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Контактная информация" (Contact) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.CONTACT<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы.`{PROFILE.CONTACT<1-9>} `является устаревшим. |
| {`INVENTORY.CONTRACT.NUMBER}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Номер контракта" (Contract number`) в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.CONTRACT.NUMBER<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.DEPLOYMENT.STATUS}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Состояние развертывания" (Deployment status) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.DEPLOYMENT.STATUS<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.HARDWARE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Аппаратные средства" (Hardware) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.HARDWARE<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. |
| {`INVENTORY.HARDWARE.FULL}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Аппаратные средства (полная детализация)" (Hardware (Full details))` в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.HARDWARE.FULL<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. |
| {`INVENTORY.HOST.NETMASK}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Маска подсети узла сети" (Host subnet mask) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.HOST.NETMASK<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. |
| {`INVENTORY.HOST.NETWORKS}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Сети узла сети" (Host networks) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.HOST.NETWORKS<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. |
| {`INVENTORY.HOST.ROUTER}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Роутер узла сети" (Host router) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.HOST.ROUTER<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. |
| {`INVENTORY.HW.ARCH}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Архитектура HW" (HW architecture`) в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.HW.ARCH<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.HW.DATE.DECOMM}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Дата списания HW" (Date HW decommissioned) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.HW.DATE.DECOMM<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.HW.DATE.EXPIRY}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Дата окончания обслуживания HW" (Date HW maintenance expires) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.HW.DATE.EXPIRY<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.HW.DATE.INSTALL}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Дата установки HW" (Date HW installed) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.HW.DATE.INSTALL<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.HW.DATE.PURCHASE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Дата покупки HW" (Date HW purchased) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.HW.DATE.PURCHASE<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.INSTALLER.NAME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Имя установщика" (Installer name `) в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.INSTALLER.NAME<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.LOCATION}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Местоположение" (Location) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.LOCATION<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.LOCATION.LAT}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Размещение (широта)" (Location latitude) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.LOCATION.LAT<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.LOCATION.LON}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Размещение (долгота)" (Location longitude) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.LOCATION.LON<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.MACADDRESS.A}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`MAC адрес A" (MAC address A) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.MACADDRESS.A<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.MACADDRESS.B}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`MAC адрес B" (MAC address B) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.MACADDRESS.B<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.MODEL}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Модель" (Model) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.MODEL<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.NAME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Имя" (Name) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.NAME<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.NOTES}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Примечания" (Notes) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.NOTES<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.OOB.IP}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`OOB IP-адрес" (OOB IP address)` в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.OOB.IP<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.OOB.NETMASK}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`OOB маска подсети" (OOB subnet mask`) в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.OOB.NETMASK<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.OOB.ROUTER}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`OOB роутер" (OOB router) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.OOB.ROUTER<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.OS}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`ОС" (OS) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.OS<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.OS.FULL}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`ОС (полная детализация)" (OS (Full details)) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.OS.FULL<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.OS.SHORT}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`ОС (короткое описание)" (OS (Short)) `в` и`нвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.OS.SHORT<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.POC.PRIMARY.CELL}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Первичный мобильный для контакта" (Primary POC cel`l) в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.POC.PRIMARY.CELL<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.POC.PRIMARY.EMAIL}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Первичный email для контакта" (Primary POC email) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.POC.PRIMARY.EMAIL<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.POC.PRIMARY.NAME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Первичное имя для контакта" (Primary POC nam`e) в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.POC.PRIMARY.NAME<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.POC.PRIMARY.NOTES}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Первичные примечания для контакта" (Primary POC notes) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.POC.PRIMARY.NOTES<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.POC.PRIMARY.PHONE.A}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Первичный телефон A для контакта" (Primary POC phone A) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.POC.PRIMARY.PHONE.A<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.POC.PRIMARY.PHONE.B}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Первичный телефон B для контакта" (Primary POC phone B) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.POC.PRIMARY.PHONE.B<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.POC.PRIMARY.SCREEN}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Первичное ник-имя для контакта" (Primary POC screen name) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.POC.PRIMARY.SCREEN<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.POC.SECONDARY.CELL}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Вторичный мобильный для контакта" (Secondary POC cell) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.POC.SECONDARY.CELL<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.POC.SECONDARY.EMAIL}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Вторичный email для контакта" (Secondary POC email) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.POC.SECONDARY.EMAIL<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.POC.SECONDARY.NAME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Вторичное имя для контакта" (Secondary POC name) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.POC.SECONDARY.NAME<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.POC.SECONDARY.NOTES}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Вторичные примечания для контакта" (Secondary POC notes) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.POC.SECONDARY.NOTES<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.POC.SECONDARY.PHONE.A}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Вторичный телефон A для контакта" (Secondary POC phone A ) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.POC.SECONDARY.PHONE.A<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.POC.SECONDARY.PHONE.B}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Вторичный телефон B для контакта" (Secondary POC phone B ) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.POC.SECONDARY.PHONE.B<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.POC.SECONDARY.SCREEN}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Вторичное ник-имя для контакта" (Secondary POC screen name ) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.POC.SECONDARY.SCREEN<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SERIALNO.A}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Серийный номер A" (Serial number A) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SERIALNO.A<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SERIALNO.B}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Серийный номер B" (Serial number B) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SERIALNO.B<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SITE.ADDRESS.A}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Адрес A" (Site address A)` в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SITE.ADDRESS.A<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SITE.ADDRESS.B}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Адрес B" (Site address B) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SITE.ADDRESS.B<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SITE.ADDRESS.C}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Адрес C" (Site address C) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SITE.ADDRESS.C<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SITE.CITY}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Город" (Site city) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SITE.CITY<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SITE.COUNTRY}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Страна" (Site country) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SITE.COUNTRY<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SITE.NOTES}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Заметки" (Site notes) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SITE.NOTES<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SITE.RACK}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Размещение стойки" (Site rack location) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SITE.RACK<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SITE.STATE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Область / район" (Site state/province) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SITE.STATE<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SITE.ZIP}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Почтовый индекс" (Site ZIP/postal`) в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SITE.ZIP<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SOFTWARE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Программное обеспечение" (Software) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SOFTWARE<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SOFTWARE.APP.A}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Программное обеспечение A" (Software application A) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SOFTWARE.APP.A<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SOFTWARE.APP.B}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Программное обеспечение B" (Software application B) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SOFTWARE.APP.B<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SOFTWARE.APP.C}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Программное обеспечение C" (Software application C) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SOFTWARE.APP.C<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SOFTWARE.APP.D}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Программное обеспечение D" (Software application D) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SOFTWARE.APP.D<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SOFTWARE.APP.E}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Программное обеспечение E" (Software application E)` в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SOFTWARE.APP.E<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.SOFTWARE.FULL}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Программное обеспечение (полная детализация)" (Software (Full details))` в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.SOFTWARE.FULL<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.TAG}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Этикетка" (Tag) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.TAG<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.TYPE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Тип" (Type) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.TYPE<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.TYPE.FULL}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Тип (полная детализация)" (Type (Full details)) `в инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.TYPE.FULL<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.URL.A}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`URL A" в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.URL.A<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.URL.B}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`URL B" в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.URL.B<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.URL.C}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`URL C" в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.URL.C<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`INVENTORY.VENDOR}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Имена и значения тегов→ Подписи к элементам карты, имена и значения URL на картах сети→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Поле "`Поставщик" (Vendor) в` инвентарных данных узла сети.Этот макрос может использоваться с числовым индексом, т.е. `{INVENTORY.VENDOR<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.DESCRIPTION}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Описание N-го элемента данных в выражении триггера, являющегося причиной оповещения.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.DESCRIPTION<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.DESCRIPTION.ORIG}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Описание (с нераскрытыми макросами) N-го элемента данных в выражении триггера, являющегося причиной оповещения.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.DESCRIPTION.ORIG<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.ID}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Скриптовые элемент данных, прототип элемента данных и правило низкоуровневого обнаружения: имена и значения параметров6→ Поля элементов данных, прототипов элементов данных и правил низкоуровневого обнаружения типа HTTP Агент:URL, поля запроса, тело запроса, заголовки, Прокси, файл SSL сертификата, файл SSL ключа→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Числовой идентификатор N-го элемента данных в выражении триггера, являющегося причиной оповещения.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.ID<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.KEY}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Скриптовые элемент данных, прототип элемента данных и правило низкоуровневого обнаружения: имена и значения параметров6→ Поля элементов данных, прототипов элементов данных и правил низкоуровневого обнаружения типа HTTP Агент:URL, поля запроса, тело запроса, заголовки, Прокси, файл SSL сертификата, файл SSL ключа→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Ключ N-го элемента данных в выражении триггера, являющегося причиной оповещения.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.KEY<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.KEY.ORIG}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Скриптовые элемент данных, прототип элемента данных и правило низкоуровневого обнаружения: имена и значения параметров6→ Поля элементов данных, прототипов элементов данных и правил низкоуровневого обнаружения типа HTTP Агент:`URL,` `Query fields,` `Request body,` `Headers,` `Proxy,` `SSL certificate file,` `SSL key file,` `Allowed hosts.`6→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Оригинальный ключ (с нераскрытыми макросами) N-го элемента данных в выражении триггера, являющегося причиной оповещения 4.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.KEY.ORIG<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.LASTVALUE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Триггеры: имена, имена событий, оперативные данные и описания→ Имена и значения тегов→ Триггерные URL→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Последнее значение N-го элемента данных в выражении триггера, являющегося причиной оповещения.Макрос будет раскрываться в `*UNKNOWN* `в веб-интерфейсе, если последнее значение в истории было получено более чем Максимальный период отображения истории времени назад (заданное в разделе меню "`Администрирование→ Общие"`).Раскрытое значение для текстовых/журнальных элементов данных усекается веб-интерфейсом до 20 символов в следующих местах:- Оперативные данные;- Описание триггера;- Триггерные URL;- Описание виджета "`значение элемента данных".Ч`тобы раскрыть в полное значение, можно использовать функции макросов. Сервером никаких усечений не производится.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.LASTVALUE<1-9>} д`ля ссылок на первый, второй, третий и т.д. элемент данных в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.LOG.AGE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Триггеры: имена, оперативные данные и описания→ Триггерные URL→ Имена и значения тегов событий→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Возраст события журнального элемента данных, с точностью до секунды.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.LOG.AGE<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.LOG.DATE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Триггеры: имена, оперативные данные и описания→ Триггерные URL→ Имена и значения тегов событий→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Дата события журнального элемента данных.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.LOG.DATE<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.LOG.EVENTID}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Триггеры: имена, оперативные данные и описания→ Триггерные URL→ Имена и значения тегов событий→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Идентификатор события журнального элемента данных.Только для мониторинга журнала событий Windows.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.LOG.EVENTID<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.LOG.NSEVERITY}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Триггеры: имена, оперативные данные и описания→ Триггерные URL→ Имена и значения тегов событий→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Числовое значение важности события журнального элемента данных.Только для мониторинга журнала событий Windows.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.LOG.NSEVERITY<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.LOG.SEVERITY}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Триггеры: имена, оперативные данные и описания→ Триггерные URL→ Имена и значения тегов событий→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Словесное значение важности события журнального элемента данных.Только для мониторинга журнала событий Windows.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.LOG.SEVERITY<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.LOG.SOURCE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Триггеры: имена, оперативные данные и описания→ Триггерные URL→ Имена и значения тегов событий→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Источник события журнального элемента данных.Только для мониторинга журнала событий Windows.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.LOG.SOURCE<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.LOG.TIME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Триггеры: имена, оперативные данные и описания→ Триггерные URL→ Имена и значения тегов событий→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Время события журнального элемента данных.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.LOG.TIME<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.NAME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Имя N-го элемента данных в выражении триггера, являющегося причиной оповещения.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.NAME<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.NAME.ORIG}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.NAME.ORIG<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.STATE}` | `→` Внутренние оповещения на события элементов данных→ Описание виджета значения элемента данных | Последнее состояние N-го элемента данных в выражении триггера, являющегося причиной оповещения. Возможные значения: "`Not supported" и` `Normal.`Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.STATE<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.STATE.ERROR}` | `→` Внутренние оповещения на события элементов данных | Сообщение об ошибке с подробностями того, почему элемент данных стал неподдерживаемым.Если элемент данных переходит в неподдерживаемое состояние, а затем сразу же снова становится поддерживаемым, поле ошибки может быть пустым. |
| {`ITEM.VALUE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Триггеры: имена, имена событий, оперативные данные и описания→ Имена и значения тегов→ Триггерные URL→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Раскрывается в одно из:1) значение из истории (на момент события) N-го элемента данных из выражения триггера, если используется в контексте изменения состояния триггера; например, при отображении событий или при отсылке оповещений.2) последнее значение N-го элемента данных из выражения триггера, если используется вне контекста изменения состояния триггера; например, при отображении списка триггеров во всплывающем окне выбора. В этом случае работает так же, как и `{ITEM.LASTVALUE}.В первом случае` макрос будет раскрываться в `*UNKNOWN*,` если значение истории уже удалено или никогда не хранилось.Во втором случае, и только в веб-интерфейсе, макрос будет раскрыт в `*UNKNOWN*,` если последнее значение истории собрано более чем Максимальный период отображения истории времени назад (задано в разделе меню "`Администрирование→ Общие"`).Раскрытое значение для текстовых/журнальных элементов данных усекается веб-интерфейсом до 20 символов в следующих местах:- Оперативные данные;- Описание триггера;- Триггерные URL;- Описание виджета "`значение элемента данных".Ч`тобы раскрыть в полное значение, можно использовать функции макросов. Сервером никаких усечений не производится.Модификация значения макроса поддерживается для этого макроса.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.VALUE<1-9>} д`ля ссылок на первый, второй, третий и т.д. элемент данных в триггерном выражении. См. нумерованные макросы. |
| {`ITEM.VALUETYPE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения→ Скрипты действий вручную над событиями→ Описание виджета значения элемента данных | Тип значения N-го элемента данных в выражении триггера, являющегося причиной оповещения. Возможные значения: 0 – числовой с плавающей точкой, 1 – символ, 2 – журнал (лог), 3 – числовой целое неотрицательное, 4 – текст.Этот макрос может использоваться с числовым индексом, т.е. `{ITEM.VALUETYPE<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`LLDRULE.DESCRIPTION}` | `→` Внутренние оповещения на события низкоуровневого обнаружения | Описание правила низкоуровневого обнаружения, которое является причиной оповещения. |
| {`LLDRULE.DESCRIPTION.ORIG}` | `→` Внутренние оповещения на события низкоуровневого обнаружения | Описание (с нераскрытыми макросами) правила низкоуровневого обнаружения, которое является причиной оповещения. |
| {`LLDRULE.ID}` | `→` Внутренние оповещения на события низкоуровневого обнаружения | Числовой идентификатор правила низкоуровневого обнаружения, которое является причиной оповещения. |
| {`LLDRULE.KEY}` | `→` Внутренние оповещения на события низкоуровневого обнаружения | Ключ правила низкоуровневого обнаружения, которое является причиной оповещения. |
| {`LLDRULE.KEY.ORIG}` | `→` Внутренние оповещения на события низкоуровневого обнаружения | Оригинальный ключ (с нераскрытыми макросами) правила низкоуровневого обнаружения, которое является причиной оповещения. |
| {`LLDRULE.NAME}` | `→` Внутренние оповещения на события низкоуровневого обнаружения | Имя (с раскрытыми макросами) правила низкоуровневого обнаружения, которое является причиной оповещения. |
| {`LLDRULE.NAME.ORIG}` | `→` Внутренние оповещения на события низкоуровневого обнаружения | Оригинальное имя (с нераскрытыми макросами) правила низкоуровневого обнаружения, которое является причиной оповещения. |
| {`LLDRULE.STATE}` | `→` Внутренние оповещения на события низкоуровневого обнаружения | Последнее состояние правила низкоуровневого обнаружения. Возможные значения: "`Not supported" и` `Normal.` |
| {`LLDRULE.STATE.ERROR}` | `→` Внутренние оповещения на события низкоуровневого обнаружения | Сообщение об ошибке с подробностями того, почему правило низкоуровневого обнаружения стало неподдерживаемым.Если правило низкоуровневого обнаружения переходит в неподдерживаемое состояние и затем сразу же становится снова поддерживаемым, то поле ошибки может быть пустым. |
| {`MAP.ID}` | `→` Подписи к элементам карты, имена и значения URL на картах сети | Идентификатор карты сети. |
| {`MAP.NAME}` | `→` Подписи к элементам карты, имена и значения URL на картах сети→ Текстовые поля в фигурах карт сети | Имя карты сети. |
| {`PROXY.DESCRIPTION}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события обнаружения→ Оповещения и команды на события авторегистрации→ Внутренние оповещения→ Скрипты действий вручную над событиями | Описание Прокси. Раскрывается в одно из:1) Прокси N-го элемента данных из выражения триггера (в оповещениях на триггерные события). Здесь можно использовать нумерованные макросы.2) Прокси, выполнявший обнаружение (в оповещениях на события обнаружения). Здесь использовать `{PROXY.DESCRIPTION}, "без нумерации".`3) Прокси, на котором регистрировался активный Агент (в оповещениях на события авторегистрации). Здесь использовать `{PROXY.DESCRIPTION}, "без нумерации".`Этот макрос может использоваться с числовым индексом, т.е. `{PROXY.DESCRIPTION<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`PROXY.NAME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события обнаружения→ Оповещения и команды на события авторегистрации→ Внутренние оповещения→ Скрипты действий вручную над событиями | Имя Прокси. Раскрывается в одно из:1) Прокси N-го элемента данных из выражения триггера (в оповещениях на триггерные события). Здесь можно использовать нумерованные макросы.2) Прокси, выполнявший обнаружение (в оповещениях на события обнаружения). Здесь использовать `{PROXY.NAME}, "без нумерации".`3) Прокси, на котором регистрировался активный Агент (в оповещениях на события авторегистрации). Здесь использовать `{PROXY.DESCRIPTION}, "без нумерации".`Этот макрос может использоваться с числовым индексом, т.е. `{PROXY.NAME<1-9>} д`ля ссылок на первый, второй, третий и т.д. узел сети в триггерном выражении. См. нумерованные макросы. |
| {`SERVICE.DESCRIPTION}` | `→` Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг | Описание услуги (с раскрытыми макросами). |
| {`SERVICE.NAME}` | `→` Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг | Имя услуги (с раскрытыми макросами). |
| {`SERVICE.ROOTCAUSE}` | `→` Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг | Список событий триггерных проблем, являющихся причиной недоступности услуги, отсортированный по важности и имени узла сети. Включает следующие подробности: имя узла сети, имя события, важность, возраст, имена и значения тегов услуг. |
| {`SERVICE.TAGS}` | `→` Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг | Список тегов событий на услуги (через запятую). Теги событий на услуги могут быть заданы в разделе "`Теги" н`астроек услуг`. `Раскрывается в пустую строку, если теги отсутствуют. |
| {`SERVICE.TAGSJSON}` | `→` Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг | Массив JSON, содержащий объекты тегов событий на услуги. Теги событий на услуги могут быть заданы в разделе "`Теги" н`астроек услуг. Раскрывается в пустой массив, если теги отсутствуют. |
| {`SERVICE.TAGS.<имя_тега>}` | `→` Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг | Значение тега события на услуги, относящееся к данному имени тега. Теги событий на услуги могут быть заданы в разделе "`Теги"` настроек услуг.Имя тега, содержащее не алфавитно-цифровые символы (в том числе неанглийские многобайтовые символы UTF) должно заключаться в кавычки. Кавычки и обратные слеши внутри заключенного в кавычки имени тега должны экранироваться обратным слешем. |
| {`TIME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Оповещения и команды на события услуг→ Оповещения и команды на обновление услуг→ Оповещения и команды на события обнаружения→ Оповещения и команды на события авторегистрации→ Внутренние оповещения→ Имена событий триггеров→ Скрипты действий вручную над событиями | Текущее время в формате `чч:мм:сс.` |
| {`TRIGGER.DESCRIPTION}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения на события триггеров→ Скрипты действий вручную над событиями | Описание триггера.Если `{TRIGGER.DESCRIPTION} и`спользуется в тексте оповещения, то все макросы, поддерживаемые в описании триггера, будут раскрыты.`{TRIGGER.COMMENT} я`вляется устаревшим. |
| {`TRIGGER.EXPRESSION.EXPLAIN}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Скрипты действий вручную над событиями→ Имена событий | Частично вычисленное выражение триггера.Функции на основе элементов данных вычисляются и заменяются результатами на момент генерации события, в то время как все остальные функции отображаются в том виде, как написаны в выражении. Можно использовать для отладки триггерных выражений. |
| {`TRIGGER.EXPRESSION.RECOVERY.EXPLAIN}` | `→` Оповещения и команды на события восстановления проблем→ Оповещения и команды на обновление проблем→ Скрипты действий вручную над событиями | Частично вычисленное выражение восстановления триггера.Функции на основе элементов данных вычисляются и заменяются результатами на момент генерации события, в то время как все остальные функции отображаются в том виде, как написаны в выражении. Можно использовать для отладки выражений восстановления триггеров. |
| {`TRIGGER.EVENTS.ACK}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Подписи к элементам карты→ Скрипты действий вручную над событиями | Количество подтвержденных событий у элемента карты на картах сети, или у триггера, который сгенерировал текущее событие, в оповещениях. |
| {`TRIGGER.EVENTS.PROBLEM.ACK}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Подписи к элементам карты→ Скрипты действий вручную над событиями | Количество подтвержденных событий `ПРОБЛЕМА `у всех триггеров, независимо от их состояния. |
| {`TRIGGER.EVENTS.PROBLEM.UNACK}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Подписи к элементам карты→ Скрипты действий вручную над событиями | Количество неподтвержденных событий `ПРОБЛЕМА `у всех триггеров, независимо от их состояния. |
| {`TRIGGER.EVENTS.UNACK}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Подписи к элементам карты→ Скрипты действий вручную над событиями | Количество неподтвержденных событий у элемента карты на картах сети, или у триггера, который сгенерировал текущее событие, в оповещениях. |
| {`TRIGGER.HOSTGROUP.NAME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения на события триггеров→ Скрипты действий вручную над событиями | Отсортированный (запросом SQL) список групп узлов сети, в которых определен триггер (через запятую). |
| {`TRIGGER.PROBLEM.EVENTS.PROBLEM.ACK}` | `→` Подписи к элементам карты | Количество подтвержденных событий `ПРОБЛЕМА `у триггеров в состоянии `ПРОБЛЕМА.` |
| {`TRIGGER.PROBLEM.EVENTS.PROBLEM.UNACK}` | `→` Подписи к элементам карты | Количество неподтвержденных событий `ПРОБЛЕМА `у триггеров в состоянии `ПРОБЛЕМА.` |
| {`TRIGGER.EXPRESSION}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения на события триггеров→ Скрипты действий вручную над событиями | Выражение триггера. |
| {`TRIGGER.EXPRESSION.RECOVERY}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения на события триггеров→ Скрипты действий вручную над событиями | Выражение восстановления триггера, если параметр `"Генерация ОК- событий" `в настройках триггера задан в "`Выражение восстановления"; `иначе возвращается пустая строка. |
| {`TRIGGER.ID}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения на события триггеров→ Подписи к элементам карты, имена и значения URL на картах сети→ Триггерные URL→ Trigger tag value→ Скрипты действий вручную над событиями | Числовой идентификатор триггера, который привел к срабатыванию этого действия. |
| {`TRIGGER.NAME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения на события триггеров→ Скрипты действий вручную над событиями | Имя триггера (с раскрытыми макросами). |
| {`TRIGGER.NAME.ORIG}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения на события триггеров→ Скрипты действий вручную над событиями | Оригинальное имя триггера (т.е. без раскрытых макросов). |
| {`TRIGGER.NSEVERITY}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения на события триггеров→ Скрипты действий вручную над событиями | Числовое значение важности триггера. Возможные значения: 0 – Не классифицировано, 1 – Информация, 2 – Предупреждение, 3 – Средняя, 4 – Высокая, 5 – Чрезвычайная. |
| {`TRIGGER.SEVERITY}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения на события триггеров→ Скрипты действий вручную над событиями | Имя важности триггера. Может быть задано в разделе "`Администрирование → Общие → Опции отображения триггеров"`. |
| {`TRIGGER.STATE}` | `→` Внутренние оповещения на события триггеров | Последнее состояние триггера. Возможные значения: `Unknown `и `Normal.` |
| {`TRIGGER.STATE.ERROR}` | `→` Внутренние оповещения на события триггеров | Сообщение об ошибке с подробностями того, почему триггер стал неподдерживаемым.Если триггер переходит в неподдерживаемое состояние, а затем сразу же снова становится поддерживаемым, поле ошибки может быть пустым. |
| {`TRIGGER.STATUS}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Скрипты действий вручную над событиями | Значение триггера на момент выполнения шага операции. Может быть либо `PROBLEM,` либо `OK.{STATUS} `является устаревшим. |
| {`TRIGGER.TEMPLATE.NAME}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения на события триггеров→ Скрипты действий вручную над событиями | Отсортированный (запросом SQL) список шаблонов, в которых определен триггер (через запятую), или `*UNKNOWN*,` если триггер определен на узле сети. |
| {`TRIGGER.URL}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Внутренние оповещения на события триггеров→ Скрипты действий вручную над событиями | URL триггера. |
| {`TRIGGER.VALUE}` | `→` Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Trigger expressions→ Скрипты действий вручную над событиями | Текущее числовое значение триггера: 0 – триггер в состоянии OK, 1 – триггер в состоянии `ПРОБЛЕМА.` |
| {`TRIGGERS.UNACK}` | `→` Подписи к элементам карты | Количество неподтвержденных триггеров у элемента карты сети, независимо от состояния триггеров.Триггер считается неподтвержденным, если по крайней мере одно из всех его событий `ПРОБЛЕМА `не подтверждено. |
| {`TRIGGERS.PROBLEM.UNACK}` | `→` Подписи к элементам карты | Количество неподтвержденных триггеров в состоянии `ПРОБЛЕМА `у элемента карты сети.Триггер считается неподтвержденным, если по крайней мере одно из всех его событий `ПРОБЛЕМА `не подтверждено. |
| {`TRIGGERS.ACK}` | `→` Подписи к элементам карты | Количество подтвержденных триггеров у элемента карты сети, независимо от состояния триггеров.Триггер считается подтвержденным, если все его события `ПРОБЛЕМА `являются подтвержденными. |
| {`TRIGGERS.PROBLEM.ACK}` | `→` Подписи к элементам карты | Количество неподтвержденных триггеров в состоянии `ПРОБЛЕМА `у элемента карты сети.Триггер считается подтвержденным, если все его события `ПРОБЛЕМА `являются подтвержденными. |
| {`USER.FULLNAME}` | `→` Оповещения и команды на обновление проблем→ Скрипты действий вручную над узлом сети (в том числе текст подтверждения)→ Скрипты действий вручную над событиями (в том числе текст подтверждения) | Имя, фамилия и имя пользователя того пользователя, который добавил подтверждение события или запустил скрипт. |
| {`USER.NAME}` | `→` Скрипты действий вручную над узлом сети (в том числе текст подтверждения)→ Скрипты действий вручную над событиями (в том числе текст подтверждения) | Имя того пользователя, который запустил скрипт. |
| {`USER.SURNAME}` | `→` Скрипты действий вручную над узлом сети (в том числе текст подтверждения)→ Скрипты действий вручную над событиями (в том числе текст подтверждения) | Фамилия того пользователя, который запустил скрипт. |
| {`USER.USERNAME}` | `→` Скрипты действий вручную над узлом сети (в том числе текст подтверждения)→ Скрипты действий вручную над событиями (в том числе текст подтверждения) | Имя пользователя того пользователя, который запустил скрипт. |
| {`$МАКРОС}` | `→` Смотрите: Пользовательские макросы, поддерживаемые по местоположению | Макросы, определяемые пользователем. |
| {`#МАКРОС}` | `→` Смотрите: Макросы низкоуровневого обнаружения | Макросы низкоуровневого обнаружения.Модификация значения макроса поддерживается для этих макросов. |
| {`?ВЫРАЖЕНИЕ}` | `→` Имена событий триггеров→ Оповещения и команды на события триггеров→ Оповещения и команды на обновление проблем→ Команды скриптов и параметры их вебхуков→ Подписи к элементам карты3→ Подписи к фигурам карты3→ Подписи к связям на карте3→ Имена графиков5 | См. макросы выражений. |
| $1...$9 | → Имена триггеров→ Команды пользовательских параметров | Позиционные макросы/ссылки. |

Примечания:

1 Макросы {HOST.*}, поддерживаемые в параметрах ключа элемента данных, будут раскрываться в интерфейс, выбранный для этого элемента данных. При использовании в элементах данных без интерфейсов они будут раскрываться в интерфейс Агента, SNMP, JMX или IPMI узла сети в этом порядке приоритетов либо в "UNKNOWN" при отсутствии у узла сети каких-либо интерфейсов.

2 В глобальных скриптах, полях IP/DNS интерфейса и веб-сценариях макрос будет раскрываться в основной интерфейс Агента, но, если он отсутствует, будет использоваться основной интерфейс SNMP. Если SNMP также отсутствует, будет использоваться основной интерфейс JMX. Если же и JMX отсутствует, будет использоваться основной интерфейс IPMI. Если у узла сети вообще нет никаких интерфейсов, макрос будет раскрыт в значение "UNKNOWN".

3 В подписях к элементам карты в этом макросе поддерживаются только функции avg, last, max и min, с секундами в качестве параметра.

4 Макросы {HOST.*} поддерживаются в полях веб-сценариев "Переменные", "Заголовки", "Файл SSL сертификата" и "Файл SSL ключа" и в полях шагов сценария "URL", "Post", "Заголовки" и "Требуемая строка". Макросы {HOST.*} не поддерживаются в полях веб-сценария Имя и шага сценария Имя.

5 В именах графиков внутри этого макроса поддерживаются только функции avg, last, max и min, с секундами в качестве параметра. Макрос {HOST.HOST<1-9>} может использоваться в качестве узла сети внутри макроса. Например:

```bash Terminal
last(/Cisco switch/ifAlias[{#SNMPINDEX}])
last(/{HOST.HOST}/ifAlias[{#SNMPINDEX}])
```

# Д.18 Скриптовые элементы данных

Синтаксис нумерованных макросов {МАКРОС<1-9>} ограничен рамками выражений триггеров. Нумерованные макросы можно использовать, чтобы сослаться на узлы сети или функции в том порядке, в котором они указаны в выражении. Такие макросы как {HOST.IP1}, {HOST.IP2}, {HOST.IP3} будут раскрыты в IP первого, второго и третьего узла сети из выражения триггера (если только выражение триггера содержит эти узлы сети). Такие макросы как {FUNCTION.VALUE1}, {FUNCTION.VALUE2}, {FUNCTION.VALUE3} будут раскрыты в значение первой, второй и третьей функции, относящейся к элементам данных, из выражения триггера на момент события (если только выражение триггера содержит эти функции).

Кроме того, макрос {HOST.HOST<1-9>} также поддерживается внутри макроса выражений {?функ(/узел_сети/ключ,парам)} в именах графиков. Например, {?функ(/{HOST.HOST2}/ключ,парам)} в имени графика будет ссылаться на узел сети второго элемента данных графика.

Нумерованные макросы не раскрываются в любом другом контексте, кроме двух упомянутых здесь случаев. В остальных случаях следует использовать макросы без номера (например, {HOST.HOST}, {HOST.IP} и т.п.).

# Д.19 Браузер

В этом разделе представлен список мест, где поддерживаются определяемые пользователем макросы.

Для "Действий", "Сетевого обнаружения", "Прокси" и всех мест, перечисленных в разделе "Другие места" этой страницы, поддерживаются только пользовательские макросы, определенные на глобальном уровне. В упомянутых местах макросы, определенные на уровне узла сети и на уровне шаблона, раскрываться не будут.

При настройке действий пользовательские макросы могут быть использованы в полях, указанных в таблице 103.

1. Действия

| Место | Несколько макросов/вместе с текстом |
| --- | --- |
| Оповещения и команды на события триггеров | да |
| Внутренние оповещения на события триггеров | да |
| Оповещения об обновлении проблем | да |
| Оповещения и команды на события услуг | да |
| Оповещения об обновлении услуг | да |
| Условие периода времени | нет |
| О`перации` |
|  | Длительность шага операции по умолчанию | нет |
|  | Длительность шага | нет |

При настройке узла сети и прототипа узла сети пользовательские макросы могут использоваться в полях, указанных в таблице 104.

1. Узлы сети / прототипы узлов сети

| Место | Несколько макросов/вместе с текстом |
| --- | --- |
| IP-адрес / DNS-имя интерфейса | только DNS |
| Порт интерфейса | нет |
| S`NMP v1, v2` |
|  | SNMP community | да |
| S`NMP v3` |
|  | Имя контекста | да |
|  | Имя безопасности | да |
|  | Пароль аутентификации | да |
|  | Ключевая фраза безопасности | да |
| I`PMI` |
|  | Имя пользователя | да |
|  | Пароль | да |
| Т`еги` |
|  | Имена тегов | да |
|  | Значения тегов | да |

При настройке элементов данных или прототипов элементов данных пользовательские макросы могут использоваться в полях, указанных в таблице 105.

1. Элементы данных / прототипы элементов данных

| Место | Несколько макросов/вместе с текстом |
| --- | --- |
| Параметры ключа элемента данных | да |
| Интервал обновления | нет |
| Пользовательские интервалы | нет |
| Период хранения истории | нет |
| Период хранения динамики изменений | нет |
| Описание | да |
| В`ычисляемый элемент данных` |
|  | Формула | да |
| М`онитор баз данных` |
|  | Имя пользователя | да |
|  | Пароль | да |
|  | SQL запрос | да |
| H`TTP Агент` |
|  | URL | да |
|  | Поля запроса | да |
|  | Время ожидания | нет |
|  | Тело запроса | да |
|  | Заголовки (имена и значения) | да |
|  | Требуемые коды состояния | да |
|  | HTTP Прокси | да |
|  | Имя пользователя для HTTP аутентификации | да |
|  | Пароль для HTTP аутентификации | да |
|  | Файл SSL сертификата | да |
|  | Файл SSL ключа | да |
|  | Пароль к SSL ключу | да |
|  | Разрешенные хосты | да |
| J`MX Агент` |
|  | JMX endpoint | да |
| С`криптовый элемент данных` |
|  | Имена и значения параметров | да |
| S`NMP Агент` |
|  | SNMP OID | да |
| S`SH Агент` |
|  | Имя пользователя | да |
|  | Файл публичного ключа | да |
|  | Файл приватного ключа | да |
|  | Пароль | да |
|  | Выполняемый скрипт | да |
| T`ELNET Агент` |
|  | Имя пользователя | да |
|  | Пароль | да |
|  | Выполняемый скрипт | да |
| Т`раппер` |
|  | Разрешенные хосты | да |
| Т`еги` |
|  | Имена тегов | да |
|  | Значения тегов | да |
| П`редобработка` |
|  | Параметры шагов (включая пользовательские скрипты) | да |

При настройке правил низкоуровневого обнаружения пользовательские макросы могут использоваться в полях, указанных в таблице 106.

1. Низкоуровневое обнаружение

| Место | Несколько макросов/вместе с текстом |
| --- | --- |
| Параметры ключа | да |
| Интервал обновления | нет |
| Пользовательские интервалы | нет |
| Период сохранения потерянных ресурсов | нет |
| Описание | да |
| S`NMP Агент` |
|  | SNMP OID | да |
| S`SH Агент` |
|  | Имя пользователя | да |
|  | Файл публичного ключа | да |
|  | Файл приватного ключа | да |
|  | Пароль | да |
|  | Выполняемый скрипт | да |
| T`ELNET Агент` |
|  | Имя пользователя | да |
|  | Пароль | да |
|  | Выполняемый скрипт | да |
| т`раппер` |
|  | Разрешенные хосты | да |
| М`ониторинг баз данных` |
|  | Имя пользователя | да |
|  | Пароль | да |
|  | SQL запрос | да |
| J`MX Агент` |
|  | JMX endpoint | да |
| H`TTP Агент` |
|  | URL | да |
|  | Поля запроса | да |
|  | Время ожидания | нет |
|  | Тело запроса | да |
|  | Заголовки (имена и значения) | да |
|  | Требуемые коды состояния | да |
|  | Имя пользователя для HTTP аутентификации | да |
|  | Пароль для HTTP аутентификации | да |
| Ф`ильтры` |
|  | Регулярное выражение | да |
| З`амещения` |
|  | Фильтры: регулярное выражение | да |
|  | Операции: интервал обновления (для прототипов элементов данных) | нет |
|  | Операции: период хранения истории (для прототипов элементов данных) | нет |
|  | Операции: период хранения динамики изменений (для прототипов элементов данных) | нет |

При настройке правил сетевого обнаружения пользовательские макросы могут использоваться в полях, указанных в таблице 107.

1. Сетевое обнаружение

| Место | Несколько макросов/вместе с текстом |
| --- | --- |
| Интервал обновления | нет |
| S`NMP v1, v2` |
|  | SNMP community | да |
|  | SNMP OID | да |
| S`NMP v3` |
|  | Имя контекста | да |
|  | Имя безопасности | да |
|  | Пароль аутентификации | да |
|  | Ключевая фраза безопасности | да |
|  | SNMP OID | да |

При настройке Прокси-серверов пользовательские макросы могут использоваться в полях, указанных в таблице 108.

1. Прокси-серверы

| Место | Несколько макросов/вместе с текстом |
| --- | --- |
| Порт интерфейса (для пассивных Прокси) | нет |

При настройке шаблонов пользовательские макросы могут использоваться в полях, указанных в таблице 109.

1. Шаблоны

| Место | Несколько макросов/вместе с текстом |
| --- | --- |
| Т`еги` |
|  | Имена тегов | да |
|  | Значения тегов | да |

При настройке триггеров пользовательские макросы могут использоваться в полях, указанных в таблице 110

1. Триггеры

| Место | Несколько макросов/вперемешку с текстом |
| --- | --- |
| Имя | да |
| Оперативные данные | да |
| Выражение (только в константах и параметрах функций; секретные макросы не поддерживаются) | да |
| Описание | да |
| URL | да |
| Теги для совпадения | да |
| Т`еги` |
|  | Имена тегов | да |
|  | Значения тегов | да |

При настройке веб-сценариев пользовательские макросы могут использоваться в полях, указанных в таблице 111.

1. Веб-сценарии

| Место | Несколько макросов/вместе с текстом |
| --- | --- |
| Имя | да |
| Интервал обновления | нет |
| Агент | да |
| HTTP Прокси | да |
| Переменные (только значения) | да |
| Заголовки (имена и значения) | да |
| Ш`аги` |
|  | Имя | да |
|  | URL | да |
|  | Переменные (только значения) | да |
|  | Заголовки (имена и значения) | да |
|  | Время ожидания | нет |
|  | Требуемая строка | да |
|  | Требуемые коды состояния | нет |
| А`утентификация` |
|  | Пользователь | да |
|  | Пароль | да |
|  | Файл SSL сертификата | да |
|  | Файл SSL ключа | да |
|  | Пароль к SSL ключу | да |
| Т`еги` |
|  | Имена тегов | да |
|  | Значения тегов | да |

Помимо перечисленных здесь мест, пользовательские макросы могут использоваться в полях, указанных в таблице 112.

1. Другие места

| Место | Несколько макросов/вместе с текстом |
| --- | --- |
| Глобальные скрипты (скрипт, SSH, Telnet, IPMI), включая текст подтверждения | да |
| Вебхуки |
|  | Скрипт JavaScript | нет |
|  | Имя параметра скрипта JavaScript | нет |
|  | Значение параметра скрипта JavaScript | да |
| М`ониторинг → Панели` |
|  | Поле описания виджета панели `Значение элемента данных` | да |
|  | Поле URL виджета панели `динамический URL` | да |
| А`дминистрирование → Пользователи → Оповещения` |
|  | Когда активен | нет |
| А`дминистрирование → Общие → Веб-интерфейс` |
|  | Рабочее время | нет |
| А`дминистрирование → Способы оповещений → Шаблоны сообщений` |
|  | Тема | да |
|  | Сообщение | да |

Примечания:

- Если несколько макросов в поле или макросы вместе с текстом не поддерживаются для данного места, то один макрос должен заполнять целиком все поле.
- Макросы, которые используются в именах и значениях тегов, раскрываются только во время процесса генерации событий.
- URL, которые содержат секретные макросы, работать не будут, поскольку макросы в них будут раскрыты как `"******".`

Приложение К. Прочее