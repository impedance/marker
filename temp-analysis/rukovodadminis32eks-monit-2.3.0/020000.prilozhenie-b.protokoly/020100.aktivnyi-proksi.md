# Активный Прокси

Протокол Агента-2 основан на коде, размере и модели данных (таблицы 18-20).

1. Код

| Тип | Размер | Комментарии |
| --- | --- | --- |
| B`yte` | `4` | Тип полезной нагрузки, в настоящее время поддерживается только JSON. |

1. Размер

| Тип | Размер | Комментарии |
| --- | --- | --- |
| B`yte` | 4 | Размер текущей полезной нагрузки в байтах. |

1. Данные полезной нагрузки

| Тип | Размер | Комментарии |
| --- | --- | --- |
| B`yte` | Определяется полем `Размер` | Данные в формате JSON. |

Определение данных полезной нагрузки

Параметры, присутствующие во всех вопросах/ответах, – в таблице 21.

1. Общие параметры

| Имя | Тип | Комментарии |
| --- | --- | --- |
| i`d` | `uint32` | `Д`ля запросов – возрастающий идентификатор, используемый, чтобы связать запросы с ответами. Уникален в пределах направления запроса (т.е. от Агента к плагину или от плагина к Агенту).Для ответов – идентификатор соответствующего запроса. |
| t`ype` | `uint32` | `Т`ип запроса. |

Запрос журналирования отсылается плагином, чтобы записать журнальное сообщение в журнальный файл Агента:

| направление | плагин → Агент |
| --- | --- |
| ответ | нет |

Параметры, специфичные для запросов журналирования, – в таблице 22.

1. Параметры, специфичные для запросов журналирования

| Имя | Тип | Комментарии |
| --- | --- | --- |
| s`everity` | `uint32` | `В`ажность сообщения (уровень журналирования). |
| m`essage` | `string` | `С`ообщение для журнала. |

Запрос регистрации отсылается Агентом в фазе начальной загрузки Агента, чтобы получить предоставляемые метрики для регистрации плагина:

| направление | Агент → плагин |
| --- | --- |
| ответ | да |

Параметры, специфичные для запросов регистрации, – в таблице 23.

1. Параметры запроса регистрации

| Имя | Тип | Комментарии |
| --- | --- | --- |
| version | `string` | Версия протокола `<major>.<minor>` |

Ответ плагина на запрос на регистрацию:

| направление | плагин → Агент |
| --- | --- |
| ответ | неприменимо |

Параметры, специфичные для ответов на регистрацию, – в таблице 24.

1. Параметры ответов на регистрацию

| Имя | Тип | Комментарии |
| --- | --- | --- |
| n`ame` | `string` | Имя плагина. |
| m`etrics` | `array of strings (`опционально) | Метрики с описаниями, как используется в плагине. Возвращает `RegisterMetrics().` Отсутствует, если возвращается ошибка. |
| i`nterfaces` | `uint32 `(опционально) | Битовая маска интерфейсов, поддерживаемых плагином. Отсутствует, если возвращается ошибка. |
| e`rror` | `string `(опционально) | Сообщение об ошибке возвращается, если плагин не может запуститься. Отсутствует, если возвращаются метрики. |

Запрос на выполнение функции запуска (Start) интерфейса Runner:

| направление | Агент → плагин |
| --- | --- |
| ответ | нет |

Запрос на запуск не имеет специфичных параметров, он содержит только параметры общих данных.

Запрос на останов отсылается Агентом, чтобы остановить плагин:

| направление | Агент → плагин |
| --- | --- |
| ответ | нет |

Запрос на запуск не имеет специфичных параметров, он содержит только параметры общих данных.

Запрос на выполнение функции экспорта (Export) интерфейса Exporter:

| направление | Агент → плагин |
| --- | --- |
| ответ | нет |

Параметры, специфичные для запросов экспорта, – в таблице 25.

1. Параметры запроса экспорта

| Имя | Тип | Комментарии |
| --- | --- | --- |
| k`ey` | `string` | Ключ плагина. |
| p`arameters` | `array of strings `(опционально) | Параметры для функции `Export.` |

Ответ экспорта из функции Export интерфейса Exporter:

| направление | плагин → Агент |
| --- | --- |
| ответ | неприменимо |

Параметры, специфичные для ответов экспорта, – в таблице 26.

1. Параметры ответов экспорта

| Имя | Тип | Комментарии |
| --- | --- | --- |
| v`alue` | `string `(опционально) | Значение ответа из функции `Export.` Отсутствует, если возвращается ошибка. |
| e`rror` | `string `(опционально) | Сообщение об ошибке, если функция `Export `не была выполнена успешно. Отсутствует, если возвращается значение (`value)`. |

Запрос на конфигурацию на выполнение функции Configure интерфейса Configurator:

| направление | Агент → плагин |
| --- | --- |
| ответ | неприменимо |

Параметры, специфичные для запросов Configure, – в таблице 27.

1. Параметры запроса конфигурации

| Имя | Тип | Комментарии |
| --- | --- | --- |
| g`lobal_options` | `объект JSON` | `О`бъект JSON, содержащий глобальные опции конфигурации Агента. |
| p`rivate_options` | `объект JSON `(опционально) | Объект JSON, содержащий персональные опции конфигурации плагина, если есть. |

Запрос на валидацию на выполнение функции Validate интерфейса Configurator:

| направление | Агент → плагин |
| --- | --- |
| ответ | да |

Параметры, специфичные для запросов Validate, – в таблице 28.

1. Параметры запроса на валидацию

| Имя | Тип | Комментарии |
| --- | --- | --- |
| p`rivate_options` | `объект JSON `(опционально) | Объект JSON, содержащий персональные опции конфигурации плагина, если есть. |

Ответ на валидацию от функции Validate интерфейса Configurator:

| направление | плагин → Агент |
| --- | --- |
| ответ | неприменимо |

Параметры, специфичные для ответов на Validate, – в таблице 29.

1. Параметры ответов на валидацию

| Имя | Тип | Комментарии |
| --- | --- | --- |
| e`rror` | `string `(опционально) | Сообщение об ошибке, возвращаемое, если функция `Validate `не была выполнена успешно. Отсутствует при успешном завершении. |

# Б.3 Протокол Агента-1

Для получения более подробной информации следует обратиться к п.Д.12.

# Б.4 Протокол Агента-2

Заголовок присутствует во всех сообщениях запросов и ответов между компонентами Подсистемы. Требуется определить длину сообщения, его сжатие и величину.

Протокол связи Подсистемы имеет ограничение размера пакета в 1 ГБ на одно соединение. Это ограничение в 1 ГБ относится как к длине полученных пакетных данных, так и к длине несжатых данных.

При отправке конфигурации на Прокси ограничение размера пакета увеличено до 4 ГБ, чтобы позволить синхронизацию больших конфигураций. Если длина данных до сжатия превышает 4 ГБ, Сервер автоматически начинает использовать формат больших пакетов (флаг 0x04), что повышает ограничение размера пакета до 16 ГБ.

Следует обратить внимание, что хотя для отправки любых данных можно использовать большой формат пакетов, только процесс синхронизации конфигурации Прокси (configuration syncer) может обрабатывать пакеты размером более 1 ГБ.

Заголовок состоит из четырех полей. Все числа в заголовке имеют прямой порядок байтов (little-endian) (таблица 30).

1. Описание полей заголовка

| Поле | Размер | Размер(большой пакет) | Описание |
| --- | --- | --- | --- |
| `<ПРОТОКОЛ>` | 4 | 4 | `"ZBXD"` или `5A 42 58 44` |
| `<ФЛАГИ>` | 1 | 1 | Флаги протокола:`0x01 `– протокол связи Подсистемы`0x02 `– сжатие`0x04 `– большой пакет |
| `<ДЛИНАДАННЫХ>` | 4 | 8 | Длина данных. |
| `<РЕЗЕРВ>` | 4 | 8 | При использовании сжатия (флаг `0x02)` – длина несжатых данныхКогда сжатие не используется – `00 00 00 00` |

Ниже представлены несколько фрагментов кода, демонстрирующих, как к отсылаемым данным (переменная data) добавить заголовок протокола, чтобы пакет, который нужно отправить в Подсистему, получился правильно интерпретируемым. Эти фрагменты кода подразумевают, что данные не превышают 1 ГБ, поэтому формат больших пакетов не используется.

Python

```bash Terminal
packet = b"ZBXD\1" + struct.pack("<II", len(data), 0) + data
```

или

```bash Terminal
def zbx_create_header(plain_data_size, compressed_data_size=None):
protocol = b"ZBXD"
flags = 0x01
if compressed_data_size is None:
datalen = plain_data_size
reserved = 0
else:
flags |= 0x02
datalen = compressed_data_size
reserved = plain_data_size
return protocol + struct.pack("<BII", flags, datalen, reserved)
packet = zbx_create_header(len(data)) + data
```

Perl

```bash Terminal
my $packet = "ZBXD\1" . pack("(II)<", length($data), 0) . $data;
```

или

```bash Terminal
sub zbx_create_header($;$)
{
my $plain_data_size = shift;
my $compressed_data_size = shift;
my $protocol = "ZBXD";
my $flags = 0x01;
my $datalen;
my $reserved;
if (!defined($compressed_data_size))
{
$datalen = $plain_data_size;
$reserved = 0;
}
else
{
$flags |= 0x02;
$datalen = $compressed_data_size;
$reserved = $plain_data_size;
}
return $protocol . chr($flags) . pack("(II)<", $datalen, $reserved);
}
my $packet = zbx_create_header(length($data)) . $data;
```

PHP

```bash Terminal
$packet = "ZBXD\1" . pack("VV", strlen($data), 0) . $data;
```

или

```bash Terminal
function zbx_create_header($plain_data_size, $compressed_data_size = null)
{
$protocol = "ZBXD";
$flags = 0x01;
if (is_null($compressed_data_size))
{
$datalen = $plain_data_size;
$reserved = 0;
}
else
{
$flags |= 0x02;
$datalen = $compressed_data_size;
$reserved = $plain_data_size;
}
return $protocol . chr($flags) . pack("VV", $datalen, $reserved);
}
$packet = zbx_create_header(strlen($data)) . $data;
```

Bash

```bash Terminal
datalen=$(printf "%08x" ${#data})
datalen=\\x${datalen:6:2}\\x${datalen:4:2}\\x${datalen:2:2}\\x${datalen:0:2}
printf "ZBXD\1${datalen}\0\0\0\0%s" "$data"
```

# Б.5 Протокол плагина Агента-2

В этом разделе представлены подробности реализации протокола экспорта в режиме реального времени в формате JSON с новой строкой в качестве разделителя для:

- триггерных событий;
- значений элементов данных;
- динамики изменений.

Все файлы имеют расширение .ndjson. Каждая строка файла экспорта является объектом JSON.

# Б.6 Протокол sender

Для события проблемы экспортируется информация из таблицы 31.

1. Поля триггерного события проблемы

| Поле | Тип | Описание |
| --- | --- | --- |
| c`lock` | число | Количество секунд с начала эпохи до момента обнаружения проблемы (целая часть). |
| n`s` | число | Количество наносекунд, которые необходимо добавить к `clock,` чтобы получить точное время обнаружения проблемы. |
| v`alue` | число | 1 (всегда). |
| e`ventid` | число | Идентификатор события проблемы. |
| n`ame` | строка | Имя события проблемы. |
| s`everity` | число | Важность события проблемы (0 – Не классифицировано, 1 – Информация, 2 – Предупреждение, 3 – Средняя, 4 – Высокая, 5 – Чрезвычайная). |
| h`osts` | массив | Список узлов сети, участвующих в выражении триггера; в массиве должен быть хотя бы один элемент. |
|  | - | объект |
|  |  | `host` | строка | Имя узла сети. |
|  |  | `name` | строка | Видимое имя узла сети. |
| g`roups` | массив | Список групп всех узлов сети, участвующих в выражении триггера; в массиве должен быть хотя бы один элемент. |
|  | - | строка | Имя группы узлов сети. |
| t`ags` | массив | Список тегов проблемы (может быть пустым). |
|  | - | объект |
|  |  | `tag` | строка | Имя тега. |
|  |  | `value` | строка | Значение тега (может быть пустым). |

Для события восстановления экспортируется информация из таблицы 32.

1. Поля триггерного события восстановления

| Поле | Тип | Описание |
| --- | --- | --- |
| c`lock` | число | Количество секунд с начала эпохи до момента восстановления проблемы (целая часть). |
| n`s` | число | Количество наносекунд, которые нужно добавить к `clock,` чтобы получить точное время восстановления проблемы. |
| v`alue` | число | 0 (всегда). |
| e`ventid` | число | Идентификатор события восстановления. |
| p`_eventid` | число | Идентификатор события проблемы. |

# Б.7 Заголовок

Для собранного значения элемента данных экспортируется информация из таблицы 33.

1. Поля значения элемента данных

| Поле | Тип | Описание |
| --- | --- | --- |
| h`ost` | `объект` | `И`мя узла сети этого элемента данных. |
|  | `host` | `строка` | `И`мя узла сети. |
|  | `name` | `строка` | `В`идимое имя узла сети. |
| g`roups` | `массив` | `С`писок групп узлов сети для узла сети этого элемента данных; в массиве должен быть по крайней мере один элемент. |
|  | `-` | `строка` | `И`мя группы узла сети. |
| i`temid` | `число` | `I`D элемента данных. |
| n`ame` | `строка` | `В`идимое имя элемента данных. |
| c`lock` | `число` | `К`оличество секунд с начала эпохи до момента сбора значения (целая часть). |
| n`s` | `число` | `К`оличество наносекунд, которые нужно добавить к `clock `для получения точного времени сбора значения. |
| t`imestamp`(только `Журнал (лог))` | `число` | `0`, если недоступно. |
| s`ource`(только `Журнал (лог))` | `строка` | `П`устая строка если недоступно. |
| s`everity`(только `Журнал (лог))` | `число` | `0`, если недоступно. |
| e`ventid`(только `Журнал (лог))` | `число` | `0`, если недоступно. |
| v`alue` | `число (для числовых элементов данных) илистрока (для текстовых элементов данных)` | `С`обранное значение элемента данных. |
| t`ype` | `число` | `Т`ип собранного значения:0 – Числовой (с плавающей точкой), 1 – Символ, 2 – Журнал (лог), 3 – Числовой (целое положительное), 4 – Текст |

# Б.8 Протокол экспорта в режиме реального времени

Для подсчитанного значения динамики изменений экспортируется информация из таблицы 34.

1. Поля динамики изменений

| Поле | Тип | Описание |
| --- | --- | --- |
| h`ost` | `объект` | `И`мя узла сети этого элемента данных. |
|  | `host` | `строка` | `И`мя узла сети. |
|  | `name` | `строка` | `В`идимое имя узла сети. |
| g`roups` | `массив` | `С`писок групп узлов сети этого элемента данных; в массиве должен быть по крайней мере один элемент. |
|  | `-` | `строка` | `И`мя узла сети. |
| i`temid` | `число` | `I`D элемента данных. |
| n`ame` | `строка` | `В`идимое имя элемента данных. |
| c`lock` | `число` | `К`оличество секунд с начала эпохи до момента получения значения (целая часть). |
| c`ount` | `число` | `К`оличество значений, собранных за данный час. |
| m`in` | `число` | `Н`аименьшее значение элемента данных за данный час. |
| a`vg` | `число` | `С`реднее значение элемента данных за данный час. |
| m`ax` | `число` | `Н`аибольшее значение элемента данных за данный час. |
| t`ype` | `число` | `Т`ип значения:0 – числовой (с плавающей точкой), 3 – числовой беззнаковый |

Приложение В. Типы процессов

1. Типы процессов Сервера
  - `alert manager `– менеджер задач оповещений;
  - `alert syncer `– процесс записи оповещений в БД;
  - `alerter `– процесс отправки оповещений;
  - `availability manager `– процесс для обновления доступности узлов сети;
  - `configuration syncer `– процесс управления кэшем данных конфигурации в оперативной памяти;
  - `discoverer `– процесс обнаружения устройств;
  - `escalator `– процесс эскалации действий;
  - `ha manager `– процесс управления кластером высокой доступности;
  - `history poller `– процесс обработки вычисляемых, агрегированных и внутренних проверок, требующих подключения к базе данных;
  - `history syncer `– процесс, который записывает историю в БД;
  - `housekeeper `– процесс удаления устаревших данных истории;
  - `http poller `– поллер веб-мониторинга;
  - `icmp pinger `– поллер проверок icmpping;
  - `ipmi manager `– менеджер IPMI-поллеров;
  - `ipmi poller `– поллер для проверок через IPMI;
  - `java poller `– поллер для Java-проверок;
  - `lld manager `– процесс менеджера задач низкоуровневого обнаружения;
  - `lld worker `– рабочий процесс для задач низкоуровневого обнаружения;
  - `odbc poller `– поллер для ODBC-проверок;
  - `poller `– обычный поллер для пассивных проверок;
  - `preprocessing manager `– менеджер задач предобработки;
  - `preprocessing worker `– рабочий процесс предобработки данных;
  - `proxy poller `– поллер для пассивных Прокси;
  - `report manager `– процесс менеджера задач генерации отчетов по расписанию;
  - `report writer `– процесс генерации отчетов по расписанию;
  - `self-zabbix `– процесс сбора внутренней статистики Сервера;
  - `service manager `– процесс управления услугами для получения информации о проблемах, тегах проблем и событиях восстановления после проблем от процессов history syncer, task manager и alert manager;
  - `snmp trapper `– траппер сбора/обработки SNMP-трапов;
  - `task manager `– процесс для удаленного выполнения задач, которые запрашиваются другими компонентами (например, функционал закрытия проблемы, подтверждения проблемы, принудительной проверки значения элемента данных, удаленной команды);
  - `timer `– процесс обработки обслуживаний;
  - `trapper `– процесс-улавливатель для активных проверок, трапов и взаимодействия с Прокси;
  - `unreachable poller `– поллер недоступных устройств.
2. Типы процессов Прокси
  - a`vailability manager `– процесс для обновления доступности узлов сети;
  - `configuration syncer `– процесс управления кэшем данных конфигурации в оперативной памяти;
  - `data sender `– процесс отправки данных с Прокси;
  - `discoverer `– процесс обнаружения устройств;
  - `heartbeat sender `– процесс уведомления Сервера Прокси Сервером о своем состоянии;
  - `history poller `– процесс обработки вычисляемых, агрегированных и внутренних проверок, требующих подключения к базе данных;
  - `history syncer `– процесс, который записывает историю в БД;
  - `housekeeper `– процесс удаления устаревших данных истории;
  - `http poller `– поллер веб-мониторинга;
  - `icmp pinger `– поллер проверок icmpping;
  - `ipmi manager `– менеджер IPMI-поллеров;
  - `ipmi poller `– поллер для проверок через IPMI;
  - `java poller `– поллер для Java-проверок;
  - `odbc poller `– поллер для ODBC-проверок;
  - `poller `– обычный поллер для пассивных проверок;
  - `preprocessing manager `– менеджер задач предобработки;
  - `preprocessing worker `– рабочий процесс предобработки данных;
  - `self-zabbix `– процесс сбора внутренней статистики Сервера;
  - `snmp trapper `– траппер сбора/обработки SNMP-трапов;
  - `task manager `– процесс для удаленного выполнения задач, которые запрашиваются другими компонентами (например, функционал закрытия проблемы, подтверждения проблемы, принудительной проверки значения элемента данных, удаленной команды);
  - `trapper `– процесс-улавливатель для активных проверок, трапов и Прокси;
  - `unreachable poller `– поллер недоступных устройств.

Приложение Г. Элементы данных

# Б.8.1 Триггерные события

В таблице 35 показаны поддерживаемые Агентом элементы данных на различных платформах:

- элементы данных с пометкой "X" поддерживаются;
- элементы данных с пометкой "-" не поддерживаются;
- если элемент данных с пометкой "?"`, `то поддержка не определена;
- если элемент данных с пометкой "r"`, `то требуются права доступа уровня `root;`
- параметры, которые заключены в угловые скобки "<>"`, `являются необязательными.

В таблицу не включены элементы данных Агента, поддерживаемые или относящиеся только к Windows.

1. Поддерживаемые Агентом элементы данных на различных платформах

| NetBSD | ▼▼ |
| --- | --- |
| OpenBSD | ▼▼ |  |
| Mac OS X | ▼▼ |  |  |
| Tru64 | ▼▼ |  |  |  |
| AIX | ▼▼ |  |  |  |  |
| HP-UX | ▼▼ |  |  |  |  |  |
| Solaris | ▼▼ |  |  |  |  |  |  |
| FreeBSD | ▼▼ |  |  |  |  |  |  |  |
| Linux 2.6 (и новее) | ▼▼ |  |  |  |  |  |  |  |  |
| Linux 2.4 | ▼▼ |  |  |  |  |  |  |  |  |  |
| Windows | ▼▼ |  |  |  |  |  |  |  |  |  |  |
| ▼` Item ▼` | `1` | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 |
| a`gent.HostMetadata` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| a`gent.Hostname` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| a`gent.ping` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| a`gent.variant` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| a`gent.version` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| k`ernel.maxfiles` | `-` | `X` | `X` | `X` | `-` | `-` | `-` | `?` | `X` | `X` | `X` |
| k`ernel.maxproc` | `-` | `-` | `X` | `X` | `X` | `-` | `-` | `?` | `X` | `X` | `X` |
| k`ernel.openfiles` | `-` | X | X | ? | ? | ? | ? | ? | ? | ? | ? |
| l`og[файл,<регулярное выражение>,<кодировка>,<макс. кол-во строк>,<режим>,<вывод>,<максзадержка>,<постоянное_хранилище>]` | `X4` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| п`остоянное_хранилище ▲` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| l`og.count[файл,<регулярное выражение>,<кодировка>,<макс. кол-во строк>,<режим>,<максзадержка>,<постоянное_хранилище>]` | `X4` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| п`остоянное_хранилище ▲` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| l`ogrt[регулярное_выражение_файла,<регулярное выражение>,<кодировка>,<макс. кол-во строк>,<режим>,<вывод>,<максзадержка>,<опции>,<постоянное_хранилище>]` | `X4` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| п`остоянное_хранилище ▲` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| l`ogrt.count[регулярное_выражение_файла,<регулярное выражение>,<кодировка>,<макс. кол-во строк>,<режим>,<максзадержка>,<опции>,<постоянное_хранилище>]` | `X4` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| п`остоянное_хранилище ▲` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| m`odbus.get[точка входа,<id ведомого>,<функция>,<адрес>,<количество>,<тип>,<порядок следования байтов>,<сдвиг>]` | `X` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| n`et.dns[<ip>,имя,<тип>,<время ожидания>,<количество>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| n`et.dns.record[<ip>,имя,<тип>,<время ожидания>,<количество>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| n`et.if.collisions[if]` | `-` | `X` | `X` | `X` | `X` | `-` | `X` | `-` | `X` | `X` | `r` |
| n`et.if.discovery` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `-` | `X` | `X` |
| n`et.if.in[if,<режим>]` | `X` | `X` | `X` | `X` | `X` | `X1` | `X` | `-` | `X` | `X` | `r` |
| р`ежим ▲` | `Bytes (`по умолчанию) | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `r` |
|  | `packets` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `r` |
|  | `errors` | `X` | `X` | `X` | `X` | `X2` | `X` | `X` | `-` | `X` | `X` | `r` |
|  | `dropped` | `X` | `X` | `X` | `X` | `-` | `X` | `-` | `-` | `X` | `X` | `r` |
|  | `overruns` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `frame` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `compressed` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `multicast` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| n`et.if.out[if,<режим>]` | `X` | `X` | `X` | `X` | `X` | `X1` | `X` | `-` | `X` | `X` | `r` |
| р`ежим ▲` | `Bytes (`по умолчанию) | `X` | `X` | `X` | `X` | `X2` | `X` | `X` | `-` | `X` | `X` | `r` |
|  | `packets` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `r` |
|  | `errors` | `X` | `X` | `X` | `X` | `X2` | `X` | `X` | `-` | `X` | `X` | `r` |
|  | `dropped` | `X` | `X` | `X` | `-` | `-` | `X` | `-` | `-` | `-` | `-` | `-` |
|  | `overruns` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `collision` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `carrier` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `compressed` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| n`et.if.total[if,<режим>]` | `X` | `X` | `X` | `X` | `X` | `X1` | `X` | `-` | `X` | `X` | `r` |
| р`ежим ▲` | `Bytes (`по умолчанию) | `X` | `X` | `X` | `X` | `X2` | `X` | `X` | `-` | `X` | `X` | `r` |
|  | `packets` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `r` |
|  | `errors` | `X` | `X` | `X` | `X` | `X2` | `X` | `X` | `-` | `X` | `X` | `r` |
|  | `dropped` | `X` | `X` | `X` | `-` | `-` | `X` | `-` | `-` | `-` | `-` | `-` |
|  | `overruns` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `compressed` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| n`et.tcp.LISTEN[port]` | `X` | `X` | `X` | `X` | `X` | `-` | `-` | `-` | `X` | `-` | `-` |
| n`et.tcp.port[<ip>,порт]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| n`et.tcp.service[сервис,<ip>,<порт>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| n`et.tcp.service.perf[сервис,<ip>,<порт>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| n`et.tcp.socket.count[<локальный_адрес>,<локальный_порт>,<удаленный_адрес>,<удаленный_порт>,<состояние>]` | `X7` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| n`et.udp.LISTEN[порт]` | `-` | `X` | `X` | `X` | `X` | `-` | `-` | `-` | `X` | `-` | `-` |
| n`et.udp.service[сервис,<ip>,<порт>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| n`et.udp.service.perf[сервис,<ip>,<порт>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| n`et.udp.socket.count[<локальный_адрес>,<локальный_порт>,<удаленный_адрес>,<удаленный_порт>,<состояние>]` | `X7` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| p`roc.cpu.util[<имя>,<пользователь>,<тип>,<cmdline>,<режим>,<зона>]` | `-` | `X` | `X` | `-` | `X 3` | `-` | `-` | `-` | `-` | `-` | `-` |
| т`ип ▲` | `total (`по умолчанию) | `-` | `X` | `X` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `user` | `-` | `X` | `X` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `system` | `-` | `X` | `X` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` |
| р`ежим ▲` | `avg1 (`по умолчанию) | `-` | `X` | `X` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `avg5` | `-` | `X` | `X` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `avg15` | `-` | `X` | `X` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` |
| з`она ▲` | `current (`по умолчанию) | `-` | `-` | `-` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `all` | `-` | `-` | `-` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` |
| p`roc.mem[<имя>,<пользователь>,<режим>,<cmdline><тип памяти>]` | `-` | `X` | `X` | `X` | `X3` | `-` | `X` | `X` | `-` | `X` | `X` |
| р`ежим ▲` | `sum (`по умолчанию) | `-` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `-` | `X` | `X` |
|  | `avg` | `-` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `-` | `X` | `X` |
|  | `max` | `-` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `-` | `X` | `X` |
|  | `min` | `-` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `-` | `X` | `X` |
| т`ип памяти ▲` | `-` | `X` | `X` | `X` | `X` | `-` | `X` | `-` | `-` | `-` | `-` |
| p`roc.num[<имя>,<пользователь>,<состояние>,<cmdline>,<зона>]` | `X` | `X` | `X` | `X` | `X3` | `X` | `X` | `X` | `-` | `X` | `X` |
| с`остояние ▲` | `all (`по умолчанию) | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` |
|  | `disk` | `-` | `X` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `X` | `X` |
|  | `sleep` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` |
|  | `zomb` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` |
|  | `run` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` |
|  | `trace` | `-` | `X` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `X` | `X` |
| c`mdline ▲` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` |
| з`она ▲` | `current (`по умолчанию) | `-` | `-` | `-` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `all` | `-` | `-` | `-` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` |
| s`ensor[устройство,сенсор,<режим>]` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `X` | `-` |
| s`ystem.boottime` | `-` | `X` | `X` | `X` | `X` | `-` | `-` | `-` | `X` | `X` | `X` |
| s`ystem.cpu.discovery` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| s`ystem.cpu.intr` | `-` | `X` | `X` | `X` | `X` | `-` | `X` | `-` | `-` | `X` | `X` |
| s`ystem.cpu.load[<cpu>,<режим>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| c`pu ▲` | `all (`по умолчанию) | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `percpu` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `X` |
| р`ежим ▲` | `avg1 (`по умолчанию) | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `avg5` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `avg15` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| s`ystem.cpu.num[<тип>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `X` |
| т`ип ▲` | `online (`по умолчанию) | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `X` |
|  | `max` | `-` | `X` | `X` | `X` | `X` | `-` | `-` | `-` | `X` | `-` | `-` |
| s`ystem.cpu.switches` | `-` | `X` | `X` | `X` | `X` | `-` | `X` | `-` | `-` | `X` | `X` |
| s`ystem.cpu.util[<cpu>,<тип>,<режим>,<логический_или_физический>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` |
| т`ип ▲` | `user (`по умолчанию) | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` |
|  | `nice` | `-` | `X` | `X` | `X` | `-` | `X` | `-` | `X` | `-` | `X` | `X` |
|  | `idle` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` |
|  | `system (`по умолчанию для Windows) | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` |
|  | `iowait` | `-` | `-` | `X` | `-` | `X` | `-` | `X` | `-` | `-` | `-` | `-` |
|  | `interrupt` | `-` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `X` | `-` |
|  | `softirq` | `-` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `steal` | `-` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `guest` | `-` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `guest_nice` | `-` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| р`ежим ▲` | `avg1 (`по умолчанию) | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` |
|  | `avg5` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `-` | `X` | `X` |
|  | `avg15` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `-` | `X` | `X` |
| л`огический_или_физический ▲` | `logical (`по умолчанию) | `-` | `-` | `-` | `-` | `-` | `-` | `X` | `-` | `-` | `-` | `-` |
|  | `physical` | `-` | `-` | `-` | `-` | `-` | `-` | `X` | `-` | `-` | `-` | `-` |
| s`ystem.Hostname[<тип>,<преобразование>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| s`ystem.hw.chassis[<информация>]` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| s`ystem.hw.cpu[<cpu>,<информация>]` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| s`ystem.hw.devices[<тип>]` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| s`ystem.hw.macaddr[<интерфейс>,<формат>]` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| s`ystem.localtime[<тип>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| т`ип ▲` | `utc (`по умолчанию) | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `local` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| s`ystem.run[команда,<режим>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| р`ежим ▲` | `wait (`по умолчанию) | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `nowait` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| s`ystem.stat[ресурс,<тип>]` | `-` | `-` | `-` | `-` | `-` | `-` | `X` | `-` | `-` | `-` | `-` |
| s`ystem.sw.arch` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| s`ystem.sw.os[<информация>]` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| s`ystem.sw.packages[<регулярное выражение>,<менеджер>,<формат>]` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| s`ystem.swap.in[<устройство>,<тип>](`указание устройства поддерживается только на Linux) | `-` | `X` | `X` | `-` | `X` | `-` | `-` | `-` | `-` | `X` | `-` |
| т`ип ▲(pages б`удет работать, только еслиустройство не указано) | `count (п`о умолчанию для всех, кроме Linux) | `-` | `X` | `X` | `-` | `X` | `-` | `-` | `-` | `-` | `X` | `-` |
|  | `sectors` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `pages (`по умолчанию для Linux) | `-` | `X` | `X` | `-` | `X` | `-` | `-` | `-` | `-` | `X` | `-` |
| s`ystem.swap.out[<устройство>,<тип>](`указание устройства поддерживается только на Linux) | `-` | `X` | `X` | `-` | `X` | `-` | `-` | `-` | `-` | `X` | `-` |
| т`ип ▲(pages б`удет работать, только еслиустройство не указано) | `count (`по умолчанию для всех, кроме Linux) | `-` | `X` | `X` | `-` | `X` | `-` | `-` | `-` | `-` | `X` | `-` |
|  | `sectors` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `pages (`по умолчанию для Linux) | `-` | `X` | `X` | `-` | `X` | `-` | `-` | `-` | `-` | `X` | `-` |
| s`ystem.swap.size[<устройство>,<тип>](у`казание устройства поддерживается только на FreeBSD, для других платформ должно быть пусто либо "`all")` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `-` | `X` | `-` |
| т`ип ▲` | `free (`по умолчанию) | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `-` | `X` | `-` |
|  | `total` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `-` | `X` | `-` |
|  | `used` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `-` | `X` | `-` |
|  | `pfree` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `-` | `X` | `-` |
|  | `pused` | `X6` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `-` | `X` | `-` |
| s`ystem.uname` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| s`ystem.uptime` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `?` | `X` | `X` | `X` |
| s`ystem.users.num` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| s`ystemd.unit.discovery` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| s`ystemd.unit.get` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| s`ystemd.unit.info` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| v`fs.dev.discovery` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| v`fs.dev.read[<устройство>,<тип>,<режим>]` | `-` | `X` | `X` | `X` | `X` | `-` | `X` | `-` | `-` | `X` | `-` |
| т`ип ▲` | `sectors` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `operations (`по умолчанию для OpenBSD, AIX) | `-` | `X` | `X` | `X` | `X` | `-` | `X` | `-` | `-` | `X` | `-` |
|  | `Bytes (`по умолчанию для Solaris) | `-` | `-` | `-` | `X` | `X` | `-` | `X` | `-` | `-` | `X` | `-` |
|  | `sps (`по умолчанию для Linux) | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `ops` | `-` | `X` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `bps (`по умолчанию для FreeBSD) | `-` | `-` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| р`ежим ▲(с`овместимо только стипами: `sps, ops, bps)` | `avg1 (`по умолчанию) | `-` | `X` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `avg5` | `-` | `X` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `avg15` | `-` | `X` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| v`fs.dev.write[<устройство>,<тип>,<режим>]` | `-` | `X` | `X` | `X` | `X` | `-` | `X` | `-` | `-` | `X` | `-` |
| т`ип ▲` | `sectors` | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `operations (п`о умолчанию для OpenBSD, AIX) | `-` | `X` | `X` | `X` | `X` | `-` | `X` | `-` | `-` | `X` | `-` |
|  | `Bytes (`по умолчанию для Solaris) | `-` | `-` | `-` | `X` | `X` | `-` | `X` | `-` | `-` | `X` | `-` |
|  | `sps (`по умолчанию для Linux) | `-` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `ops` | `-` | `X` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `bps (`по умолчанию для FreeBSD) | `-` | `-` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| р`ежим ▲(с`овместимо только стипами: `sps, ops, bps)` | `avg1 (`по умолчанию) | `-` | `X` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `avg5` | `-` | `X` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
|  | `avg15` | `-` | `X` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `-` | `-` |
| v`fs.dir.count[директория,<regex_вкл>,<regex_искл>,<типы_вкл>,<типы_искл>,<макс_глубина>,<мин_размер>,<макс_размер>,<мин_возраст>,<макс_возраст>,<regex_искл_директории>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| v`fs.dir.get[директория,<regex_вкл>,<regex_искл>,<типы_вкл>,<типы_искл>,<макс_глубина>,<мин_размер>,<макс_размер>,<мин_возраст>,<макс_возраст>,<regex_искл_директории>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| v`fs.dir.size[директория,<regex_вкл>,<regex_искл>,<режим>,<макс_глубина>,<regex_искл_директории>]` | `X` | `X` | `X` | `?` | `?` | `?` | `?` | `?` | `?` | `?` | `?` |
| v`fs.file.cksum[файл,<режим>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| v`fs.file.contents[файл,<кодировка>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| v`fs.file.exists[файл,<типы_вкл>,<типы_искл>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| v`fs.file.get[файл]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| v`fs.file.md5sum[файл]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| v`fs.file.owner[файл,<тип_владельца>,<тип_результата>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| v`fs.file.permissions[файл]` | `-` | `X` | `X` | `?` | `?` | `?` | `?` | `?` | `?` | `?` | `?` |
| v`fs.file.regexp[файл,регулярное выражение,<кодировка>,<вывод>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| v`fs.file.regmatch[файл,регулярное выражение,<кодировка>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| v`fs.file.size[файл,<режим>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| v`fs.file.time[файл,<режим>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| р`ежим ▲` | `modify (`по умолчанию) | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `access` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `change` | `X5` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| v`fs.fs.discovery` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `X` |
| v`fs.fs.get` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `-` | `X` | `X` | `X` |
| v`fs.fs.inode[fs,<режим>]` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| m`ode ▲` | `total (`по умолчанию) | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `free` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `used` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `pfree` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `pused` | `-` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| v`fs.fs.size[fs,<режим>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| р`ежим ▲` | `total (`по умолчанию) | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `free` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `used` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `pfree` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `pused` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| v`m.memory.size[<режим>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| р`ежим ▲` | `total (`по умолчанию) | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `active` | `-` | `-` | `-` | `X` | `-` | `X` | `-` | `-` | `X` | `X` | `X` |
|  | `anon` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `X` |
|  | `buffers` | `-` | `X` | `X` | `X` | `-` | `-` | `-` | `-` | `-` | `X` | `X` |
|  | `cached` | `X` | `X` | `X` | `X` | `-` | `-` | `X` | `-` | `-` | `X` | `X` |
|  | `exec` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `X` |
|  | `file` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `-` | `X` |
|  | `free` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `inactive` | `-` | `-` | `-` | `X` | `-` | `-` | `-` | `-` | `X` | `X` | `X` |
|  | `pinned` | `-` | `-` | `-` | `-` | `-` | `-` | `X` | `-` | `-` | `-` | `-` |
|  | `shared` | `-` | `X` | `-` | `X` | `-` | `-` | `-` | `-` | `-` | `X` | `X` |
|  | `wired` | `-` | `-` | `-` | `X` | `-` | `-` | `-` | `-` | `X` | `X` | `X` |
|  | `used` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `pused` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `available` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
|  | `pavailable` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| w`eb.page.get[хост,<путь>,<порт>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| w`eb.page.perf[хост,<путь>,<порт>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |
| w`eb.page.regexp[хост,<путь>,<порт>,регулярное выражение,<длина>,<вывод>]` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` | `X` |

Примечания–

```bash Terminal
1 Элементы данных net.if.in, net.if.out и net.if.total не предоставляют статистику по loopback-интерфейсам (например, lo0).
```

2 Значения перечисленных элементов данных не поддерживаются для loopback-интерфейсов на Solaris вплоть до Solaris 10 6/06 включительно, поскольку статистика байт, утилизации и ошибок не хранится и/или не отдается ядром. Если мониторят Подсистема через net-snmp, значения можно получить через старый код net-snmp от cmu-snmp, датированный 1997 годом, после ошибки чтения значений байтов из статистики интерфейса возвращается счетчик пакетов (который существует на loopback-интерфейсе), умноженный на произвольное значение 308. Это дает предположение, что средний размер пакета 308 октетов, которое является очень грубым приближением, поскольку ограничение MTU на системах Solaris для loopback-интерфейсов составляет 8892 байта. Эти значения не должны рассматриваться, как корректные и даже близкие к точным. Они предположительные, но следует учесть, что net-snmp возвращает значения этих полей.

```bash Terminal
3 Командная строка на Solaris, получаемая с /proc/pid/psinfo, ограничена 80 байтами и содержит командную строку, которая была на момент запуска процесса.
```

4 Не поддерживается для Windows Event Log.

5 На Windows XP vfs.file.time[файл,change] может быть равным vfs.file.time[файл,access].

6 Поддерживается только Агентом-2; не поддерживается Агентом-1.

7 Поддерживается только Агентом-2 на 64-битных Windows; не поддерживается Агентом-1.

# Б.8.2 Значения элементов данных

В этом разделе представлены некоторые подробности относительно элемента данных vm.memory.size[<режим>] Агента.

В этом элементе данных разрешены следующие параметры:

- active – память, используемая в данный момент или бывшая в использовании совсем недавно, и поэтому еще находится в RAM;
- anon – память, не связанная с файлами (повторное чтение из них невозможно);
- available – доступная память, вычисляется по-разному в зависимости от платформы (таблица 36);
- `buffers `– кэш для таких вещей, как метаданные файловой системы;
- `cached `– кэш для различных вещей;
- `exec `– исполняемый код, в основном из (программ) файлов;
- `file `– кэш содержимого недавно использованных файлов;
- `free `– память, которая доступна без каких-либо проблем любому объекту, запрашивающему память;
- `inactive `– память, помеченная как неиспользуемая;
- `pavailable `– `available-`память в процентах по отношению к `total (`рассчитывается как `available/total`*100);
- `pinned `– то же, что и `wired;`
- `pused `– `used-`память в процентах по отношению к `total (`рассчитывается как `used/total`*100);
- `shared `– память, которая может быть доступна сразу нескольким процессам;
- `slab `– общий объем памяти, которая используется ядром для кэширования структур данных для собственного использования;
- `total `– общий объем доступной физической памяти;
- `used `– используемая память, вычисляется по-разному в зависимости от платформы;
- `wired `– память, помеченная всегда оставаться в RAM. Она не может быть перемещена на диск.

Некоторые из этих параметров работают только для конкретных платформ.

Вычисления available и used в зависимости от платформы приведены в таблице 36.

1. Вычисления по платформам

| Платформа | `available` | `used` |
| --- | --- | --- |
| A`IX` | `free + cached` | `р`еальное использование памяти |
| F`reeBSD` | `inactive + cached + free` | `active + wired + cached` |
| H`P UX` | `free` | `total – free` |
| L`inux<3.14` | `free + buffers + cached` | `total – free` |
| L`inux 3.14+`(также перенесено для 3.10 на RHEL 7) | `/proc/meminfo,` см. описание "`MemAvailable" в`  ядра Linux.Следует обратить внимание, что "`free + buffers + cached" `больше не равно "`available", `так как не весь кэш страницы может быть освобожден и в расчетах используется минимальный объем свободной памяти, зарезервированной системой (low watermark). | total – free |
| N`etBSD` | `inactive + execpages + file + free` | `total – free` |
| O`penBSD` | `inactive + free + cached` | `active + wired` |
| O`SX` | `inactive + free` | `active + wired` |
| S`olaris` | `free` | `total – free` |
| W`in32` | `free` | `total – free` |

> Примечание – Сумма vm.memory.size[used] и vm.memory.size[available] не обязательно равна общему количеству памяти.

Например, для FreeBSD:

- активная, неактивная, `wired,` кэшируемая памяти считаются использованными, так как содержат некоторую полезную информацию;
- неактивная, кэшируемая, свободная памяти считаются доступными, так как такая память может быть незамедлительно освобождена процессу, который запросил больше памяти.

Таким образом, неактивная память помечается и как занятая, так и как свободная одновременно. Из-за этого элемент данных vm.memory.size[used] используется исключительно в информационных целях, а элемент данных vm.memory.size[available] предназначен для использования в триггерах.

# Б.8.3 Динамика изменений

Этот раздел подробно описывает пассивные и активные проверки, которые выполняются Агентом.

Для взаимодействия с Агентом Подсистема использует протокол на основе JSON.