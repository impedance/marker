# üìä –û—Ç—á–µ—Ç: –ê–Ω–∞–ª–∏–∑ —Å—Ç–∏–ª–µ–π —Ä–∏—Å—É–Ω–∫–æ–≤ –≤ DOCX –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö

## üîç –û–±–∑–æ—Ä –∞–Ω–∞–ª–∏–∑–∞

–ü—Ä–æ–≤–µ–¥–µ–Ω –∞–Ω–∞–ª–∏–∑ 6 DOCX –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –Ω–∞–ª–∏—á–∏—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç–∏–ª–µ–π `ROSA_–†–∏—Å—É–Ω–æ–∫_–ù–æ–º–µ—Ä` –∏ `ROSA_–†–∏—Å—É–Ω–æ–∫_–¢–µ–∫—Å—Ç`.

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| **–í—Å–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** | 6 |
| **–î–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å–æ —Å—Ç–∏–ª—è–º–∏ —Ä–∏—Å—É–Ω–∫–æ–≤** | 6 (100%) |
| **–î–æ–∫—É–º–µ–Ω—Ç–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö —Å—Ç–∏–ª–∏** | 6 (100%) |
| **–í—Å–µ–≥–æ –ø–æ–¥–ø–∏—Å–µ–π —Ä–∏—Å—É–Ω–∫–æ–≤ –Ω–∞–π–¥–µ–Ω–æ** | 1,666 |

## üìÑ –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º

| –î–æ–∫—É–º–µ–Ω—Ç | –ü–æ–¥–ø–∏—Å–µ–π | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∏–ª—å |
|----------|----------|------------------|
| `rrm-admin.docx` | 767 | ‚úÖ |
| `–†–û–°–ê_–ú–µ–Ω–µ–¥–∂–µ—Ä_—Ä–µ—Å—É—Ä—Å–æ–≤.docx` | 767 | ‚úÖ |
| `cu-admin-install.docx` | 61 | ‚úÖ |
| `–†–û–°–ê_–¶–µ–Ω—Ç—Ä_–£–ø—Ä–∞–≤–ª–µ–Ω–∏—è_...` | 61 | ‚úÖ |
| `dev-portal-user.docx` | 10 | ‚úÖ |
| `dev-portal-admin.docx` | 0 | ‚úÖ |

## üé® –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏

### ‚úÖ –°—Ç–∏–ª—å "ROSA_–†–∏—Å—É–Ω–æ–∫_–ù–æ–º–µ—Ä"
**–°—Ç–∞—Ç—É—Å:** –ù–∞–π–¥–µ–Ω –≤–æ –≤—Å–µ—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- **ID —Å—Ç–∏–ª—è:** `ROSA`, `ROSA5`, `ROSA7`, `ROSAf8` (—Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º)
- **–¢–∏–ø:** `paragraph` (–ø–∞—Ä–∞–≥—Ä–∞—Ñ–Ω—ã–π) –∏ `character` (—Å–∏–º–≤–æ–ª—å–Ω—ã–π)
- **–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ:** `center` (—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
- **–®—Ä–∏—Ñ—Ç:** Roboto
- **–†–∞–∑–º–µ—Ä:** 24pt (–≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö)

### ‚ùå –°—Ç–∏–ª—å "ROSA_–†–∏—Å—É–Ω–æ–∫_–¢–µ–∫—Å—Ç" 
**–°—Ç–∞—Ç—É—Å:** –ù–ï –ù–ê–ô–î–ï–ù –≤ —è–≤–Ω–æ–º –≤–∏–¥–µ

## üîß XML –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–∏–ª–µ–π

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∏–ª—è –≤ `word/styles.xml`:

```xml
<w:style w:type="paragraph" w:styleId="ROSA5">
    <w:name w:val="ROSA_–†–∏—Å—É–Ω–æ–∫_–ù–æ–º–µ—Ä"/>
    <w:pPr>
        <w:jc w:val="center"/>
    </w:pPr>
    <w:rPr>
        <w:rFonts w:ascii="Roboto"/>
        <w:sz w:val="24"/>
    </w:rPr>
</w:style>
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ `word/document.xml`:

```xml
<w:p>
    <w:pPr>
        <w:pStyle w:val="ROSA5"/>
    </w:pPr>
    <w:r>
        <w:t>–†–∏—Å—É–Ω–æ–∫ 123</w:t>
    </w:r>
</w:p>
```

## üõ†Ô∏è –ê–ª–≥–æ—Ä–∏—Ç–º –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### 1. –ü–æ–∏—Å–∫ —Å—Ç–∏–ª–µ–π –≤ `word/styles.xml`:

```python
def find_figure_styles(styles_xml_content):
    """–ù–∞—Ö–æ–¥–∏—Ç —Å—Ç–∏–ª–∏ —Ä–∏—Å—É–Ω–∫–æ–≤ –≤ styles.xml"""
    root = ET.fromstring(styles_xml_content)
    namespaces = {'w': 'http://schemas.openxmlformats.org/wordprocessingml/2006/main'}
    
    figure_styles = {}
    
    for style in root.findall('.//w:style', namespaces):
        style_id = style.get(f'{{{namespaces["w"]}}}styleId', '')
        name_elem = style.find('.//w:name', namespaces)
        
        if name_elem is not None:
            style_name = name_elem.get(f'{{{namespaces["w"]}}}val', '')
            
            # –ü–æ–∏—Å–∫ —Å—Ç–∏–ª–µ–π —Ä–∏—Å—É–Ω–∫–æ–≤
            if 'ROSA' in style_id and '—Ä–∏—Å—É–Ω–æ–∫' in style_name.lower():
                figure_styles[style_id] = {
                    'name': style_name,
                    'type': style.get(f'{{{namespaces["w"]}}}type', ''),
                    'formatting': extract_formatting(style, namespaces)
                }
    
    return figure_styles
```

### 2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```python
def extract_formatting(style_elem, namespaces):
    """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–∏–ª—è"""
    formatting = {}
    
    # –°–≤–æ–π—Å—Ç–≤–∞ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞
    pPr = style_elem.find('.//w:pPr', namespaces)
    if pPr is not None:
        # –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ
        jc = pPr.find('.//w:jc', namespaces)
        if jc is not None:
            formatting['alignment'] = jc.get(f'{{{namespaces["w"]}}}val', '')
    
    # –°–≤–æ–π—Å—Ç–≤–∞ —Ç–µ–∫—Å—Ç–∞
    rPr = style_elem.find('.//w:rPr', namespaces)
    if rPr is not None:
        # –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞
        sz = rPr.find('.//w:sz', namespaces)
        if sz is not None:
            formatting['font_size'] = sz.get(f'{{{namespaces["w"]}}}val', '')
        
        # –®—Ä–∏—Ñ—Ç
        rFonts = rPr.find('.//w:rFonts', namespaces)
        if rFonts is not None:
            formatting['font_family'] = rFonts.get(f'{{{namespaces["w"]}}}ascii', '')
    
    return formatting
```

### 3. –ü–æ–∏—Å–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ `word/document.xml`:

```python
def find_figure_paragraphs(document_xml_content, figure_style_ids):
    """–ù–∞—Ö–æ–¥–∏—Ç –ø–∞—Ä–∞–≥—Ä–∞—Ñ—ã —Å –ø–æ–¥–ø–∏—Å—è–º–∏ —Ä–∏—Å—É–Ω–∫–æ–≤"""
    root = ET.fromstring(document_xml_content)
    namespaces = {'w': 'http://schemas.openxmlformats.org/wordprocessingml/2006/main'}
    
    figure_paragraphs = []
    
    for paragraph in root.findall('.//w:p', namespaces):
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∏–ª—å –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞
        pStyle = paragraph.find('.//w:pStyle', namespaces)
        if pStyle is not None:
            style_val = pStyle.get(f'{{{namespaces["w"]}}}val', '')
            
            if style_val in figure_style_ids:
                # –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–µ–∫—Å—Ç
                text_runs = []
                for run in paragraph.findall('.//w:r', namespaces):
                    for t in run.findall('.//w:t', namespaces):
                        if t.text:
                            text_runs.append(t.text)
                
                paragraph_text = ''.join(text_runs).strip()
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ä–∏—Å—É–Ω–∫–æ–≤
                drawings = paragraph.findall('.//w:drawing', namespaces)
                
                figure_paragraphs.append({
                    'style': style_val,
                    'text': paragraph_text,
                    'has_drawings': len(drawings) > 0,
                    'drawings_count': len(drawings)
                })
    
    return figure_paragraphs
```

## üìã –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø–æ–¥–ø–∏—Å–µ–π

**–û—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ—Ä–º–∞—Ç:** `–†–∏—Å—É–Ω–æ–∫ [—á–∏—Å–ª–æ]`

**–ü—Ä–∏–º–µ—Ä—ã:**
- `–†–∏—Å—É–Ω–æ–∫ 1`, `–†–∏—Å—É–Ω–æ–∫ 2`, ..., `–†–∏—Å—É–Ω–æ–∫ 999`
- –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ ID: `–†–∏—Å—É–Ω–æ–∫ 1524204473`, `–†–∏—Å—É–Ω–æ–∫ 1577920560`

**–†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è:**
```python
figure_pattern = r'–†–∏—Å—É–Ω–æ–∫\s+(\d+)'
```

## üéØ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –¥–æ—Å—Ç—É–ø–Ω–∞—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è

### ‚úÖ –ß—Ç–æ –ú–û–ñ–ù–û –∏–∑–≤–ª–µ—á—å:
1. **–ù–æ–º–µ—Ä —Ä–∏—Å—É–Ω–∫–∞** - –∏–∑ —Ç–µ–∫—Å—Ç–∞ –ø–æ–¥–ø–∏—Å–∏
2. **–°—Ç–∏–ª—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** - —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ, —à—Ä–∏—Ñ—Ç, —Ä–∞–∑–º–µ—Ä
3. **–°–≤—è–∑—å —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º** - —á–µ—Ä–µ–∑ —ç–ª–µ–º–µ–Ω—Ç—ã `w:drawing`
4. **–ü–æ–∑–∏—Ü–∏—é –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ** - –ø–æ—Ä—è–¥–æ–∫ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤

### ‚ö†Ô∏è –ß—Ç–æ –û–¢–°–£–¢–°–¢–í–£–ï–¢:
1. **–û—Ç–¥–µ–ª—å–Ω—ã–π —Å—Ç–∏–ª—å –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è** - –Ω–µ—Ç `ROSA_–†–∏—Å—É–Ω–æ–∫_–¢–µ–∫—Å—Ç`
2. **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ** - —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
3. **–°–≤—è–∑—å –Ω–æ–º–µ—Ä–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º** - –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –í `core/adapters/docx_parser.py`:

```python
class DOCXParser:
    def __init__(self):
        self.figure_styles = {}
    
    def parse_styles(self, styles_xml):
        """–ü–∞—Ä—Å–∏—Ç —Å—Ç–∏–ª–∏ —Ä–∏—Å—É–Ω–∫–æ–≤ –∏–∑ styles.xml"""
        self.figure_styles = self.find_figure_styles(styles_xml)
    
    def parse_paragraph(self, paragraph_elem):
        """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞, –≤–∫–ª—é—á–∞—è –ø–æ–¥–ø–∏—Å–∏ —Ä–∏—Å—É–Ω–∫–æ–≤"""
        style_id = self.get_paragraph_style(paragraph_elem)
        
        if style_id in self.figure_styles:
            text = self.extract_paragraph_text(paragraph_elem)
            figure_match = re.search(r'–†–∏—Å—É–Ω–æ–∫\s+(\d+)', text)
            
            if figure_match:
                return {
                    'type': 'figure_caption',
                    'number': int(figure_match.group(1)),
                    'text': text,
                    'style': self.figure_styles[style_id]
                }
        
        return self.parse_regular_paragraph(paragraph_elem)
```

### –í `core/render/markdown_renderer.py`:

```python
def render_figure_caption(self, caption_data):
    """–†–µ–Ω–¥–µ—Ä–∏—Ç –ø–æ–¥–ø–∏—Å—å —Ä–∏—Å—É–Ω–∫–∞ –≤ Markdown"""
    number = caption_data['number']
    text = caption_data['text']
    
    # –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–¥–ø–∏—Å—å —Ä–∏—Å—É–Ω–∫–∞
    return f"\n<div align=\"center\">\n\n**{text}**\n\n</div>\n\n"
```

## üöÄ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–°—Ç–∏–ª–∏ —Ä–∏—Å—É–Ω–∫–æ–≤ —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–µ–π —Ä–∏—Å—É–Ω–∫–æ–≤
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Å—ã–ª–æ–∫  
- ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–ø–∏—Å–∞–Ω–∏–π

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–∞** —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –¥–æ—Ä–∞–±–æ—Ç–∫–∞–º–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ XML-–ø–∞—Ä—Å–µ—Ä–∞.

---

**–§–∞–π–ª—ã –∞–Ω–∞–ª–∏–∑–∞:**
- `figure_styles_analysis_report.md` - –¥–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç
- `figure_analysis_report.json` - –ø–æ–¥—Ä–æ–±–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
- `analyze_figure_styles.py` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- `figure_analysis_summary.py` - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä