## 4 Настройка параметров

### 4.1 Параметры пользователя

Настройка параметров интерфейса конкретного пользователя производится в меню панели навигации "Параметры  Мои параметры" (рисунок 9). Параметры хранятся и применяются в Комплексе для каждого пользователя индивидуально.

Это меню доступно всем пользователям Комплекса. Настройки в этом меню управляют отображением элементов пользовательского интерфейса, временными профилями и тегами для отдельного пользователя, вошедшего в Комплекс.

Во вкладке "Визуальный" выбором из раскрывающихся списков настраиваются параметры оформления системы для удобного восприятия при работе:

в секции "Общее":

"Сравнить" – "Расширенное представление" или "Сжатое представление";

"Режим сравнения" – "Подробнее" (для детального просмотра) или "Существует" (для просмотра только атрибутов, имеющих какое-либо значение);

"Дрейф" – "Расширенное представление" или "Сжатое представление". Конфигурация ВМ может со временем измениться. Дрейф – это сравнение ВМ с самой собой в разные моменты времени. ВМ нуждается в анализе как минимум дважды, чтобы собрать эту информацию;

"Режим дрейфа" – "Подробнее" или "Существует";

"Экран сводки" – "Панель мониторинга" или "Текстовый режим";

Вкладка "Визуальный"

в секции "Элементов по умолчанию на страницу":

"Представление списка" – количество элементов списка на одну страницу;

"Отчеты" – количество элементов отчета на одну страницу;

в секции "Разное":

"Начальная страница" – вид рабочей области при входе в Комплекс;

"Часовой пояс" – локальное время Комплекса;

"Локаль" – язык интерфейса;

Во вкладке "Фильтры по умолчанию" выбором из раскрывающихся списков можно настроить фильтры по умолчанию, отображаемые для хостов, ВМ, шаблонов и др. (рисунок 10). Эти настройки доступны всем пользователям. В фильтрах элементы, отмеченные флажками, будут по умолчанию видимыми. Чтобы полностью развернуть иерархию фильтров следует нажать пиктограмму ; свернуть – пиктограмму .

Вкладка "Фильтры по умолчанию"

Параметры во вкладке "Профили времени" позволяют указать часы, для которых отображаются данные при просмотре экранов мощности и загруженности. Временные профили также используются для настройки отчетов о производительности и прогнозировании.

Создание профиля времени осуществляется выполнением следующих действий на той же вкладке:

нажать кнопку Конфигурация, затем –  Добавить новый профиль времени;

на экране появится интерфейс добавления в Комплекс нового профиля времени. Интерфейс содержит параметры профиля времени, распределенные по секциям для последовательной настройки (рисунок 11):

Добавление нового профиля времени

в поле "Описание" ввести наименование профиля;

из раскрывшегося списка "Область применения" выбрать "Текущий пользователь" или "Все пользователи";

в секции "Дни" отметить флажками "Выбрать все дни" или необходимые дни недели;

в секции "Часы" выделить "Выбрать все часы" или необходимые часы до полудня и после полудня;

из раскрывающегося списка выбрать требуемый "Часовой пояс";

нажать кнопку Сохранить.

Для работы с существующими профилями времени можно выбрать требуемый профиль, нажать кнопку Конфигурация и выбрать одно из действий в появившемся меню:

Редактировать выбранный профиль времени – внести необходимые изменения в значения параметров профиля;

Скопировать выбранный профиль времени – указать уникальное описание для скопированного профиля "Описание" и при необходимости внести изменения в значения других параметров профиля;

Удалить выбранные профили времени – удалить выбранные флажками из списка профили, подтвердив действие нажатием кнопки Да в появившемся модальном окне.

При редактировании и копировании нужно нажать кнопку Сохранить / Добавить для сохранения изменений или Отмена – для отмены редактирования профиля.

### 4.2 Параметры приложения

Раздел меню панели навигации "Параметры  Параметры приложения" позволяет настроить глобальную конфигурацию РОСА Менеджер ресурсов, просматривать диагностическую информацию и просматривать аналитику на серверах Комплекса. В меню отображается конфигурация Комплекса на уровнях компании, зоны и сервера (рисунок 12).

Меню конфигурации Комплекса

В иерархическом меню в левой панели присутствуют три основных раздела:

Параметры – позволяет настроить глобальные параметры инфраструктуры Комплекса; для этих объектов инфраструктуры также можно создавать профили анализа и расписания;

Управление доступом – содержит параметры настройки пользователей, групп, ролей и арендаторов;

Диагностика – отображает состояния серверов и их роли, а также предоставляет доступ к журналам.

#### 0.0.1 Параметры

В аккордеоне "Параметры" представлены в иерархическом виде глобальные параметры для настройки инфраструктуры Комплекса. На верхнем уровне настраиваются параметры региона, включая сбор данных по мощностям и загруженности, теги и конфигурацию. Нажав на аккордеон "Параметры", можно настроить профили анализа, зоны и расписания.

##### 4.2.0.1 Регион

Регион используется для централизации данных, собранных из общедоступных и частных сред виртуализации. Регионы особенно полезны, когда необходимо управлять несколькими географическими местоположениями, поскольку они позволяют осуществлять весь сбор данных в каждом конкретном месте и избегать трафика сбора данных по медленным каналам между сетями.

Примечание – При использовании нескольких регионов, каждый из которых имеет свой уникальный идентификатор, можно создать главный регион для централизации данных всех дочерних регионов в единой главной базе данных. Родительский и дочерние регионы представляет собой отношение "один ко многим".

Регион может содержать несколько зон, которые, в свою очередь, содержат устройства. Зоны используются для дальнейшего разделения сетевого трафика, а также для включения конфигураций аварийного переключения. Каждое устройство можно настроить для ряда специализированных ролей сервера. Эти роли ограничены зоной, содержащей устройство, на котором они выполняются.

В зоне может работать только один тип аварийного переключения для каждой роли сервера. Если несколько устройств имеют одну и ту же роль аварийного переключения, дополнительные используются в качестве резервных копий, которые активируются только в случае сбоя основного устройства. Роли сервера без аварийного переключения могут одновременно работать на нескольких устройствах в зоне, поэтому ресурсы можно регулировать в соответствии с рабочей нагрузкой, за которую отвечают эти роли.

Параметры региона настраиваются в каталоге "Регион РОСА Менеджер ресурсов". Для просмотра и редактирования необходимо выбрать "Регион РОСА Менеджер ресурсов" и выполнить следующие действия:

во вкладке "Подробнее" (рисунок 13):

нажать на наименовании региона и редактировать описание, затем нажать кнопку Сохранить;

при нажатии на разделы "Профили анализа", "Зоны" и "Расписания" осуществляется переход к соответствующим разделам иерархического меню данного региона;

Примечания – В круглых скобках каждого раздела указано количество экземпляров конфигураций.

Редактирование региона

во вкладке "Сбор данных по мощностям и загруженности" (рисунок 14):

в секции "Кластеры" определить, что данные собираются со всех кластеров, поставив соответствующий переключатель в положение "Да"; при переключении в положении "Нет" указать конкретные кластеры, по которым необходим сбор данных;

в секции "Хранилища данных" определить, что данные собираются со всех хранилищ данных, поставив соответствующий переключатель в положение "Да"; при переключении в положении "Нет" указать конкретные хранилища данных, по которым необходим сбор данных;

Сбор данных

во вкладке "Теги" (рисунок 15):

в подвкладке "Категории" просматривать список категорий, добавлять теги (нажав на кнопку Добавить категорию), редактировать (нажав на имя категории) и удалять (нажав на кнопку Удалить в строке) категории тегов, включая следующие поля:

"Имя" – ввести наименование категории;

"Описание" – ввести краткое описание категории;

"Показать в интерфейсе" – включить для показа в интерфейсе Комплекса;

"Одиночное значение" – включить, если категория имеет одиночное значение;

"Собрать данные по ёмкости и потреблению по тегам" – включить, если необходимо собирать данные по этой категории;

в подвкладке "Теги" просматривать список тегов, добавлять (нажав на кнопку Добавить тег), редактировать (нажав на имя тега) и удалять (нажав на кнопку Удалить в строке) теги в составе категорий, включая следующие поля:

"Имя" – ввести наименование категории;

"Описание" – ввести наименование категории;

в подвкладке "Импорт тегов" импортировать назначение тегов ВМ из других Комплексов;

в подвкладке "Импорт переменных" импортировать значения настраиваемых переменных для ВМ или хоста;

в подвкладке "Теги отображения" осуществлять привязку объекта ресурса и метки к категории тега для отображения, просматривать, добавлять (нажав на кнопку Добавить тег отображения), редактировать (нажав на имя) и удалять (нажав на кнопку Удалить в строке) теги отображения в составе категорий, включая следующие поля:

"Объект" – выбрать из раскрывающегося списка вид объекта;

"Метка" – ввести метку;

"Категория тегов" – ввести категорию тега, на которую будет создано отображение.

Теги

во вкладке "Репликация" (рисунок 16):

настроить тип репликации сервера "Global (Глобальный)" (для репликации данных с подчиненных серверов) или "Remote (Удаленный)" (для репликации данных на главный сервер);

для типа "Global (Глобальный)" должна быть добавлена как минимум одна подписка на подчиненный сервер нажатием кнопки Добавить подписку;

при добавлении подписки ввести в соответствующие поля: имя БД, имя хоста, имя пользователя, пароль, номер порта;

нажать для сохранения кнопку Принять в столбце действий пописки;

действиями Проверить действительность или Отказаться под пиктограммой  проверить возможность подключения и репликации с подчиненным сервером или отказаться от подписки соответственно.

Репликация

во вкладке "Меню справки" (рисунок 17) настроить пункты меню "Документация", "РОСА", "Сведения" в разделе меню навигации "Параметры" по действиям при их выборе: переход по URL и открытие окна ("Текущее окно", "Новое окно" или "Сведения о модале");

Меню справки

во вкладке "Дополнительно" редактировать конфигурационный файл сервера Комплекса для более тонкой настройки.

##### 4.2.0.2 Зоны

Зоны позволяют организовать инфраструктуру Комплекса таким образом, чтобы настроить аварийное переключение и изолировать трафик. Поставщик, обнаруженный сервером в определенной зоне, контролируется и управляется в этой зоне. Все задания, такие как анализ SmartState или управление питанием ВМ, отправленные сервером в определенной зоне, могут обрабатываться любым устройством Комплекса, назначенным в эту же зону.

Зоны можно создавать на основе инфраструктуры компании. Зоны можно создавать на основе географического положения, сетевого расположения или функциональности. При первом запуске новый сервер помещается в зону по умолчанию.

Настройка зон в Комплексе осуществляется в меню панели навигации "Параметры  Параметры приложения" в каталоге "Зоны" с привязкой зон к серверам Комплекса (рисунок 18).

Зоны

Создание новой зоны осуществляется выполнением следующих действий:

выбрать каталог "Зоны";

нажать кнопку Конфигурация и выбрать Добавить новую зону;

в открывшейся рабочей области "Добавление новой зоны" ввести:

во вкладке "Зона" в секцию "Сведения о зоне" в соответствующие поля имя зоны, ее описание и "IP сервера SmartProxy"; в секции "Параметры" – из раскрывающегося списка выбрать максимально число активных сканов ВМ (по умолчанию – "Без ограничений");

во вкладке "Схожесть SmartProxy" назначить хосты и хранилища данных встроенным серверам с ролью SmartProxy (при их наличии);

во вкладке "Дополнительно" редактировать конфигурационный файл зоны для более тонкой настройки

нажать кнопку Добавить.

Для редактирования зоны в иерархическом меню выбрать необходимую зону, нажать кнопку Конфигурация, выбрать Редактировать эту зону, изменить параметры зоны и нажать кнопку Сохранить.

Для удаления зоны в иерархическом меню выбрать необходимую зону, нажать кнопку Конфигурация, выбрать Удалить эту зону и нажать кнопку Да в модальном окне для подтверждения.

##### 4.2.0.3 Серверы

Настройки сервера позволяют контролировать работу каждого сервера Комплекса, включая аутентификацию, ведение журналов и электронную почту. Если в инфраструктуре есть несколько серверов, которые подчиняются одной центральной БД, можно редактировать некоторые из этих параметров из консоли, указав сервер, подлежащий изменению.

Примечание – Параметры выбора сервера доступны только в том случае, если есть несколько серверов, совместно использующих одну БД.

Для настройки серверов требуется выполнить следующие действия:

перейти в раздел меню "Параметры  Параметры приложения";

развернуть аккордеон "Регион РОСА Менеджер ресурсов  Зоны" и выбрать необходимый сервер;

определить настройки сервера во вкладках:

Примечание – Для доступа ко всем вкладкам следует прокрутить окно рабочей области вниз.

"Сервер" (рисунки 19, 20 и 21):

в секции "Основные сведения" в соответствующие поля вести название компании, название комплекса (сервера), сделать привязку к "Зоне", выбрать из раскрывающегося списка "Часовой пояс комплекса" и "Локаль по умолчанию";

вкладка "Сервер" (часть 1)

вкладка "Сервер" (часть 2)

вкладка "Сервер" (часть 3)

в секции "Управление сервером" поставить переключатель для определения ролей сервера (таблица 2);

Роли сервера

в секции "Сервер исходящей почты SMTP" в соответствующие поля вести/выбрать данные о почтовом сервере для рассылки оповещений: имя хоста, номер порта, имя домена, признак использования протокола TLS, режим проверки SSL, способ аутентификации, имя и пароль пользователя, почтовый адрес отправителя, тестовый почтовый адрес с возможностью проверки по кнопке Подтвердить;

в секции "Веб-службы" выбрать режим работы веб-службы и способ обеспечения безопасности;

в секции "Журналирование" выбрать "Уровень журналирования": критический, ошибка, предупреждения, сведения или отладка;

в секции "Настраиваемый URL поддержки" ввести адрес URL и его описание;

"Аутентификация" (рисунок 22):

в секции "Аутентификация" определить время истечения подключения пользователя при бездействии в Комплексе; выбрать режим: БД, Amazon или Внешняя (httpd);

Вкладка "Аутентификация"

"Рабоч. процессы" (рисунок 23):

выбрать мощности сервера – "Количество" (процессоров) и "Память: порог памяти" (в Гб) – для обеспечения каждого из процессов по соответствующим секциям: "Общие рабоч.процессы", "Приоритетные рабоч.процессы", "Сборщики данных по мощностям и загруженности", "Обработчики данных по мощностям и загруженности", "Монитор событий", "Обновить сведения", "ВМ: сборщики анализов", "Рабоч. процесс UI", "Рабоч. процессы удаленной консоли", "Отчитывающиеся рабочие процессы", "Рабоч. процессы веб-службы";

Вкладка "Рабочие процессы"

"Настраиваемые логотипы" (рисунок 24):

выбрать логотипы для оформления веб-интерфейса Комплекса – "Настраиваемый логотип (показывается в правом верхнем углу на всех экранах)", "Фоновое настраиваемое изображение входа в систему и экрана "О программе", "Настраиваемое изображение бренда (показывается в левом верхнем углу на всех экранах и над панелью входа в систему)", "Настраиваемый Favicon" нажатием кнопки Выбрать файл, заданием файла рисунка и нажатием кнопки Отправить; ввести в поле "Настраиваемый текст панели входа в систему" необходимый текст и подтвердить его использование переключателем "Использовать настраиваемый текст входа в систему";

Вкладка "Настраиваемые логотипы"

"Дополнительно":

редактировать конфигурационный файл сервера для более тонкой настройки;

нажать кнопку Сохранить.

##### 4.2.0.4 Профили анализа

В Комплексе можно создать профиль анализа, воспользовавшись образцами профилей: "host default", "host sample" и "sample". В этом разделе можно скопировать образец профиля или создать новый.

Для создания нового профиля выполняют следующие действия:

в меню панели навигации выбрать пункт "Параметры → Параметры приложения";

развернуть аккордеон "Регион" и выбрать папку "Профили анализа"; в рабочей области появится список профилей;

нажать кнопку Конфигурация, затем –  Добавить профиль анализа хоста или  Добавить профиль анализа ВМ (рисунок 25);

Добавление нового профиля анализа

задать необходимые данные в параметры профилей анализа в зависимости от добавляемого профиля:

для хоста – в секции "Основные сведения" в соответствующие поля имя и описание профиля; в секции "Запись файла" во вкладке "Файл" ввести имя файла, поставить флажок о сборе содержимого и нажать кнопку Сохранить; в секции "Запись файла" во вкладке "Журнал событий" ввести имя файла, сообщение фильтра, уровень, источник, количество дней и нажать кнопку Сохранить;

для ВМ – в секции "Основные сведения" в соответствующие поля имя и описание профиля; во вкладке "Категории" флажками отметить необходимый набор категорий: "Система", "Службы", "Программное обеспечение", "Учетные записи пользователей", "ВМ: конфигурация"; во вкладке "Файл" ввести имя файла, поставить флажок о сборе содержимого и нажать кнопку Сохранить; во вкладке "Реестр" ввести в куст реестра HKLM "Ключ реестра" и "Значение реестра" и нажать кнопку Сохранить; во вкладке "Журнал событий" ввести имя файла, сообщение фильтра, уровень, источник, количество дней и нажать кнопку Сохранить;

нажать кнопку Добавить.

Для работы с существующими профилями анализа следует выбрать требуемый профиль, нажать кнопку Конфигурация и выбрать одно из действий в появившемся меню:

Редактировать выбранный профиль анализа – внести необходимые изменения в значения параметров профиля;

Копировать выбранные профили анализа – указать уникальное имя для скопированного профиля и при необходимости внести изменения в значения других параметров профиля;

Удалить выбранные профили времени – удалить выбранные флажками из списка профили, подтвердив действие нажатием кнопки Да в появившемся модальном окне;

При редактировании и копировании нужно нажать кнопку Сохранить для сохранения изменений или Отмена – для отмены редактирования профиля.

##### 4.2.0.5 Расписания

В настройках параметров Комплекса можно запланировать с помощью механизма расписаний анализ ВМ, хостов, кластеров и хранилищ данных, чтобы поддерживать актуальность информации об объектах инфраструктуры. В зависимости от того, какой ресурс требуется проанализировать, можно выбрать тип объекта анализа, количество объектов (один или все), провести проверки соответствия и резервное копирование базы данных.

Для создания нового расписания выполняют следующие действия:

в меню панели навигации выбрать пункт "Параметры → Параметры приложения";

развернуть аккордеон "Регион" и выбрать папку "Расписания"; в рабочей области появится список расписаний;

нажать кнопку Конфигурация, затем –  Добавить новое расписание (рисунок 26);

в рабочей области "Добавление нового расписания" задать значение параметров:

"Имя" – ввести наименование расписания;

"Описание" – ввести краткое описание расписания;

"Активно" – отметить, если расписание должно быть выполнено при наступлении времени начала;

"Действие" – выбрать действия над объектами анализа;

"Фильтр" – выбрать фильтр для одной ВМ, для всех ВМ или "Глобальный фильтр";

"Элемент фильтра" – выбрать из списка, контекстно-зависимого от выбора по "Фильтру";

"Запустить" – выбрать типа запуска: один раз или с периодичностью;

"Каждый" – выбрать периода при задании периодичности на предыдущем шаге;

"Часовой пояс" – выбрать часовой пояс;

"Дата начала" – выбрать или ввести дату начала действия расписания;

"Время начала" – ввести время начала действия расписания.

нажать кнопку Сохранить.

Добавление нового расписания

Для работы с существующими расписаниями следует выбрать требуемые расписания, нажать кнопку Конфигурация и выбрать одно из действий в появившемся меню:

Редактировать выбранное расписание – внести необходимые изменения в значения параметров расписания;

Удалить выбранные расписания – удалить выбранные флажками из списка расписания, подтвердив действие нажатием кнопки Да в появившемся модальном окне;

Включить выбранные расписания – выбранные расписания будут выполнены при наступлении соответствующего времени;

Отключить выбранные расписания – выбранные расписания будут отключены и не будут выполняться;

Поставить выбранные расписания в очередь на выполнение сейчас – выбранные расписания будут поставлены в очередь и выполнены сразу независимо о назначенного в них времени;

При редактировании и копировании нужно нажать кнопку Сохранить для сохранения изменений или Отмена – для отмены редактирования.

#### 4.2.1 Управление доступом

В РОСА Менеджер ресурсов в меню панели навигации "Параметры  Параметры приложения" выбором аккордеона "Управлением доступом" можно перейти к просмотру иерархии настраиваемых элементов для пользователей, групп, ролей и арендаторов, добавлению и изменению пользователей, групп, ролей учетных записей, клиентов, проектов.

##### 4.2.1.1 Пользователи

Для создания нового пользователя необходимо выполнить следующие действия:

в меню панели навигации выбрать пункт "Параметры → Параметры приложения";

развернуть аккордеон "Управление доступом → Регион" и выбрать папку "Пользователи"; в рабочей области появится список существующих пользователей;

нажать кнопку Конфигурация, затем – Добавить нового пользователя (рисунок 27);

в рабочей области "Добавление нового пользователя" задать сведения о пользователе:

"Полное имя" – ввести имя пользователя;

"Имя пользователя" – ввести имя (логин) пользователя в Комплексе;

"Пароль", "Подтвердите пароль" – ввести и подтвердить пароль;

"Почтовый адрес" – ввести email для отправки оповещений;

"Доступные группы" – отметить флажками из раскрывающегося списка все группы, в которых должен быть задействован пользователь; в поле "Выбранные группы" отобразятся отмеченные группы.

нажать кнопку Добавить.

Добавление нового пользователя

Для работы с существующими пользователями следует выбрать нужных пользователей, нажать кнопку Конфигурация и выбрать одно из действий в появившемся меню:

Редактировать выбранного пользователя – внести необходимые изменения в сведения о пользователе;

Копировать выбранного пользователя в нового пользователя – указать уникальное имя пользователя и при необходимости внести изменения в сведения о нем;

Удалить выбранных пользователей – удалить выбранные флажками из списка пользователей, подтвердив действие нажатием кнопки Да в появившемся модальном окне.

Для редактирования тегов арендатора для конкретного пользователя нужно нажать на кнопку Политики и выбрать Редактировать теги <Арендатор> для этого пользователя. В появившейся рабочей области выбрать из раскрывающихся списков "Категории" и "Значения" тегов (рисунок 28), после чего они повятся в секции "Назначенные теги". Убрать тег из назначенных можно с помощью пиктограммы .

Редактирование тегов пользователя

При редактировании и копировании нужно нажать кнопку Сохранить для сохранения изменений или Отмена – для отмены редактирования.

##### 4.2.1.2 Группы

Группы пользователей РОСА Менеджер ресурсов определяют фильтры и назначают пользователям роли. В Комплексе можно либо создавать свои собственные группы, либо использовать службу каталогов LDAP для назначения группам пользователей ролей учетной записи. С списком прав для каждой предопределенной роли учетной записи можно ознакомиться в п.4.2.2.3 настоящего Руководства.

Пользователь может состоять в нескольких группах. При этом группе можно назначить только одну роль учетной записи.

Если пользователь принадлежит к нескольким группам, то может изменить текущую группу. Текущая группа влияет на квоту и другие настройки пользователя, включая разрешения на управление задачами, которые пользователь может выполнять, и данными, которые он может просматривать.

Для создания новой группы необходимо выполнить следующие действия:

в меню панели навигации выбрать пункт "Параметры → Параметры приложения";

развернуть аккордеон "Управление доступом → Регион" и выбрать папку "Группы"; в рабочей области появится список существующих групп;

нажать кнопку Конфигурация, затем – Добавить новую группу (рисунок 29);

в рабочей области "Добавление новой группы" задать значения параметрам группы:

в секции "Сведения о группе" ввести "Описание" и "Подробное описание" группы, выбрать "Роль" и "Проект/арендатор" для группы;

в секции "Назначить фильтры":

во вкладке "Теги" определить группы через "Конкретные теги", выбрав "Категорию" и "Значение" тега, или через "Теги на основе выражения", составив условное выражение для тега;

во вкладке "Кластеры, хранилища данных, хосты, диспетчеры и поставщики" определить флажками объекты выбором из иерархического меню;

во вкладке "Вирт. машины и шаблоны" определить флажками ВМ или шаблоны их создания выбором из иерархического меню;

Добавление новой группы

нажать кнопку Добавить.

В списке пользователей в столбце "Только для чтения" значение "True" определяет невозможность редактирования/удаления группы, иначе редактирование/удаление группы возможно; в столбце "Количество пользователей" указано число пользователей, принадлежащих этой группе.

Для работы с существующими группами следует выбрать нужные группы, нажать кнопку Конфигурация и выбрать одно из действий в появившемся меню:

Редактировать выбранную группу – внести необходимые изменения в сведения о группе;

Удалить выбранные группы – удалить выбранные флажками из списка группы, подтвердив действие нажатием кнопки Да в появившемся модальном окне.

Для редактирования последовательности групп пользователей обнаружения в LDAP для конкретного пользователя нужно нажать на кнопку Конфигурация и выбрать Редактировать последовательность групп пользователя для поиска LDAP. В появившейся рабочей области со списком групп, используя кнопки  и , изменить последовательность, в которой пользователи будут выбираться для поиска LDAP (рисунок 30).

Примечание – Для перемещения одновременно нескольких групп можно воспользоваться клавишей CTRL вместе с левой кнопкой "мыши".

Редактирование последовательности групп

Для редактирования тегов арендатора для конкретного группы нужно нажать на кнопку Политики и выбрать Редактировать теги <Арендатор> для этой группы. В появившейся рабочей области выбрать из раскрывающихся списков "Категорию" и "Значение" тега, после чего они повятся в секции "Назначенные теги". Убрать тег из назначенных можно с помощью пиктограммы  (рисунок 31).

Редактирование тегов для группы

При редактировании и копировании нужно нажать кнопку Сохранить для сохранения изменений или Отмена – для отмены редактирования.

##### 4.2.1.3 Роли

При создании группы необходимо указать роль, чтобы предоставить группе права на ресурсы в Комплексе. Роль группы определяет объем доступа пользователей, входящих в группы.

РОСА Менеджер ресурсов предоставляет роли групп по умолчанию, но также возможно создавать собственные и/или копировать и редактировать роли по умолчанию.

Примечание – Если включена опция "Получить роль из LDAP" в настройках LDAP, то роль определяется членством пользователя LDAP в группе службы каталогов.

В таблице 3 приведена сводная информация о функциях, доступных для каждой роли.

Роли и описания учетных записей

Для создания новой роли необходимо выполнить следующие действия:

в меню панели навигации выбрать пункт "Параметры → Параметры приложения";

развернуть аккордеон "Управление доступом → Регион" и выбрать папку "Роли"; в рабочей области появится список существующих ролей;

нажать кнопку Конфигурация, затем – Добавить новую роль (рисунок 32);

в рабочей области "Добавление новой роли" задать значения параметрам роли:

в секции "Сведения о роли":

ввести в поле "Имя" наименование роли;

выбрать из раскрывающегося списка "Ограничение доступа для элементов каталога, стеков оркестрации, пар ключей, служб, ВМ и шаблонов" уровень ограничения: "Нет", "Только если пользователем является владелец" или "Только если пользователем является владелец или группа";

в иерархическом списке "Свойства продукта" выбрать требуемые права доступа среди всех элементов Комплекса и действий с ними;

Добавление новой роли

нажать кнопку Добавить.

В списке ролей в столбце "Только для чтения" значение "True" определяет невозможность редактирования/удаления роли, иначе редактирование/удаление роли возможно; в столбце "Ограничения доступа к ВМ и шаблонам" указывается уровень, выбранный при создании/редактировании; в столбце "Количество групп" указано число групп с этой ролью.

Для работы с существующими ролями следует выбрать нужные роли, нажать кнопку Конфигурация и выбрать одно из действий в появившемся меню:

Редактировать выбранную роль – внести необходимые изменения в сведения о роли;

Копировать выбранную роль в новую роль – указать уникальное имя для скопированной роли и при необходимости внести изменения в значения других параметров роли;

Удалить выбранные роли – удалить выбранные флажками из списка роли, подтвердив действие нажатием кнопки Да в появившемся модальном окне.

При редактировании и копировании нужно нажать кнопку Сохранить для сохранения изменений или Отмена – для отмены редактирования.

##### 4.2.1.4 Арендаторы

Арендаторы используются в Комплексе для контроля видимости объектов.

Для создания нового арендатора необходимо выполнить следующие действия:

в меню панели навигации выбрать пункт "Параметры → Параметры приложения";

развернуть аккордеон "Управление доступом → Регион → Арендаторы" и выбрать арендатора-родителя в иерархическом меню аккордеона;

нажать кнопку Конфигурация, затем – Добавить дочернего арендатора этому арендатору (рисунок 33);

в рабочей области "Добавление нового арендатора" ввести значения в поля "Наименование" и "Описание";

Добавление нового арендатора

В аккордеоне "Арендаторы" появится новый арендатор, при нажатии на который в рабочей области будет показана информация о нем по секциям:

"Свойства" – с описанием и арендатором-родителем, например "Моя компания";

"Отношения" – с кликабельными ссылками и указанием количества элементов для перечней связанных "Элементов и наборов каталогов", "Доменов автоматизации" и "Поставщиков";

"Управление Smart" – с назначенными тегами администратора;

"Квота арендатора" – со списком выделенных ресурсов.

нажать кнопку Добавить.

###### 4.2.1.4.1 Создание проекта

Арендатор также может содержать автономного дочернего арендатора, известного как "Проект". У проекта не может быть дочернего клиента, но он полезен для распределения ресурсов небольшой группе или команде в составе более крупной компании.

Для создания нового проекта необходимо выполнить следующие действия:

в меню панели навигации выбрать пункт "Параметры → Параметры приложения";

развернуть аккордеон "Управление доступом → Регион → Арендаторы" и выбрать арендатора-родителя в иерархическом меню аккордеона;

нажать кнопку Конфигурация, затем – Добавить проект этому арендатору (рисунок 34);

в рабочей области "Добавление нового проекта" ввести значения в поля "Наименование" и "Описание".

Добавление нового проекта

В аккордеоне "Арендаторы" появится новый проект, при нажатии на который в рабочей области будет показана информация о нем по секциям:

"Свойства" – с описанием и арендатором-родителем, например "Моя компания";

"Отношения" – с кликабельными ссылками и указанием количества элементов для перечней связанных "Элементов и наборов каталогов", "Доменов Automate" и "Поставщиков";

"Управление Smart" – с назначенными тегами администратора;

"Квота арендатора" – со списком выделенных ресурсов.

Примечание – Секции можно скрывать нажатием на пиктограмму .

###### 4.2.1.4.2 Управление квотами

Для каждого арендатора и проекта могут быть назначены квоты.

Для назначения квот необходимо выполнить следующие действия:

в меню панели навигации выбрать пункт "Параметры → Параметры приложения";

развернуть аккордеон "Управление доступом → Регион → Арендаторы" и выбрать арендатора или проект в иерархическом меню аккордеона;

нажать кнопку Конфигурация, затем – Управление квотами (рисунок 35);

в рабочей области "Управление квотами" задать по необходимости переключателем принудительное включение и значение квоты для соответствующих ресурсов:

выделенные виртуальные ЦП;

выделенная память, Гб;

выделенное хранилище, Гб;

число выделенных ВМ;

выделенное число шаблонов.

Управление квотами

Для работы с существующими арендаторами и проектами следует выбрать нужные позиции, нажать кнопку Конфигурация и выбрать одно из действий в появившемся меню:

Редактировать этот элемент – внести необходимые изменения в сведения об арендаторе или проекте;

Удалить этот элемент – удалить выбранные флажками из списка арендаторы или группы, подтвердив действие нажатием кнопки Да в появившемся модальном окне.

Для редактирования тегов арендатора-родителя для конкретных дочерних арендаторов или проектов нужно нажать на кнопку Политики и выбрать Редактировать теги <Арендатор> для этого арендатора, например Редактировать теги 'Моя компания' для этого арендатора. В появившейся рабочей области выбрать из раскрывающихся списков "Категорию" и "Значение" тега, после чего они повятся в секции "Назначенные теги". Убрать тег из назначенных можно с помощью пиктограммы  (рисунок 36).

Редактирование тегов для группы

При редактировании и копировании нужно нажать кнопку Сохранить для сохранения изменений или Отмена – для отмены редактирования.

#### 4.2.2 Диагностика

В РОСА Менеджер ресурсов имеется возможность просматривать состояния различных ролей и рабочих процессов для каждого сервера, просматривать и собирать журналы, а также собирать другие данные, если недостаточно информации о мощностях и загруженности. Информация о виртуальной инфраструктуре и ресурсах собирается в VMDB, которая обычно является частью Комплекса, но может быть развернута на другой ВМ.

Раздел "Диагностика" имеет иерархическую структуру:

на уровне региона можно просмотреть состояния репликации, выполнить резервное копирование VMDB и запустить сбор мусора в VMDB;

на уровне зоны можно просмотреть роли Комплекса по серверам и серверы по ролям. Кроме того, можно установить значения сбора журналов для конкретной зоны и собирать данные по мощностям и загруженности;

на уровне сервера можно видеть исполнителей для каждого сервера, устанавливать значения сбора журналов для конкретного сервера и просматривать текущие журналы.

##### 4.2.2.1 Диагностика региона

С помощью Комплекса можно устанавливать приоритет региональных ролей сервера, просматривать и сбрасывать репликацию, а также создавать резервные копии БД по требованию или по расписанию.

Регионы используются в основном для консолидации нескольких VMDB в одну главную VMDB для отчетности, а зоны используются для определения функциональных групп серверов. В каждой VMDB может быть только один регион, но в каждом регионе (или VMDB) может быть несколько зон. Некоторые роли серверов знают друг о друге на устройствах Комплекса на уровне региона. Это означает, что правила резервирования и аварийного переключения применяются на уровне региона. Кроме того, для ролей сервера, обеспечивающих аварийное переключение, также можно установить приоритеты.

Если в ИТ-инфраструктуре имеется несколько серверов с повторяющимися ролями аварийного переключения, можно установить приоритет роли сервера.

Только роли сервера, поддерживающие отработку отказа, можно пометить как основные. Эти роли позволяют одновременно быть активным только одному серверу: Notifier (Уведомления), Capacity & Utilization Coordinator (Координация мощности и загруженности), Event Monitor (Монитор событий), Scheduler (Расписания), Storage Inventory (Инвентарь хранилища) и Provider Inventory (Инвентарь поставщика).

Все остальные роли сервера являются аддитивными. Чем больше серверов с этой ролью в зоне, тем больше функций они могут выполнить.

Для серверов определены три ролевых приоритета:

Первичный – для каждой роли может быть только один основной сервер в каждой зоне или регионе. При запуске устройства Комплекс проверяет, не назначена ли какая-либо роль основной. В этом случае роль активируется на этом устройстве и деактивируется на вторичном устройстве. В веб-интерфейсе Комплекса основные роли выделены жирным шрифтом. Текст становится красным, если сервер выходит из строя. Основной приоритет должен быть установлен в активное состояния;

Вторичный – это приоритет по умолчанию. Вторичных может быть несколько. Если при запуске устройства в зоне не найдено основное устройство, роль берет на себя первое запустившееся устройство. В веб-интерфейсе второстепенные роли обычно отображаются со словом "вторичные";

Третичный – если все устройства с основными или второстепенными ролями были отключены, одна из третичных ролей будет активирована. Причина установления третичного приоритета заключается в том, чтобы гарантировать, что в случае выхода из строя сервера с такими важными ролями, как "Provider Inventory( Инвентарь поставщика)" или "Monitor Event (Монитор событий)", есть способ связать эти роли с различными устройствами, организовав приоритеты. Третичные роли отображаются в веб-интерфейсе как активные.

Роли сервера с учетом региона приведены в таблице 4.

Роли сервера с учетом региона

Установка приоритета роли аварийного переключения осуществляется выполнением следующих действий:

перейти в раздел меню "Параметры  Параметры приложения";

развернуть аккордеон "Диагностика" и выбрать "Регион РОСА Менеджер ресурсов";

в появившейся рабочей области (рисунок 37) можно посмотреть и задать параметры во вкладках:

"Зоны" – выбрать текущую зону и перейти к диагностике зоны;

"Роли по серверам" – выбрать сервер или роль, нажать кнопку Конфигурация и выбрать:

Повысить уровень сервера – сделать его основным сервером для этой роли;

Понизить уровень сервера – понизить приоритет этого сервера для этой роли;

Запустить роль – сделать роль активной;

Приостановить роль – деактивировать роль;

"Серверы по ролям" – выбрать сервер или роль, нажать кнопку Конфигурация и выбрать:

Запустить роль – сделать роль активной;

Приостановить роль – деактивировать роль;

"Серверы" – выбрать текущий сервер и перейти к его диагностике; пометить необходимые серверы флажками, нажать кнопку Конфигурация и выбрать Удалить выбранные серверы;

"БД" – просмотреть основные сведения о БД;

"Потерянные данные" – просмотреть результаты отчетов по пользователям и при необходимости удалить записи, нажав на пиктограмму .

Установка приоритетов

##### 4.2.2.2 Диагностика зоны

Комплекс предоставляет возможность просмотреть все роли, назначенные серверу, и их выполнение. Это особенно полезно, если есть несколько серверов с разными ролями. Для каждой зоны также можно установить центральное место для сбора всех журналов и сбора данных о мощности и загруженности, которые могут отсутствовать.

Роли сервера с учетом зоны приведены в таблице 5.

Роли сервера с учетом зоны

Для просмотра состояния ролей сервера нужно выполнить следующие действия:

перейти в раздел меню "Параметры  Параметры приложения";

развернуть аккордеон "Диагностика" и выбрать зону "Зона …";

в появившейся рабочей области (рисунок 38) можно посмотреть и задать параметры во вкладках:

"Роли по серверам" – выбрать сервер или роль, нажать кнопку Конфигурация и выбрать:

Повысить уровень сервера – сделать его основным сервером для этой роли;

Понизить уровень сервера – понизить приоритет этого сервера для этой роли;

Запустить роль – сделать роль активной;

Приостановить роль – деактивировать роль;

"Серверы по ролям"– выбрать сервер или роль, нажать кнопку Конфигурация и выбрать:

Запустить роль – сделать роль активной;

Приостановить роль – деактивировать роль;

"Серверы" – выбрать текущий сервер и перейти к его диагностике; пометить необходимые серверы флажками, нажать кнопку Конфигурация и выбрать Удалить выбранные серверы для удаления серверов;

"Сбор журналов" – просмотр URI хранилища журналов и даты последнего сбора журналов;

"Сбор информации о недозагруженности мощностей" – параметры сбора "Часовой пояс", "Дата начала" и "Дата окончания".

Примечание – Сбор информации доступен только для инфраструктуры VMware vSphere.

На страницах диагностики зоны используется пиктограмма  в левом верхнем углу для обновления содержания вкладок.

Для удаления сервера зоны нужно выбрать зону, нажать кнопку Конфигурация, выбрать Удалить сервер и нажать Да для подтверждения в появившемся модальном окне.

Установки приоритетов по зоне

##### 4.2.2.3 Диагностика сервера

В разделе "Диагностика сервера" можно просмотреть состояния рабочих процессов Комплекса, работающих на сервере, установить настройки сбора журналов только для этого сервера, а также просмотреть текущие журналы Комплекса и аудита сервера.

Для просмотра состояния сервера нужно выполнить следующие действия:

перейти в раздел меню "Параметры  Параметры приложения";

развернуть аккордеон "Диагностика" и выбрать сервер "Сервер …";

в появившейся рабочей области (рисунок 39) можно посмотреть и задать параметры во вкладках:

"Сводные данные" – общие сведения о сервере;

"Рабоч. процессы" – просмотр состояния рабочих процессов Комплекса и их перезапуск выбором флажками, нажатием кнопок Конфигурация и Перезапустить выбранные рабоч. процессы:

C&U Metrics Collectors (Сбор метрик мощностей и загруженности) – собирают данные о мощностях и загруженности;

C&U Metrics Processors (Процессоры метрик мощностей и загруженности) – обрабатывают собранные данные о мощностях и загруженности;

Event Handlers (Обработчики событий) – помещают события из монитора событий в VMDB и при необходимости запускают процессы Комплекса на основе этой информации;

Event Monitors (Мониторы событий) – взаимодействуют с внешним поставщиком облака для предоставления актуальной информации о событиях;

Generic Workers (Универсальные рабочие процессы) – выполняют длительные и приоритетные процессы;

Priority Workers (Приоритетные рабочие процессы) – выполняют короткие процессы с высоким приоритетом;

Schedule Workers (Рабочие процессы по расписанию) – поддерживают любые элементы, выполняемые по расписанию;

Session Broker (Брокер сеансов) – поддерживают единое соединение с облачными поставщиками;

Refresh Workers (Рабочие процессы обновления) – запускают процессы обновления;

Reporting Workers (Рабочие процессы отчетов) – генерируют отчеты;

SmartProxy Workers (Рабочие процессы SmartProxy) – запускают анализ SmartState на ВМ;

User Interface Worker (Рабочие процессы пользовательского интерфейса) – обеспечивает пользователям доступ к интерфейсу;

Web Services Worker (Рабочие процессы веб-служб) – обслуживают веб-службы Комплекса;

VM Analysis Collectors (Сборщики анализов ВМ) – запускают и обрабатывают анализы SmartState на ВМ;

"Сбор журналов" – просмотр URI хранилища журналов, даты последнего сбора журналов и даты последнего сообщения;

"Журнал РОСА Менеджер ресурсов" – просмотр последних 1000 строк журнала Комплекса; скачивание всего журнала Комплекса нажатием на пиктограмму ;

"Журнал аудита" – просмотр последних 1000 строк журнала аудита; скачивание всего журнала аудита нажатием на пиктограмму ;

"Журнал сервера" – просмотр последних 1000 строк журнала сервера зоны; скачивание всего журнала сервера нажатием пиктограммы .

На страницах диагностики сервера используется пиктограмма  в левом верхнем углу для обновления содержания вкладок.

Для перезапуска сервера зоны нужно выбрать сервер, нажать кнопку Конфигурация, выбрать Перезапустить сервер и нажать Да для подтверждения в появившемся модальном окне.

Диагностика сервера

### 4.3 Задачи

Выбор меню панели навигации "Параметры  Задачи" позволяет просматривать задачи анализа ВМ, которые можно отслеживать через консоль Комплекса. В списке отображаются статус каждой задачи, включая наименование, время начала и окончания, состояния, пользователя, сервер, а также любые сообщения и обнаруженные ошибки (рисунок 40).

Список задач

С помощью этого списка задач можно проводить анализ всех задач, выполняемых на ВМ и контейнерах для текущего пользователя, вошедшего в Комплекс (рисунок 41):

просматривать задачи, которые вошедший в Комплекс пользователь создал либо по расписанию, либо путем ручного запуска;

посматривать статус задачи: успешное завершение, привело к ошибке или выполняется;

посмотреть причину ошибки;

фильтровать задачи по зоне, владельцу, периоду, статусу, состоянию;

просмотреть владельца или хоста указанной ВМ или контейнера;

остановить или удалить задачи.

Во вкладке "Мои задачи" показываются задачи текущего пользователя, а во вкладке "Все задачи" – всех пользователей, на просмотр задач которых имеются права у текущего пользователя.

Фильтрация задач

Для обновления списка задач можно воспользоваться пиктограммой  (Обновить сведения об этой странице).

Для отмены одной выбранной задачи нужно нажать пиктограмму  (Отменить выбранную задачу).

Для удаления задач нажимают кнопку Удалить задачи и выбирают:

Удалить – для удаления одной задачи;

Удалить старые – для удаления завершенных задач;

Удалить все – для удаления всех задач.

### 4.4 Общие сведения о Комплексе

#### 4.4.1 Документация

В разделе меню "Параметры  Документации" можно по ссылке https://rosa.ru/docs/ перейти к документации РОСА Менеджер ресурсов.

#### 4.4.2 Разработчик

В разделе меню "Параметры  РОСА" можно по ссылке https://rosa.ru перейти к официальной странице АО "НТЦ ИТ РОСА".

#### 4.4.3 О Комплексе

В разделе меню "Параметры  Сведения" можно ознакомиться с технической информацией о программном продукте РОСА Менеджер ресурсов (рисунок 42).

Сведения о Комплексе