# Создание панели мониторинга

Чтобы скопировать панель мониторинга, нужно выполнить следующие действия:

1. выбрать "Dashboards (Панели мониторинга)" в главном меню;
2. открыть панель мониторинга, которую требуется скопировать;
3. нажать  в правом верхнем углу;
  [Рисунок 528](/image26.png)
4. нажать на "Save as (Сохранить как)";
5. (необязательно) указать название, папку, описание и решить, нужно ли копировать исходные теги панели мониторинга для скопированной панели мониторинга; по умолчанию скопированная панель мониторинга имеет то же имя, что и исходная панель мониторинга, с добавлением слова "Copy (Копия)" и находится в той же папке;
6. нажать Save (Сохранить).

## Копирование панели мониторинга

Подсистему можно настроить для динамического добавления панелей или строк на панель мониторинга на основе значения переменной. Переменные динамически изменяют запросы во всех строках на панели мониторинга.

Для примера с нужно перейти на панель мониторинга с повторяющимися строками. В этом примере показано, что также можно повторять строки, если выбраны переменные "Multi-value" или "Include all values".

Предварительно необходимо убедиться, что запрос включает многозначную переменную.

Для настройки повторяющихся строк нужно:

1. выбрать "Dashboards (Панели мониторинга)" в главном меню;
2. перейти к панели мониторинга, над которой требуется поработать;
3. в верхней части панели мониторинга нажать Add (Добавить) и выбрать "Row (Строка)" в раскрывающемся списке; если панель мониторинга пуста, можно нажать кнопку +Add row (Добавить строку) в центре панели мониторинга;
4. навести указатель "мыши" на заголовок строки и нажать значок шестеренки;
5. в диалоговом окне "Row Options (Параметры строки)" добавить заголовок и выбрать переменную, для которой требуется добавить повторяющиеся строки;
6. нажать Update (Обновить).

Чтобы предоставить контекст пользователям панели мониторинга, можно добавить переменную в заголовок строки.

Если в строке есть панели, использующие специальный источник данных панели мониторинга – источник данных, который использует набор результатов с другой панели на той же панели мониторинга, – то соответствующие панели в повторяющихся строках будут ссылаться на панель в исходной строке, а не на панели в повторяющихся строках.

## Настройка повторяющихся строк

Панель можно разместить на панели мониторинга в любом месте, для чего нужно:

1. выбрать "Dashboards (Панели мониторинга)" в главном меню;
2. перейти к панели мониторинга, над которой требуется поработать;
3. с помощью "мыши" переместить ее в новое место;
4. нажать Save dashboard (Сохранить панель мониторинга);
5. (необязательно) ввести описание внесенных изменений;
6. нажать Save (Сохранить).

## Перемещение панели

В Подсистеме можно настроить размер панели мониторинга в соответствии с необходимостью:

1. выбрать "Dashboards (Панели мониторинга)" в главном меню;
2. перейти к панели мониторинга, над которой требуется поработать;
3. с помощью "мыши" нажать и переместить правый нижний угол панели;
4. нажать Save dashboard (Сохранить панель мониторинга);
5. (необязательно) ввести описание внесенных изменений;
6. нажать Save (Сохранить).

## Изменение размера панели

В Подсистеме можно импортировать предварительно настроенные панели мониторинга в пользовательский экземпляр Подсистемы с помощью пользовательского интерфейса или HTTP API.

Чтобы импортировать панель мониторинга, нужно выполнить следующие действия:

1. выбрать "Dashboards (Панели мониторинга)" в основном меню;
2. нажать New (Новый) и выбрать "Import (Импорт)" в раскрывающемся меню;
3. выполнить одно из следующих действий:
  - загрузить JSON-файл панели мониторинга;
  - вставить URL-адрес или идентификатор панели мониторинга в указанное поле;
  - вставить текст панели в формате JSON непосредственно в текстовую область;
4. (необязательно) изменить название панели мониторинга, папку или UID и указать префиксы метрик, если панель мониторинга их использует;
5. выбрать источник данных, если требуется;
6. нажать кнопку Load (Загрузить).

## Импорт панелей мониторинга

Страница настроек панели мониторинга позволяет выполнить следующие процедуры:

- редактирование общих свойств панели мониторинга, включая настройки времени;
- добавление запросов к аннотациям;
- добавление переменных панели мониторинга;
- добавление ссылок;
- просмотр JSON-модели панели мониторинга.

Чтобы получить доступ к странице настроек панели мониторинга, требуется, нужно нажать значок  в правом верхнем углу панели мониторинга.

::sign-image
---
src: /image26.png
sign: Рисунок 527
---
::

Далее проводятся настройки по секциям редактирования.

## Изменение настроек панели мониторинга

Настройка параметров времени на панели мониторинга проводится, если требуется изменить часовой пояс панели мониторинга, локальное время браузера и задать интервалы автоматического обновления:

1. перейти по  на страницу "General (Общая)";
  [Рисунок 529](/image26.png)
2. прокрутить вниз до раздела "Time Options (Параметры времени)";
3. указать настройки времени следующим образом:
  - Time zone (Часовой пояс) – указать местный часовой пояс службы или наблюдаемого приложения. Это может быть полезно при отслеживании приложения или службы, которые работают в нескольких часовых поясах.
    - Default (По умолчанию) – Подсистема использует выбранный по умолчанию часовой пояс для профиля пользователя, команды или организации. Если для профиля пользователя, команды, членом которой является пользователь, или организации не указан часовой пояс, то Подсистема использует время локального браузера;
    - Browser time (Время в браузере) – используется часовой пояс, настроенный для браузера пользователя. Обычно это тот же часовой пояс, что и на компьютере;
    - Стандартные часовые пояса ISO 8601, включая UTC;
  - Week start (Начало недели) – выбрать день начала недели;
  - Auto refresh (Автоматическое обновление) – настроить параметры отображения относительного времени и параметры автоматического обновления. Записи разделяются запятыми и могут содержать любые допустимые единицы измерения времени.
  - Now delay (Задержка по времени) – изменить время "now" на нужное, введя задержку по времени; эту опцию используют, чтобы учесть известные задержки при сборе данных и избежать нулевых значений;
  - Hide time picker (Скрыть выбор времени) – выбрать этот параметр, если не нужно, чтобы Подсистема отображала выбор времени;
  - Refresh live dashboards (Обновить текущие панели) – обновлять или нет текущие панели мониторинга;
4. нажать Save dashboard (Сохранить панель мониторинга);
5. (необязательно) ввести описание внесенных изменений;
6. нажать Save (Сохранить).

### Настройка времени

В Подсистеме можно добавлять метаданные на панели мониторинга с помощью тегов. Теги также позволяют фильтровать список панелей мониторинга. Длина тегов может составлять до 50 символов, включая пробелы.

Чтобы добавить теги на панель мониторинга, выполняют следующие действия:

1. на странице "Setting (Настройки)" прокрутить вниз до раздела "Tags (Теги)" на вкладке "General (Общие)";
2. в поле ввести новый или существующий тег; если вводится существующий тег, следует убедиться, что он написан так же, иначе будет создан новый тег;
3. нажать Add (Добавить) или клавишу Enter;
4. нажать Save dashboard (Сохранить панель мониторинга);
5. (необязательно) ввести описание внесенных изменений;
6. нажать Save (Сохранить).

На странице "Dashboards (Панели мониторинга)" все введенные теги отображаются в столбце "Tags (Теги)".

### Добавление тегов

Запрос с аннотацией – это запрос, который ищет события. Эти события можно визуализировать на графиках на панели мониторинга в виде вертикальных линий с небольшим значком, на который можно навести курсор "мыши", чтобы увидеть информацию о событии. Для создания запроса нужно:

1. на странице "Setting (Настройки)" перейти на вкладку "Annotations (Аннотации)";
2. нажать Add annotation query (Добавить запрос аннотации);
3. ввести имя и выбрать источник данных;
4. заполнить остальную часть формы, чтобы создать запрос и аннотацию;
5. нажать Save dashboard (Сохранить панель мониторинга);
6. (необязательно) ввести описание внесенных изменений;
7. нажать Save (Сохранить).

Пользовательский интерфейс редактора запросов меняется в зависимости от выбранного источника данных.

### Добавление запроса аннотации

Переменные позволяют создавать более интерактивные и динамичные панели мониторинга. Вместо того чтобы жестко задавать такие параметры, как имена серверов, приложений и датчиков в запросах метрик, можно использовать вместо них переменные. Переменные отображаются в виде выпадающих списков в верхней части панели мониторинга. Эти выпадающие списки позволяют легко изменять данные, отображаемые на панели мониторинга.

Для добавления переменной необходимо:

1. на странице "Setting (Настройки)" перейти на вкладку "Variables (Переменные)";
2. нажать +New variable (Новая переменная);
3. в раскрывающемся списке "Select variable type (Выбрать тип переменной)" выбрать опцию; выбранный тип переменной влияет на то, какие поля заполняются на странице;
4. в разделе "General (Общие)" ввести имя переменной, которое будет использоваться позже в запросах;
5. установить остальные параметры переменной;
6. нажать Save dashboard (Сохранить панель мониторинга);
7. (необязательно) ввести описание внесенных изменений;
8. нажать Save (Сохранить).

### Добавление переменной

Ссылки на панели мониторинга позволяют размещать ссылки на другие панели мониторинга и веб-сайты непосредственно под заголовком панели мониторинга. Ссылки обеспечивают удобную навигацию по другим связанным с ними панелям мониторинга и контенту. Для добавления ссылки:

1. на странице "Setting (Настройки)" перейти на вкладку "Links (Ссылки)";
2. нажать Add dashboard link (Добавить ссылку на панель мониторинга);
3. ввести название ссылки;
4. В раскрывающемся списке "Type (Тип)" выбрать "Dashboards (Панели мониторинга)" или "Links (Ссылки)";
5. установить остальные параметры ссылки;
6. нажать Save dashboard (Сохранить панель мониторинга);
7. (необязательно) ввести описание внесенных изменений;
8. нажать Save (Сохранить).

### Добавление ссылки

Панель мониторинга в Подсистеме представлена в виде объекта JSON, в котором хранятся метаданные панели мониторинга. Метаданные панели мониторинга включают свойства панели мониторинга, метаданные панелей, переменные шаблонов, запросы панелей и так далее.

Чтобы просмотреть модель JSON на панели мониторинга, на странице "Setting (Настройки)" нужно перейти на вкладку "JSON Model (Модель JSON)".

### Просмотр JSON-модели панели мониторинга

В Подсистеме возможно использовать ссылки для перехода между часто используемыми панелями мониторинга или для подключения других пользователей к визуализациям. Ссылки позволяют создавать ярлыки для других панелей мониторинга, разделов и даже внешних веб-сайтов.

Подсистема поддерживает ссылки на панели мониторинга, ссылки на панели и ссылки на данные. Ссылки на панели мониторинга отображаются в верхней части панели мониторинга. Ссылки на панели доступны по нажатию на значок рядом с названием панели.

## Управление ссылками на панель мониторинга

Для начала необходимо определить текущий способ переключения между панелями мониторинга. Если часто переключение происходит между несколькими панелями мониторинга и сложно найти один и тот же контекст на каждой из них, ссылки помогут оптимизировать рабочий процесс.

Следующий шаг – определить, какой тип ссылок подходит для рабочего процесса. Несмотря на то, что все типы ссылок в Подсистему используются для создания ярлыков для других панелей мониторинга или внешних веб-сайтов, они работают в разных контекстах:

- если ссылка относится к большинству, но не ко всем панелям на панели мониторинга, используют ссылки на панель мониторинга;
- если требуется перейти к конкретным панелям, используют ссылки на панели;
- если требуется создать ссылку на внешний сайт, можно использовать ссылку на панель мониторинга или ссылку на панель;
- если требуется перейти к конкретной серии или даже к одному измерению, используют ссылки на данные.

### Определение ссылки

Чтобы управлять временным диапазоном панели или панели мониторинга, можно указать параметры запроса в URL-адресе панели мониторинга:

- from – определяет нижний предел временного диапазона, указанного в миллисекундах";
- to – определяет верхний предел временного диапазона, указанного в миллисекундах;
- time и time.window – определяет диапазон времени от time-time.window/2 до time+time.window/2; оба параметра должны быть указаны в миллисекундах.

### Управление временным диапазоном с помощью URL-адреса

При создании ссылки на панели мониторинга можно указать диапазон времени и текущие переменные шаблона, чтобы напрямую перейти к тому же контексту на другой панели мониторинга. Таким образом, не нужно беспокоиться о том, что пользователь, которому отправляется ссылку, увидит нужные данные.

Ссылки на панели мониторинга также можно использовать в качестве ярлыков для перехода во внешние приложения, например для отправки заявки на GitHub с текущим названием панели мониторинга.

После добавления ссылки на панель мониторинга она появится в правом верхнем углу панели мониторинга.

Для добавления ссылки на другие панели мониторинга в верхней части текущей панели мониторинга нужно:

1. на панели мониторинга, на которую требуется добавить ссылку, нажать на значок ;
  [Рисунок 530](/image26.png)
2. в разделе "Setting (Настройки)" выбрать "Links (Ссылки)" и нажать +New link (Новая ссылка);
3. выбрать тип ссылки по умолчанию – "Dashboard (Панели мониторинга)";
4. в раскрывающемся списке "With tags (С тегами)" ввести теги, чтобы ограничить количество связанных панелей мониторинга только теми, которые содержат указанные теги;
5. если не добавить теги, Подсистема включит ссылки на все остальные панели мониторинга;
6. установить параметры связи:
  - Show as dropdown (Показать в виде выпадающего списка) – если связываются несколько панелей мониторинга, то, вероятно, потребуется выбрать этот вариант и добавить необязательный заголовок в выпадающее меню. В противном случае Подсистема отобразит ссылки на панели мониторинга рядом в верхней части панели мониторинга;
  - Include current time range (Включить текущий диапазон времени) – выбрать этот параметр, чтобы включить диапазон времени панели мониторинга в ссылку. Когда пользователь нажимает на ссылку, открывается связанная панель мониторинга с уже установленным диапазоном времени;
  - Include current template variable values (Включить текущие значения переменных шаблона) – выбрать этот параметр, чтобы включить в ссылку переменные шаблона, используемые в данный момент в качестве параметров запроса. Когда пользователь нажимает на ссылку, всем соответствующим шаблонам в связанной панели мониторинга присваиваются значения из ссылки;
  - Open link in new tab (Открыть ссылку в новой вкладке) – выбрать этот вариант, если требуется, чтобы ссылка на панель мониторинга открывалась в новой вкладке или окне.
7. нажать Save dashboard (Сохранить панель мониторинга) в правом верхнем углу;
8. (необязательно) ввести описание внесенных изменений;
9. нажать Save (Сохранить).

Добавление ссылки в верхней части текущей панели мониторинга проводится через любой доступный URL-адрес, в том числе на панели мониторинга, панели или внешние сайты:

1. на панели мониторинга, на которую требуется добавить ссылку, нажать ;
  [Рисунок 531](/image26.png)
2. выбрать "Setting (Настройки)";
3. перейти на вкладку "Links (Ссылки)" и нажать Add dashboard link (Добавить ссылку на панель мониторинга);
4. в раскрывающемся списке "Type (Тип)" выбрать "Link (Ссылка)";
5. в поле "URL" ввести URL-адрес, на который требуется создать ссылку; в зависимости от цели можно включить значения полей;
6. в поле "Tooltip (Подсказка)" ввести текст подсказки, который будет отображаться при наведении курсора на ссылку;
7. в раскрывающемся списке "Icon (Значок)" выбрать значок, который будет отображаться вместе со ссылкой;
8. установить параметры ссылок; по умолчанию эти параметры включены для URL-ссылок:
  - Include current time range (Включить текущий диапазон времени) – выбрать этот параметр, чтобы включить диапазон времени панели мониторинга в ссылку. Когда пользователь нажимает на ссылку, открывается связанная панель мониторинга с уже установленным диапазоном времени;
  - Include current template variable values (Включить текущие значения переменных шаблона) – выбрать этот параметр, чтобы включить переменные шаблона, которые в данный момент используются в качестве параметров запроса, в ссылку. Когда пользователь нажимает на ссылку, все соответствующие шаблоны на связанной панели мониторинга устанавливаются со значениями из ссылки;
  - Open link in new tab (Открыть ссылку в новой вкладке) – выбрать этот вариант, если требуется, чтобы ссылка на панель мониторинга открывалась в новой вкладке или окне.
9. нажать Save dashboard (Сохранить панель мониторинга) в правом верхнем углу;
10. (необязательно) ввести описание внесенных изменений;
11. нажать Save (Сохранить).

Чтобы отредактировать, дублировать или удалить ссылку на панель мониторинга, выполняют следующие действия:

1. на панели мониторинга, на которой требуется обновить ссылку, нажать ;
  [Рисунок 532](/image26.png)
2. выбрать "Setting (Настройки)";
3. перейти на вкладку "Links (Ссылки)";
4. выполнить одно из следующих действий:
  - изменить – нажать на название ссылки и обновить ее настройки;
  - дублировать – нажать значок копирования ссылки  рядом со ссылкой, которую требуется продублировать;
    [Рисунок 533](/image46.png)
  - удалить – нажать на значок  рядом со ссылкой, которую требуется удалить, а затем нажать Delete (Удалить);
    [Рисунок 52](/image10.png)
5. нажать Save dashboard (Сохранить панель мониторинга).

### Ссылки на панели мониторинга

URL-адрес панели мониторинга с переменными позволяет предоставить больше контекста при публикации URL-адреса панели мониторинга.

Например, можно поделиться базовым URL-адресом пользовательской панели мониторинга, который выглядит так:

```yaml
https://${your-domain}/path/to/your/dashboard
```

Это позволяет перейти на панель мониторинга, но не предоставляет никакой полезной информации, которая могла бы быть доступна.

Вместо этого можно добавить переменные панели мониторинга, передаваемые в качестве параметров запроса в URL панели мониторинга, чтобы получить такой URL:

```yaml
https://${your-domain}/path/to/your/dashboard?var-example=value
```

Это позволяет добавить контекст на панель мониторинга, когда кто-то переходит на нее.

Подсистема интерпретирует параметры строки запроса, начинающиеся с "var-", как переменные в данной панели мониторинга, например:

```yaml
https://${your-domain}/path/to/your/dashboard?var-example=value
```

В этом URL-адресе параметр запроса var-example=value представляет собой переменную панели мониторинга example со значением value.

Чтобы передать несколько значений, нужно повторить переменный параметр один раз для каждого значения:

```yaml
tps://${your-domain}/path/to/your/dashboard?var-example=value1&var-example=value2
```

Подсистема интерпретирует var-example=value1&var-example=value2 как переменную панели example с двумя значениями: value1 и value2.

Специальные фильтры применяют фильтры "ключ/значение" ко всем запросам метрик, использующим указанный источник данных.

Чтобы передать специальный фильтр в качестве параметра запроса, используют синтаксис переменной для передачи специальной переменной фильтра. Затем следует указать ключ, оператор и значение в виде списка, разделенного символами "|", например:

```yaml
https://${your-domain}/path/to/your/dashboard?var-adhoc=example_key|=|example_value
```

В этом URL-адресе параметр запроса var-adhoc=key|=|value применяет специальный фильтр, настроенный как переменная панели мониторинга adhoc с использованием ключа example_key, оператора "=" и значения example_value.

> Примечание – При использовании специальных фильтров для URL-адресов не следует забывать кодировать URL-адрес. В предыдущем примере лучше заменить "|" на "%7C" и "=" на "%3D".

Возможно управлять диапазоном времени на панели мониторинга, указав следующие параметры запроса в URL-адресе панели мониторинга:

- from – определяет нижний предел диапазона времени, указанный в миллисекундах, эпохах или относительном времени;
- to – определяет верхний предел диапазона времени, указанный в миллисекундах, эпохах или относительном времени;
- time и time.window – определяет диапазон времени от time-time.window/2 до time+time.window/2; оба параметра должны быть указаны в миллисекундах;
- timezone – определяет часовой пояс.

Поскольку это не переменные, для них не требуется префикс "var-".

В следующем примере показана панель мониторинга с диапазоном времени за последние пять минут:

```yaml
https://${your-domain}/path/to/your/dashboard?from=now-5m&to=now
```

## URL-переменные панели мониторинга

Библиотечная панель – это панель многократного использования, которую можно применять в любой панели мониторинга. Когда вносятся изменения в библиотечную панель, эти изменения распространяются на все экземпляры, в которых используется панель. Библиотечные панели упрощают повторное использование панелей в нескольких панелях мониторинга.

Можно сохранить библиотечную панель в папке вместе с сохраненными панелями мониторинга.

## Управление библиотечными панелями

Библиотечные панели можно повторно использовать на разных панелях мониторинга в Подсистеме. При создании библиотечной панели панель на исходной панели мониторинга также преобразуется в библиотечную панель. После преобразования панели необходимо сохранить исходную панель мониторинга.

Чтобы создать библиотечную панель, выполняют следующие действия:

1. в правом верхнем углу панели нажать  и выбрать "More (Больше)  Create library panel (Создать библиотечную панель)";
  [Рисунок 535](/image47.png)
2. в поле "Library panel name (Название библиотечной панели)" ввести название;
3. в раскрывающемся списке "Save in folder (Сохранить в папке)" выбрать папку, в которую нужно сохранить библиотечную панель; по умолчанию выбран корневой уровень;
4. нажать Create library panel (Создать библиотечную панель), чтобы сохранить внесенные изменения;
5. нажать Save dashboard (Сохранить панель мониторинга);
6. (необязательно) ввести описание внесенных изменений;
7. нажать Save (Сохранить).

После создания можно изменить библиотечную панель на любой панели мониторинга, где она отображается. После сохранения изменений все экземпляры библиотечной панели будут отражать эти изменения.

### Создание библиотечной панели

Добавление библиотечной панели Подсистемы на панель мониторинга используется, если требуется предоставить визуализацию другим пользователям панели мониторинга.

Чтобы добавить библиотечная панель, выполняют следующие действия:

1. выбрать "Dashboards (Панели мониторинга)" в главном меню;
2. нажать New (Новая) и выбрать "New Dashboard (Новая панель мониторинга)" в раскрывающемся списке;
3. на пустой панели мониторинга нажать +Add library panel (Добавить библиотечную панель); откроется окно "Add panel from panel library (Добавить панель из библиотечных панелей)";
4. отфильтровать список или выполнить поиск, чтобы найти панель, которую требуется добавить;
5. нажать на панель, чтобы добавить ее на панель мониторинга;
6. нажать Save dashboard (Сохранить панель мониторинга);
7. (необязательно) ввести описание внесенных изменений;
8. нажать Save (Сохранить).

### Добавление библиотечной панели на панель мониторинга

Отключение библиотечной панели используется, если требуется внести изменения в панель, не затрагивая другие экземпляры библиотечной панели.

Чтобы отключить привязку библиотечной панели, выполняют следующие действия:

1. выбрать  в главном меню "Dashboards (Панели мониторинга) ® Library panels (Панели библиотеки)";
2. выбрать библиотечную панель, которая используется на панелях мониторинга;
3. нажать на панель, которую требуется отключить;
4. в диалоговом окне выбрать панель мониторинга, с которой требуется удалить панель;
5. нажать View panel in <dashboard name> (Просмотреть панель в <название панели мониторинга>);
6. нажать Edit (Редактировать) в правом верхнем углу панели мониторинга;
7. навести курсор на любую часть панели, которую требуется отключить, чтобы в правом верхнем углу появился значок меню;
8. нажать на значок меню и выбрать "More (Еще)  Unlink library panel (Отключить привязку библиотечной панели)";
9. нажать Yes, unlink (Да, отключить привязку);
10. нажать Save dashboard (Сохранить панель мониторинга).

Кроме того, если известно, где используется библиотечная панель, можно перейти непосредственно на эту панель и начать с шага ж).

### Отключение привязки библиотечной панели

Чтобы заменить библиотечная панель на другую, выполняют следующие действия:

1. выбрать в главном меню "Dashboards (Панели мониторинга) ® Library panels (Панели библиотеки)";
2. выбрать библиотечная панель, которая используется на разных панелях мониторинга;
3. нажать на панель, которую требуется отключить;
4. в диалоговом окне выбрать панель мониторинга, с которой требуется удалить панель;
5. нажать View panel in <dashboard name> (Просмотреть панель в <название панели мониторинга>);
6. нажать Edit (Редактировать) в правом верхнем углу панели мониторинга;
7. навести курсор на любую часть панели, которую требуется отключить, чтобы в правом верхнем углу появился значок меню;
8. нажать значок меню и выбрать "More (Еще)  Replace library panel (Заменить библиотечная панель)";
9. выбрать библиотечная панель на замену;
10. нажать Save dashboard (Сохранить панель мониторинга);
11. (необязательно) ввести описание внесенных изменений;
12. нажать Save (Сохранить).

В качестве альтернативы, если известно, где используется библиотечная панель, которую требуется заменить, можно перейти непосредственно к этой панели и начать с шага ж).

### Замена библиотечной панели

Чтобы просмотреть библиотечные панели и управлять ими, выполняют следующие действия:

1. выбрать "Dashboards (Панели мониторинга)  Library panels (Панели библиотеки)" в главном меню; появится список ранее определенных библиотечных панелей (рисунок 27);

::sign-image
---
src: /image48.png
sign: Список панелей библиотек
---
::

1. найти конкретную библиотечную панель, если известно ее название; также можно фильтровать панели по папке или типу;
2. нажать на панель, чтобы узнать, используется ли она в каких-либо панелях мониторинга;
3. (необязательно) если библиотечная панель используется, выбрать одну из панелей мониторинга, используя ее;
4. (необязательно) нажать View panel in <dashboard name> (Просмотреть панель в <название панели мониторинга>), чтобы просмотреть панель в контексте.

### Просмотр списка панелей библиотек

Чтобы удалить библиотечную панель, которая больше не нужна, выполняют следующие действия:

1. выбрать "Dashboards (Панели мониторинга)  Library panels (Панели библиотеки)" в главном меню;
2. нажать на значок  рядом с названием библиотечной панели;
  [Рисунок 540](/image22.png)
3. нажать Delete (Удалить).

### Удаление библиотечной панели

Всякий раз, когда сохраняется версия панели мониторинга, сохраняется копия этой версии, чтобы предыдущие версии панели мониторинга не терялись. Список версий панели мониторинга можно увидеть на вкладке "Versions (Версии)" в настройках панели мониторинга (рисунок 28).

::sign-image
---
src: /image49.png
sign: Версии
---
::

Функция "История версий панели мониторинга" позволяет сравнивать и восстанавливать ранее сохраненные версии панели мониторинга.

## Управление историей версий панели мониторинга

Чтобы сравнить две версии панели мониторинга, выполняют следующие действия:

1. нажать  в правом верхнем углу панели мониторинга;
  [Рисунок 548](/image26.png)
2. в разделе "Setting (Настройки)" перейти на вкладку "Versions (Версии)";
3. выбрать две версии панели мониторинга, которые требуется сравнить;
4. нажать Compare versions (Сравнить версии), чтобы просмотреть разницу между двумя версиями;
5. ознакомиться с текстовыми описаниями различий между версиями;
6. (необязательно) развернуть раздел "View JSON Diff (Просмотр различий в JSON") на странице, чтобы увидеть различия с исходным JSON, представляющем панель мониторинга;
7. по окончании сравнения версий нажать значок  для возврата в список версий.
  [Кнопка восстановления версии](/image50.png)

При сравнении версий, если одна из выбранных версий является последней, также отображается кнопка для восстановления предыдущей версии, чтобы можно было восстановить версию из режима сравнения (рисунок 29).

::sign-image
---
src: /image51.png
sign: Кнопка восстановления версии
---
::

### Сравнение двух версий панели мониторинга

Чтобы восстановить ранее сохраненную версию панели мониторинга, выполняют следующие действия:

1. нажать  в правом верхнем углу панели мониторинга;
  [Кнопка восстановления версии](/image26.png)
2. в разделе "Setting (Настройки)" перейти на вкладку "Versions (Версии)";
3. нажать кнопку Restore (Восстановить) рядом с версией.

При восстановлении версии панель мониторинга сразу же сохраняется, и осуществляется выход из режима редактирования.

После восстановления предыдущей версии создается новая версия панели мониторинга, содержащая те же данные, что и предыдущая версия, но с другим номером версии. Это указано в "Notes column (Столбец примечаний)" на вкладке "Versions (Версии)" в настройках панели мониторинга. Это делается для того, чтобы предыдущие версии панели мониторинга не пострадали от изменений.

### Восстановление предыдущей версии панели мониторинга

Аннотации позволяют отмечать точки на визуализации с помощью подробных событий. Они отображаются в виде вертикальных линий и значков на всех графических панелях. При наведении курсора на аннотацию можно получить описание события и теги событий. В текстовом поле можно размещать ссылки на другие системы с более подробной информацией (рисунок 30).

::sign-image
---
src: /image52.png
sign: График с аннотацией
---
::

Комментировать визуализации можно тремя способами:

- непосредственно на панели, используя встроенный запрос аннотаций;
- используя HTTP API;
- настройкой запросов аннотаций в настройках панели мониторинга.

В первых двух случаях создаются новые аннотации, а в последнем запрашиваются существующие аннотации из источников данных. Встроенный запрос аннотаций также поддерживает это.

Аннотации поддерживаются для следующих типов визуализации:

- временные ряды;
- временная шкала состояния;
- свечной график.

В Подсистеме есть возможность добавлять события аннотаций прямо с панели с помощью встроенного запроса аннотаций, который есть на всех панелях мониторинга. Созданные таким образом аннотации сохраняются в Подсистеме.

Для добавления аннотаций непосредственно на панели:

- иметь уже сохраненную панель мониторинга;
- необходимо включить встроенный запрос.

## Аннотации визуализаций

Чтобы добавить аннотацию, выполняют следующие действия:

1. если панель мониторинга была только недавно сохранена, обновить страницу;
2. нажать на панель, на которую добавляется аннотация; появится контекстное меню;
3. в контекстном меню нажать Add annotation (Добавить аннотацию) (рисунок 31);

::sign-image
---
src: /image53.png
sign: Добавление аннотации
---
::

1. добавить описание аннотации и теги (необязательно);
2. нажать Save (Сохранить).

Кроме того, чтобы добавить аннотацию, можно нажать Ctrl/Cmd и нажать на панели, после чего появится контекстное меню Add annotation (Добавить аннотацию).

### Добавление аннотации

Для добавления аннотации области выполняют следующие шаги:

1. если панель мониторинга была только недавно сохранена, обновить страницу;
2. нажать Ctrl/Cmd, кнопку "мыши" и переместить курсор по панели;
3. в контекстном меню нажать Add annotation (Добавить аннотацию);
4. добавить описание аннотации и теги (необязательно);
5. нажать Save (Сохранить).

### Добавление аннотации области

Для редактирования аннотации выполняют следующие шаги:

1. навести указатель "мыши" на индикатор аннотации на панели;
2. нажать значок  во всплывающей подсказке аннотации;
  [Рисунок 43](/image8.png)
3. изменить описание и теги;
4. нажать Save (Сохранить).

### Редактирование аннотации

Для удаления аннотации выполняют следующие шаги:

1. навести указатель "мыши" на индикатор аннотации на панели;
2. нажать значок  во всплывающей подсказке с аннотациями;
  [Рисунок 463](/image22.png)
3. нажать Save (Сохранить).

### Удаление аннотации

В настройках панели мониторинга в разделе "Annotations (Аннотации)" можно добавить новые запросы для получения аннотаций из любого источника данных, включая встроенный источник данных для аннотаций. Запросы аннотаций возвращают события, которые можно визуализировать в виде маркеров событий на графиках панели мониторинга.

Чтобы добавить новый запрос аннотации на панель мониторинга, выполняют следующие действия:

1. нажать  в правом верхнем углу панели мониторинга;
  [Рисунок 9](/image26.png)
2. в разделе "Setting (Настройки)" перейти на вкладку "Annotations (Аннотации)";
3. нажать Add annotation query (Добавить запрос аннотации); если запрос уже добавляли, отображается кнопка +New query (Новый запрос);
4. ввести имя для запроса аннотации; это название присваивается переключателю (флажку), который позволяет включать/отключать отображение событий аннотаций в этом запросе;
5. выбрать источник данных для аннотаций; также можно нажать Open advanced data source picker (Открыть расширенный выбор источника данных), чтобы увидеть больше опций, включая добавление источника данных (только для администраторов);
6. если не требуется сразу использовать запрос аннотаций, снять флажок "Enabled (Включено)";
7. если не нужно, чтобы переключатель запросов аннотаций отображался на панели мониторинга, установить флажок "Hidden (Скрыть)";
8. выбрать цвет для маркеров событий;
9. в раскрывающемся списке "Show in (Показать в)" выбрать один из следующих вариантов (рисунок 32):
  - All panels (Все панели) – аннотации отображаются на всех панелях, поддерживающих аннотации;
  - Selected panels (Выбранные панели) – аннотации отображаются на всех выбранных панелях;
  - All panels except (Все панели, кроме) – аннотации отображаются на всех панелях, кроме указанных.

::sign-image
---
src: /image54.png
sign: Фильтрация аннотаций
---
::

1. настроить запрос; параметры запроса аннотаций различаются для каждого источника данных;
2. нажать Save dashboard (Сохранить панель мониторинга);
3. (необязательно) ввести описание внесенных изменений;
4. нажать Save (Сохранить).

### Получение аннотации через настройки панели мониторинга

Аннотации после добавления остаются видимыми. Это связано со встроенным запросом аннотаций, который есть на всех панелях мониторинга. Этот запрос аннотаций извлекает все события аннотаций, которые происходят на текущей панели мониторинга и хранятся в Подсистеме, и отображаются на панели, где они были созданы. Сюда входят также аннотации истории оповещений.

По умолчанию встроенный запрос аннотаций использует специальный источник данных "--Grafana—", и ручные аннотации поддерживаются только с использованием этого источника данных. Возможно использовать другой источник данных во встроенном запросе аннотаций, но можно создавать автоматические аннотации только с помощью редактора запросов для этого источника данных.

Чтобы добавлять аннотации непосредственно на панель мониторинга, этот запрос должен быть включен.

Чтобы проверить, включен ли встроенный запрос, выполняют следующие действия:

1. нажать  в правом верхнем углу панели мониторинга;
  [Рисунок 41](/image26.png)
2. на странице "Setting (Настройки)" перейти на вкладку "Annotations (Аннотации)";
3. найти запрос "Annotations & Alerts (Built-in) (Аннотации и оповещения (Встроенные))" и нажать на него;
4. если флажок "Enabled (Включено)" отключен, установить его;
5. нажать Save dashboard (Сохранить панель мониторинга);
6. (необязательно) ввести описание внесенных изменений;
7. нажать Save (Сохранить).

Панель мониторинга при копировании с помощью функции "Save As (Сохранить как)" получает новый идентификатор, поэтому аннотации, созданные на исходной панели мониторинга, больше не будут отображаться в копии. Возможно отобразить их, если добавить новый "Annotation Query (Запрос аннотаций)" и отфильтровать по тегам. Однако это работает только в том случае, если у аннотаций на исходной панели мониторинга есть теги для фильтрации.

### Встроенный запрос

Панель мониторинга в Подсистеме представлена в виде объекта JSON, в котором хранятся метаданные. Метаданные панели мониторинга включают свойства панели мониторинга, метаданные панелей, переменные шаблонов, запросы панелей и т. д.

Чтобы просмотреть JSON панели мониторинга, нужно:

1. нажать  в правом верхнем углу панели мониторинга;
  [Рисунок 459](/image26.png)
2. в разделе "Setting (Настройки)" выбрать пункт меню "JSON Model (JSON-модель)";
3. после окончания просмотра и редактирования кода JSON, нажать Save changes (Сохранить изменения).

## Модель JSON

Когда пользователь создает новую панель мониторинга, новый объект JSON панели мониторинга инициализируется со следующими полями:

> Примечание – В следующем JSON id отображается как null, что является значением по умолчанию, присвоенным ему до сохранения панели мониторинга. После сохранения панели мониторинга полю id присваивается целочисленное значение.

```bash Terminal
{
"id": null,
"uid": "cLV5GDCkz",
"title": "New dashboard",
"tags": [],
"timezone": "browser",
"editable": true,
"graphTooltip": 1,
"panels": [],
"time": {
"from": "now-6h",
"to": "now"
},
"timepicker": {
"refresh_intervals": []
},
"templating": {
"list": []
},
"annotations": {
"list": []
},
"refresh": "5s",
"schemaVersion": 17,
"version": 0,
"links": []
}
```

Каждое поле в JSON описано в таблице 38 с описанием его использования.

1. Поля JSON

| **Имя** | **Использование** |
| --- | --- |
| id | Уникальный цифровой идентификатор для панели мониторинга (генерируется базой данных) |
| uid | Уникальный идентификатор панели мониторинга, который может быть создан кем угодно; String (8-40 символов) |
| title | Текущее название панели мониторинга |
| tags | Теги, связанные с панелью мониторинга; представляют собой массив строк |
| style | Тема панели мониторинга, т.е. dark или light |
| timezone | Часовой пояс панели мониторинга, т.е. utc или browser |
| editable | Доступна ли панель мониторинга для редактирования или нет |
| graphTooltip | 0 – без общего курсора или подсказки (по умолчанию), 1 – общий курсор, 2 – общий курсор и общая подсказка |
| time | Диапазон времени для панели мониторинга, например, последние 6 часов, последние 7 дней и т. д. |
| timepicker | Метаданные временного диапазона |
| templating | Метаданные шаблона |
| annotations | Метаданные аннотаций |
| refresh | Интервал автоматического обновления |
| schemaVersion | Версия схемы JSON (целое Number), увеличивающаяся каждый раз, когда обновление Подсистемы вносит изменения в указанную схему |
| version | Версия панели мониторинга (целое Number), увеличиваемая при каждом обновлении панели мониторинга |
| panels | Массив панелей |

### Поля JSON

Панели – это строительные блоки панели мониторинга. Они состоят из запросов к источникам данных, типов графиков, псевдонимов и т. д. JSON-код панели состоит из массива JSON-объектов, каждый из которых представляет собой отдельную панель. Большинство полей являются общими для всех панелей, но некоторые поля зависят от типа панели. Ниже приведен пример JSON-кода текстовой панели:

```bash Terminal
"panels": [
{
"type": "text",
"title": "Panel Title",
"gridPos": {
"x": 0,
"y": 0,
"w": 12,
"h": 9
},
"id": 4,
"mode": "markdown",
"content": "# title"
}
```

Свойство gridPos описывает размер и положение панели в координатах сетки:

- w – 1-24 (ширина панели мониторинга разделена на 24 столбца);
- h – в единицах измерения высоты сетки каждый представляет собой 30 пикселей;
- x – позиция "x", в той же единице измерения, что и "w";
- y – позиция "y", в той же единице измерения, что и "h".

У сетки есть отрицательное притяжение, которое перемещает панели вверх, если над панелью есть свободное пространство.

Пример timepicker в формате JSON:

```bash Terminal
"timepicker": {
"collapse": false,
"enable": true,
"notice": false,
"now": true,
"hidden": false,
"nowDelay": ",
"refresh_intervals": [
"5s",
"10s",
"30s",
"1m",
"5m",
"15m",
"30m",
"1h",
"2h",
"1d"
],
"status": "Stable",
"type": "timepicker"
}
```

Использование этих полей описано в таблице 39:

1. Поля timepicker

| **Имя** | **Использование** |
| --- | --- |
| collapse | Свернут timepicker или нет |
| enable | Включен timepicker или нет |
| notice | Показывает уведомление или подсказку в интерфейсе timepicker. Если значение true, то рядом с timepicker будет отображаться информационное сообщение (например, о текущем времени или задержке). Если false, уведомление скрыто |
| now | Определяет, доступна ли возможность выбора текущего времени ("Now") в timepicker. Если значение true, пользователь может выбрать "Now" как точку отсчета времени. Если false, эта опция будет отключена |
| hidden | Скрыт ли timepicker или нет |
| nowDelay | Изменить текущее время, введя задержку; используют эту опцию, чтобы учесть известные задержки при сборе данных и избежать нулевых значений |
| refresh_intervals | Параметры интервала доступны в раскрывающемся списке средства выбора обновления |
| status | Указывает текущий статус timepicker. Например, значение "Stable" означает, что компонент работает корректно и не имеет проблем. Это поле может использоваться для внутреннего мониторинга состояния компонента |
| type | Определяет тип компонента. В данном случае значение "timepicker" указывает, что это именно компонент выбора времени. Это поле используется для идентификации типа элемента в JSON-модели |

Поле templating содержит массив переменных шаблона с сохраненными значениями, а также некоторые другие метаданные, например:

```bash Terminal
"templating": {
"enable": true,
"list": [
{
"allFormat": "wildcard",
"current": {
"tags": [],
"text": "prod",
"value": "prod"
},
"datasource": null,
"includeAll": true,
"name": "env",
"options": [
{
"selected": false,
"text": "All",
"value": "*"
},
{
"selected": false,
"text": "stage",
"value": "stage"
},
{
"selected": false,
"text": "test",
"value": "test"
}
],
"query": "tag_values(cpu.utilization.average,env)",
"refresh": false,
"type": "query"
},
{
"allFormat": "wildcard",
"current": {
"text": "apache",
"value": "apache"
},
"datasource": null,
"includeAll": false,
"multi": false,
"multiFormat": "glob",
"name": "app",
"options": [
{
"selected": true,
"text": "tomcat",
"value": "tomcat"
},
{
"selected": false,
"text": "cassandra",
"value": "cassandra"
}
],
"query": "tag_values(cpu.utilization.average,app)",
"refresh": false,
"regex": ",
"type": "query"
}
]
}
```

Использование вышеупомянутых полей в секции шаблонов объясняется в таблице 40.

1. Поля templating

| **Имя** | **Использование** |
| --- | --- |
| enable | Включено ли создание шаблонов или нет |
| list | Массив объектов, каждый из которых представляет одну переменную шаблона |
| allFormat | Формат для использования при получении всех значений из источника данных, например: wildcard, glob, regex, pipe и т. д. |
| current | Отображает текущий текст / значение выбранной переменной на панели мониторинга |
| data source | Показывает источник данных для переменных |
| includeAll | Доступен ли параметр "включая все" или нет |
| multi | Можно ли выбрать несколько значений из списка значений переменных |
| multiFormat | Формат, используемый при извлечении временных рядов из источника данных |
| name | Имя переменной |
| options | Массив пар "текстовая переменная/значение", доступных для выбора на панели мониторинга |
| query | Запрос к источнику данных, используемый для извлечения значений переменной |
| refresh | Настраивает время обновления переменной |
| regex | Извлекает часть названия серии или сегмента узла метрики |
| type | Тип переменной, т.е. custom, query или interval |

### Панели

В этом разделе представлена информация о передовых методах работы для администраторов и пользователей Подсистемы среднего уровня, а также о том, как создавать и поддерживать панели мониторинга Подсистемы.

## Лучшие практики панелей мониторинга

Если нужно отслеживать множество параметров, например, в серверном кластере, нужна стратегия, чтобы решить, что из этого достаточно важно для отслеживания. В этом разделе описаны несколько распространенных методов выбора параметров для отслеживания.

Логичная стратегия позволяет создавать унифицированные панели мониторинга и проще масштабировать платформу мониторинга.

Рекомендации по использованию:

- Метод USE показывает, насколько в порядке машины, а метод RED показывает, насколько довольны пользователи.
- USE отчитывается о причинах проблем.
- RED сообщает об опыте работы пользователя и с большей вероятностью сообщает о симптомах проблем.
- Лучше всего оповещать о симптомах, а не о причинах, поэтому оповещения следует размещать на панелях мониторинга RED.

Метод USE означает:

- Использование – процент времени, в течение которого ресурс занят, например, загрузка процессора узла;
- Насыщенность– объем работы, которую должен выполнить ресурс, часто это размер очереди или нагрузка на узел;
- Ошибки – количество событий с ошибками.

Этот метод лучше всего подходит для аппаратных ресурсов в ИТ-инфраструктуре, таких как центральный процессор, память и сетевые устройства.

Метод RED означает:

- Темп – количество запросов в секунду;
- Ошибки – количество неудачных запросов;
- Длительность – время, которое занимают эти запросы, распределение измерений задержки.

Этот метод наиболее применим к сервисам, особенно в среде микросервисов. Для каждого из сервисов можно настроить код так, чтобы он отображал эти метрики для каждого компонента. Панели мониторинга RED хорошо подходят для оповещений и соглашений об уровне обслуживания (SLA). Хорошо продуманная панель мониторинга RED – это показатель удобства для пользователей.

Четыре Золотых Сигнала. Согласно руководству Google SRE, если можно измерить только четыре метрики пользовательского приложения, следует сосредоточиться на этих четырех.

Этот метод аналогичен методу RED, но еще включает насыщенность.

- Задержка – время , затраченное на обработку запроса;
- Трафик – уровень загрузки к инфраструктуре;
- Ошибки – частота неудачных запросов;
- Насыщенность – насколько загружена инфраструктура.

### Общие стратегии обеспечения наблюдаемости

Зрелость управления панелью мониторинга означает, насколько хорошо спроектирована и эффективна экосистема панели мониторинга. Рекомендуется периодически пересматривать настройки панели мониторинга, чтобы оценить, на каком этапе находится инфраструктура и что можно улучшить.

В общих чертах уровень зрелости панели мониторинга можно определить как низкий, средний или высокий.

Низкий (по умолчанию) – на этом этапе нет четкой стратегии управления панелью мониторинга. Почти все начинают с этого.

Уровень определяется следующими особенностями:

- каждый может изменять панели мониторинга;
- множество скопированных панелей мониторинга, практически полное их повторное использование;
- одноразовые панели мониторинга, которые постоянно на виду;
- нет контроля версий (панели JSON в системе управления версиями);
- много времени уходит на просмотр панелей мониторинга и поиск нужной панели;
- отсутствие каких-либо оповещений для поиска нужной панели мониторинга.

Средний (методические панели мониторинга) – на этом этапе начинается управление использованием панелями мониторинга с помощью методических панелей. Возможно, к этому моменту разработана стратегию, но есть некоторые моменты, которые можно улучшить.

Уровень определяется следующими особенностями:

- предотвращается разрастание с помощью переменных шаблона, например, не нужна отдельная панель мониторинга для каждого узла, можно использовать переменные запроса; более того, можно сделать источник данных переменной шаблона, чтобы использовать одну и ту же панель мониторинга в разных кластерах и средах мониторинга;
- методические панели мониторинга в соответствии со стратегией наблюдаемости;
- иерархические панели мониторинга с детализацией до следующего уровня;
- дизайн панели мониторинга отражает иерархию сервисов;
- сравниваются похожие метрики: разделяются панели мониторинга служб, если значения отличаются; учитывается, что агрегированные метрики не перекрывают важную информацию;
- наглядные диаграммы с продуманным использованием цвета и нормализованными осями там, где это возможно;
- направленный просмотр уменьшает необходимость “угадывания”:
- переменные шаблонов усложняют возможность просто просматривать данные случайным образом или без цели;
- большинство панелей мониторинга должны быть связаны с помощью оповещений;
- просмотр осуществляется с помощью ссылок;
  - версионное управление панелями JSON.

Высокий (оптимизированное использование) – на этом этапе оптимизировано использование панели мониторинга с помощью последовательной и продуманной стратегии. Это требует усилий, но результат того стоит:

- Активное уменьшения разрастания
- регулярный просмотр существующих панелей мониторинга для определения их актуальности;
- в список основных панелей мониторинга добавлены только одобренные;
- отслеживание панелей мониторинга;
  - согласованность по дизайну;
  - использование библиотек сценариев для создания панелей мониторинга, обеспечение согласованности шаблона и стиля:
- grafonnet (Jsonnet);
- grafanalib (Python);
  - нет редактирования в браузере; средства просмотра панели мониторинга меняют представления с помощью переменных;
  - просмотр панелей мониторинга – это исключение, а не правило;
  - проведение экспериментов и тестирования в отдельном экземпляре Подсистемы, предназначенном для этой цели, а не в рабочем экземпляре; если панель мониторинга в тестовой среде окажется полезной, то она добавляется в основной экземпляр Подсистемы.

### Модель зрелости управления панелью мониторинга

Вот несколько принципов, которые следует учитывать перед созданием панели мониторинга:

- Информационная панель должна рассказывать историю или отвечать на вопрос. Следует выстроить логическую последовательность данных, например, от общего к частному или от большого к малому. Если у панели мониторинга нет цели, то в ней нет необходимости.
- Графики должны быть простыми и направленными на конкретные цели. Если нужно отслеживать серверы с проблемами, то, возможно, не нужно показывать все данные о серверах, а только о тех, которые испытывают проблемы.
- Панели мониторинга должны снижать когнитивную нагрузку, а не увеличивать ее. Когнитивная нагрузка – это, по сути, то, насколько усиленно нужно обрабатывать, чтобы понять что-то. Следует сделать так, чтобы панель мониторинга было легко интерпретировать, в том числе и другим пользователям.
- Иметь стратегию мониторинга. Создать новые панели мониторинга несложно. Оптимизировать создание панелей мониторинга и придерживаться плана сложнее, но оно того стоит. Эта стратегия должна определять как общую схему панелей мониторинга, так и обеспечивать единообразие в дизайне отдельных панелей мониторинга. Как только появится стратегия или рекомендации по дизайну, рекомендуется их сохранить, чтобы поддерживать единообразие с течением времени.

Лучшие практики, которым рекомендуется следовать:

- При создании новой панели мониторинга убедиться, что у нее есть осмысленное название:
- если создается панель мониторинга для тестирования или экспериментов, добавить в название слово TEST или TMP;
- включить свое имя или инициалы в название панели мониторинга или в качестве тега, чтобы пользователи знали, кому принадлежит панель мониторинга;
- удалить временные панели мониторинга, когда работы с ними закончатся.
  - Если создается множество связанных между собой панелей мониторинга, предусмотреть, как связать их между собой для удобства навигации.
  - Подсистема получает данные из источника данных. Важно иметь базовое представление об источниках данных в целом и о пользовательском конкретном источнике.
  - Избегать ненужного обновления панели мониторинга, чтобы снизить нагрузку на сеть или серверную часть. Например, если данные меняются каждый час, не нужно устанавливать частоту обновления панели мониторинга в 30 секунд.
  - При отображении временных рядов с разными единицами измерения или диапазонами использовать левую и правую оси Y.
  - Добавлять документацию на панели мониторинга и панели:
- чтобы отобразить документацию на панели мониторинга, добавить на панель мониторинга визуализацию текстовой панели. Записать такие сведения, как назначение панели мониторинга, ссылки на полезные ресурсы и любые инструкции, которые могут понадобиться пользователям для взаимодействия с панелью мониторинга;
- чтобы добавить документацию к панели, изменить настройки панели и добавить описание. Любой добавленный текст появится, если навести курсор на значок "i" в левом верхнем углу панели.
  - Повторно использовать свои панели мониторинга и обеспечивать согласованность с помощью шаблонов и переменных.
  - Быть внимательными при объединении данных на графике. Визуализация может вводить в заблуждение и скрывать важные данные. В большинстве случаев рекомендуется отключать эту функцию.

### Рекомендации по созданию панелей мониторинга

Вот несколько принципов, которые следует учитывать, прежде чем приступить к управлению панелями мониторинга:

- Стратегическая наблюдаемость. Существует несколько распространенных стратегий наблюдения. Следует изучить их и решить, подходит ли одна из них или требуется разработать свою собственную. В любом случае составить план, записать его и придерживаться. При необходимости адаптировать свою стратегию к меняющимся потребностям.
- Уровень зрелости. Проанализировать текущую настройку панели мониторинга и сравнить ее с моделью зрелости управления панелью. Понимание этапа поможет решить, как достичь желаемого результата.

Лучшие практики, которым рекомендуется следовать:

- Избегать разрастания панели мониторинга, то есть неконтролируемого увеличения количества панелей. Разрастание панели мониторинга негативно влияет на время, необходимое для поиска нужной панели. Дублирование панелей мониторинга и изменение "чего-то одного", особенно при сохранении исходных тегов, – самый простой вид разрастания.
- Периодически просматривать панели мониторинга и удалять ненужные.
- Если создается временная панель мониторинга, например, для тестирования, добавить к названию префикс "TEST:". Удалить панель мониторинга по окончании тестирования.
  - Копирование панелей мониторинга без существенных изменений не рекомендуется:
- не будут получены обновления для исходной панели мониторинга, такие как изменения в документации, исправления ошибок или добавление метрик;
- во многих случаях копии создаются для того, чтобы просто настроить представление, задав параметры шаблона; вместо этого следует сохранить ссылку на главную панель мониторинга и настроить представление с помощью параметров URL.
  - Если нужно скопировать панель мониторинга, обязательно переименовать ее и **не** копировать теги панели мониторинга. Теги – это важные метаданные для панелей мониторинга, которые используются при поиске. Копирование тегов может привести к ложным совпадениям.
  - Создавать панель мониторинга из панелей мониторинга или перекрестных ссылок на панели мониторинга. Это можно сделать несколькими способами:
- создавать ссылки на панели мониторинга, панели или данные, которые могут вести на другие панели мониторинга или во внешние приложения;
- добавить панель со списком на панели мониторинга, чтобы потом настроить просмотр с помощью поиска по тегам или папкам;
- добавить текстовую панель и использовать язык разметки для настройки отображения.

### Рекомендации по управлению панелями мониторинга

На странице "Dashboards (Панели мониторинга)" можно выполнять такие задачи по управлению панелями мониторинга, как:

- просмотр и создание папок панели мониторинга;
- управление разрешениями для папок;
- добавление генеративных функций ИИ.