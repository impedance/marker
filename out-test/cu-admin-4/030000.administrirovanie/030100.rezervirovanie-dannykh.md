# Резервирование данных

В этом разделе объясняется, как создать резервную копию локального развертывания Подсистемы, включая конфигурацию, данные плагинов и базу данных Подсистемы.

## Создание резервной копии файла конфигурации

Для создания резервной копии файла конфигурации, который мог быть изменен после развертывания Подсистемы, нужно скопировать файлы конфигурации в каталог для резервных копий.

Файлы конфигурации Подсистемы расположены в следующих каталогах:

- конфигурация по умолчанию – $WORKING_DIR/defaults.ini (**не следует изменять этот файл**);
- пользовательская конфигурация – $WORKING_DIR/custom.ini.

> Примечание – Если Подсистема установлена с помощью пакетов deb или rpm, то файл конфигурации находится по адресу /etc/grafana/grafana.ini. Этот путь указан в скрипте init.d с помощью параметра "--config".

## Резервное копирование данных плагина

При установке плагинов для каждого плагина создается папка с соответствующими файлами и данными. Следует скопировать все файлы и папки из этого расположения в резервное хранилище.

Файлы плагинов Подсистемы расположены в следующих каталогах:

- расположение плагинов по умолчанию в бинарной или исходной установке – $WORKING_DIR/data/plugins;
- расположение плагинов по умолчанию в пакетах deb или rpm – /var/lib/grafana/plugins. Этот путь указывается в скрипте init.d с помощью параметра "—config".

## Создание резервной копии базы данных

Для создания резервной копии разных базы данных необходимо:

- **SQLite**

По умолчанию база данных Подсистемы – это SQLite, которая хранит свои данные в одном файле на диске. Чтобы создать резервную копию этого файла, следует скопировать его в хранилище резервных копий.

> Примечание – Чтобы обеспечить целостность данных, перед созданием резервной копии базы данных SQLite следует отключить службу Подсистемы.

Файл базы данных SQLite находится в одном из следующих каталогов:

- расположение по умолчанию для данных SQLite в двоичной или исходной установке – $WORKING_DIR/data/grafana.db;
- расположение данных SQLite по умолчанию в пакете deb или rpm – /var/lib/grafana/grafana.db. Этот путь указывается в сценарии init.d с помощью параметра "—config".
- **MySQL**

Чтобы создать резервную копию или восстановить базу данных MySQL, нужно выполнить следующие команды:

```yaml
backup:
> mysqldump -u root -p[root_password] [grafana] > grafana_backup.sql
restore:
> mysql -u root -p grafana < grafana_backup.sql
```

- **Postgres**

Чтобы создать резервную копию или восстановить базу данных Postgres, нужно выполнить следующие команды:

```yaml
backup:
> pg_dump grafana > grafana_backup
restore:
> psql grafana < grafana_backup
```