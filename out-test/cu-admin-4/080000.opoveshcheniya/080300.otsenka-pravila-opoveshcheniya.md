# Оценка правила оповещения

В Подсистеме можно установить период ожидания, чтобы предотвратить ненужные оповещения о временных проблемах.

Период ожидания определяет, в течение какого времени условие должно выполняться перед срабатыванием, гарантируя, что условие выполняется постоянно в течение определенного периода.

Также можно установить нулевой период ожидания, чтобы пропустить его и сразу же активировать оповещение при выполнении условия.

## Группа оценки

Выбор способа, времени и места отправки уведомлений об оповещениях – важная часть настройки системы оповещений. Эти решения напрямую влияют на способность команды получать необходимую информацию для быстрого решения проблем и минимизации количества оповещений.

Следует начать с определения контактных точек, чтобы указать способ получения уведомлений. Затем настроить правила оповещений, чтобы они отправлялись либо в контактную точку, либо с помощью дерева политик оповещений для гибкой маршрутизации оповещений в контактные точки.

Схема работы выглядит следующим образом:

- оповещения Подсистемы периодически оценивают правила оповещений и запускают уведомления о срабатывании и устранении оповещений;
- возможно настроить правило оповещения для отправки уведомлений в контактную точку или направлять их с помощью политик уведомлений для большей гибкости;
- чтобы свести к минимуму количество оповещений, объединяют похожие оповещения в одно уведомление, сгруппировав метки оповещений и время их отправки.

Точки контакта содержат настройки для отправки уведомлений, в том числе по электронной почте, в Slack, OnCall, через вебхуки и их сообщения.

Контактная точка – это список интеграций, каждая из которых отправляет сообщение определенному адресату.

По умолчанию в сообщениях уведомлений отображаются общие сведения об оповещениях, такие как количество оповещений, названия оповещений, метки, аннотации и другая информация об оповещениях. Также можно настраивать сообщения уведомлений и использовать шаблоны уведомлений.

Сначала следует создать контактную точку и протестировать уведомления. Затем нужно настроить правило оповещения так, чтобы уведомления отправлялись либо в контактную точку, либо через политики уведомлений.

Правила уведомления являются основой комплексной системы оповещения. Они обеспечивают гибкий и эффективный способ направления оповещений в различные контактные точки, помогая снизить количество отвлекающих оповещений и гарантируя, что ни одно оповещение не будет пропущено.

Дерево политики уведомлений (рисунок 80) отвечает за:

- определение вложенных политик, которые могут наследовать или перезаписывать родительские настройки уведомлений;
- маршрутизацию оповещений, сопоставляя метки оповещений с соответствующей политикой уведомлений.

::sign-image
---
src: /image120.png
sign: Политика уведомлений
---
::

Каждая политика уведомлений (рисунок 81) решает определенные задачи:

- решение о том, какая контактная точка получит оповещение;
- управление временем отправки уведомлений на основе параметров синхронизации уведомлений;
- группировка нескольких оповещений в одно уведомление для уменьшения массовой рассылки при оповещении.

::sign-image
---
src: /image121.png
sign: Политика уведомлений
---
::

Когда в ИТ-инфраструктуре происходит сбой, система оповещений может легко сгенерировать сотни или даже тысячи оповещений (уведомлений). Несколько правил оповещений часто срабатывают одновременно. Кроме того, каждое правило оповещения может сгенерировать несколько оповещений.

Группировка уведомлений об оповещениях обычно необходима для того, чтобы не перегружать почтовый ящик организации оповещениями. Группировка объединяет похожие оповещения за определенный период в одно уведомление.

Использование группировки уведомлений:

- Labels (Метки) – группировка экземпляров оповещений одного и того же типа с помощью меток;
- Timing options (Параметры таймера) – ожидание заданного времени перед отправкой уведомления, чтобы сгруппировать входящие оповещения.

"Alerting (Оповещения)" предоставляет расширенные возможности уведомлений, которые пригодятся и команде по мере совершенствования первоначальной системы оповещений.

Например, можно настраивать уведомления с помощью общих шаблонов, которые предоставляют полезную информацию и могут использоваться повторно для нескольких уведомлений.

Кроме того, можно использовать отключения и таймеры отключения для приостановки или подавления уведомлений, не прерывая оценку оповещений.

## Период ожидания

"Alerting (Оповещения)" основана на модели Prometheus для разработки систем оповещения. Ее архитектура отделяет генератор оповещений от менеджера оповещений (известного как Alertmanager) для повышения масштабируемости и производительности (рисунок 82).

::sign-image
---
src: /image125.png
sign: Архитектура Alerting
---
::

Подсистема предоставляет собственный менеджер оповещений, расширяющий возможности менеджера оповещений Prometheus, для управления оповещениями и их отправки. Если используется менеджер оповещений Prometheus или Mimir, можно настроить оповещения Подсистемы для управления ими и обработки уведомлений для оповещений, управляемых Подсистемой.