# Инспектор запросов

Производительность запроса можно проверить на вкладке "Stats (Статистика)", где отображается статистика, показывающая, сколько времени занимает запрос, сколько запросов отправляется, количество возвращаемых строк и идентификаторы трассировки. Эта информация может помочь устранить неполадки с запросами, особенно если какие-либо значения неожиданно высокие или низкие:

1. открыть инспектор запросов;
2. перейти на вкладку "Stats (Статистика)".

Статистика отображается в формате, доступном только для чтения.

## Интерфейс

Чтобы просмотреть необработанный запрос и ответ на вкладке "Query (Запрос)" необходимо:

1. открыть инспектор запросов и перейти на вкладку "Query (Запрос)";
2. нажать Refresh (Обновить).

Подсистема отправляет запрос на сервер и отображает результат. Возможно перейти к конкретным частям запроса, развернуть или свернуть его целиком. Чтобы скопировать данные для использования в других приложениях следует нажать Copy to clipboard (Копировать в буфер обмена).

## Вкладка "Статистика"

На вкладке "JSON" можно просматривать результаты в формате JSON и в виде фреймов данных моделей JSON.

1. открыть инспектор запросов и перейти на вкладку "JSON";
2. выбрать один из следующих параметров в раскрывающемся меню "Select source (Выбрать источник)":
  - Panel data (Данные панели) – отображает объект JSON, представляющий данные, полученные визуализацией из "Explore (Исследование)";
  - DataFrame JSON (from query) (JSON-файл фрейма данных (из запроса)) – отображает необработанный набор результатов без примененных преобразований и настроек полей.

## Вкладка "Запросы"

На вкладке "Data (Данные)" можно просматривать, проверять и загружать необработанные результаты запроса:

1. открыть инспектор запросов и перейти на вкладку "Data (Данные)";
2. нажать "Data options (Параметры данных)", чтобы просмотреть параметры в секции "Show data frame (Показать фрейм данных)";
3. выбрать набор результатов обработки данных из выпадающего меню;
4. для нескольких запросов или запросов с несколькими узлами можно выбрать "Series joined by time (Ряды, объединенные по времени)" в раскрывающемся списке, чтобы сразу просмотреть необработанные данные по всем запросам, по одному набору результатов в каждом столбце; можно нажать на заголовок любого столбца, чтобы отсортировать данные;
5. переключить "Formatted data (Форматированные данные)" так, чтобы они соответствовали формату на панели;
6. нажать Download for Excel (Скачать для Excel), чтобы загрузить CSV-файл, специально отформатированный для Excel;
7. чтобы загрузить результаты в файл CSV, нажать Download CSV (Загрузить CSV) в правом верхнем углу панели инспектора запросов.

В зависимости от типа источника данных (например, Loki) или при наличии журналов в наборе результатов Подсистема создает файл TXT с необработанными данными журналов в папке для загрузок браузера по умолчанию. Возможно открыть его в выбранном средстве просмотра:

1. выбрать "Query inspector (Инспектор запросов)";
2. перейти на вкладку "Data (Данные)", чтобы просмотреть результаты запроса журнала;
3. нажать Download logs (Загрузить журналы).

В зависимости от типа источника данных (например, Tempo) Подсистема генерирует файл JSON с результатами трассировки в одном из поддерживаемых форматов – Jaeger, Zipkin или OTLP:

1. выбрать "Query inspector (Инспектор запросов)";
2. перейти на вкладку "Data (Данные)", чтобы просмотреть результаты трассировки;
3. нажать Download traces (Загрузить трассировки).

## Вкладка "JSON"

"Explore (Исследование)" – это мощный инструмент для ведения журналов и анализа журналов. Он позволяет изучать журналы из различных источников данных, в том числе:

- Loki;
- Elasticsearch;
- Cloudwatch;
- InfluxDB;
- Azure Monitor;
- ClickHouse.

С помощью "Explore (Исследование)" можно эффективно отслеживать, устранять неполадки и реагировать на инциденты, анализируя журналы и выявляя первопричины. Это также помогает сопоставлять журналы с другими сигналами телеметрии, такими как метрики, трассировки или профили, просматривая их одновременно.

Результаты запросов к журналам отображаются в виде отдельных строк журнала и графика, показывающего объем журналов за выбранный период времени.

## Вкладка "Данные"

При работе с источниками данных, поддерживающими полный объем журналов, в разделе "Explore (Исследование)" автоматически отображается график, показывающий распределение журналов по всем отправленным запросам. В настоящее время эта функция поддерживается источниками данных Elasticsearch и Loki.

Если источник данных не поддерживает загрузку полного набора журналов, модель журналов вычисляет временной ряд, подсчитывая строки журналов и группируя их по интервалам на основе автоматически рассчитанного временного интервала. Временная метка первой строки журнала используется для привязки начала набора журналов к результатам. Конец временного ряда привязан к диапазону "To (До)" в средстве выбора времени. Таким образом, можно эффективно анализировать и визуализировать данные журналов, даже если источник данных не поддерживает полный набор журналов.